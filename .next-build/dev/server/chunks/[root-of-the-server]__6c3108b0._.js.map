{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jurit/OneDrive/Desktop/sito%20upscale/config/index.js"],"sourcesContent":["/**\r\n * Centralized configuration for the application\r\n * All environment variables and app settings should be defined here\r\n */\r\n\r\nexport const config = {\r\n  // App\r\n  app: {\r\n    name: process.env.APP_NAME || 'Tool Suite',\r\n    env: process.env.NODE_ENV || 'development',\r\n    port: parseInt(process.env.PORT || '3000', 10),\r\n    url: process.env.APP_URL || 'http://localhost:3000',\r\n  },\r\n\r\n  // Database\r\n  database: {\r\n    url: process.env.DATABASE_URL,\r\n    pool: {\r\n      max: parseInt(process.env.DB_POOL_MAX || '20', 10),\r\n      idleTimeout: parseInt(process.env.DB_IDLE_TIMEOUT || '30000', 10),\r\n      connectionTimeout: parseInt(process.env.DB_CONNECTION_TIMEOUT || '5000', 10),\r\n    },\r\n  },\r\n\r\n  // Supabase\r\n  supabase: {\r\n    url: process.env.NEXT_PUBLIC_SUPABASE_URL,\r\n    anonKey: process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,\r\n    serviceRoleKey: process.env.SUPABASE_SERVICE_ROLE_KEY,\r\n  },\r\n\r\n  // Stripe\r\n  stripe: {\r\n    secretKey: process.env.STRIPE_SECRET_KEY,\r\n    publishableKey: process.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY,\r\n    webhookSecret: process.env.STRIPE_WEBHOOK_SECRET,\r\n    productId: process.env.STRIPE_PRODUCT_ID || 'prod_TTkHuBeh8iAAht',\r\n  },\r\n\r\n  // Cloudinary\r\n  cloudinary: {\r\n    cloudName: process.env.CLOUDINARY_CLOUD_NAME,\r\n    apiKey: process.env.CLOUDINARY_API_KEY,\r\n    apiSecret: process.env.CLOUDINARY_API_SECRET,\r\n  },\r\n\r\n  // OpenAI\r\n  openai: {\r\n    apiKey: process.env.OPENAI_API_KEY,\r\n  },\r\n\r\n  // File upload\r\n  upload: {\r\n    maxFileSize: parseInt(process.env.MAX_FILE_SIZE || '52428800', 10), // 50MB default\r\n    allowedMimeTypes: {\r\n      image: ['image/jpeg', 'image/png', 'image/webp', 'image/gif', 'image/svg+xml'],\r\n      document: ['application/pdf', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'],\r\n      video: ['video/mp4', 'video/webm', 'video/ogg'],\r\n      audio: ['audio/mpeg', 'audio/wav', 'audio/ogg'],\r\n    },\r\n    tempDir: process.env.TEMP_DIR || '/tmp',\r\n  },\r\n\r\n  // Session\r\n  session: {\r\n    cookieName: 'megapixelai_session',\r\n    maxAge: 7 * 24 * 60 * 60 * 1000, // 7 days\r\n    secret: process.env.SESSION_SECRET || 'change-me-in-production',\r\n  },\r\n\r\n  // Security\r\n  security: {\r\n    bcryptRounds: parseInt(process.env.BCRYPT_ROUNDS || '10', 10),\r\n    rateLimit: {\r\n      windowMs: parseInt(process.env.RATE_LIMIT_WINDOW || '900000', 10), // 15 minutes\r\n      max: parseInt(process.env.RATE_LIMIT_MAX || '100', 10),\r\n    },\r\n  },\r\n\r\n  // Analytics\r\n  analytics: {\r\n    gaTrackingId: process.env.NEXT_PUBLIC_GA_TRACKING_ID,\r\n  },\r\n\r\n  // OAuth\r\n  oauth: {\r\n    google: {\r\n      clientId: process.env.GOOGLE_CLIENT_ID,\r\n      clientSecret: process.env.GOOGLE_CLIENT_SECRET,\r\n    },\r\n    facebook: {\r\n      appId: process.env.FACEBOOK_APP_ID,\r\n      appSecret: process.env.FACEBOOK_APP_SECRET,\r\n    },\r\n    redirectBaseUrl: process.env.APP_URL || 'http://localhost:3000',\r\n  },\r\n};\r\n\r\n// Validation helper\r\nexport function validateConfig() {\r\n  const required = [\r\n    { key: 'database.url', value: config.database.url },\r\n    { key: 'supabase.url', value: config.supabase.url },\r\n    { key: 'supabase.anonKey', value: config.supabase.anonKey },\r\n  ];\r\n\r\n  const missing = required.filter(({ value }) => !value);\r\n  \r\n  if (missing.length > 0) {\r\n    throw new Error(\r\n      `Missing required configuration: ${missing.map(({ key }) => key).join(', ')}`\r\n    );\r\n  }\r\n}\r\n\r\n// Validate on import in production\r\nif (config.app.env === 'production') {\r\n  validateConfig();\r\n}\r\n\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 159, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jurit/OneDrive/Desktop/sito%20upscale/pages/api/auth/oauth/google.js"],"sourcesContent":["import { config } from '../../../../config';\r\nimport crypto from 'crypto';\r\n\r\n/**\r\n * Initiate Google OAuth flow\r\n * Redirects user to Google OAuth consent screen\r\n * Note: This handler doesn't use apiHandler because it needs to redirect, not return JSON\r\n */\r\nexport default async function googleOAuthHandler(req, res) {\r\n  // Only allow GET requests\r\n  if (req.method !== 'GET') {\r\n    return res.status(405).redirect(`/login?error=${encodeURIComponent('Method not allowed')}`);\r\n  }\r\n\r\n  try {\r\n    // Check OAuth configuration\r\n    const { clientId, redirectBaseUrl } = config.oauth?.google || {};\r\n    \r\n    if (!clientId) {\r\n      console.error('Google OAuth not configured: missing clientId');\r\n      return res.redirect(`/login?error=${encodeURIComponent('OAuth not configured')}`);\r\n    }\r\n\r\n    if (!redirectBaseUrl) {\r\n      console.error('Google OAuth not configured: missing redirectBaseUrl');\r\n      return res.redirect(`/login?error=${encodeURIComponent('OAuth not configured')}`);\r\n    }\r\n\r\n    // Generate state token for CSRF protection\r\n    const state = crypto.randomBytes(32).toString('hex');\r\n    \r\n    // Store state in session/cookie (simplified - in production use secure session)\r\n    res.setHeader('Set-Cookie', `oauth_state=${state}; HttpOnly; SameSite=Lax; Path=/; Max-Age=600`);\r\n\r\n    // Google OAuth 2.0 authorization URL\r\n    const redirectUri = `${redirectBaseUrl}/api/auth/oauth/google/callback`;\r\n    const scope = 'openid email profile';\r\n    const responseType = 'code';\r\n    \r\n    const authUrl = `https://accounts.google.com/o/oauth2/v2/auth?` +\r\n      `client_id=${encodeURIComponent(clientId)}&` +\r\n      `redirect_uri=${encodeURIComponent(redirectUri)}&` +\r\n      `response_type=${responseType}&` +\r\n      `scope=${encodeURIComponent(scope)}&` +\r\n      `state=${state}&` +\r\n      `access_type=offline&` +\r\n      `prompt=consent`;\r\n\r\n    // Redirect to Google\r\n    return res.redirect(authUrl);\r\n  } catch (error) {\r\n    console.error('Google OAuth initiation error:', error);\r\n    return res.redirect(`/login?error=${encodeURIComponent('Failed to initiate OAuth')}`);\r\n  }\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAOe,eAAe,mBAAmB,GAAG,EAAE,GAAG;IACvD,0BAA0B;IAC1B,IAAI,IAAI,MAAM,KAAK,OAAO;QACxB,OAAO,IAAI,MAAM,CAAC,KAAK,QAAQ,CAAC,CAAC,aAAa,EAAE,mBAAmB,uBAAuB;IAC5F;IAEA,IAAI;QACF,4BAA4B;QAC5B,MAAM,EAAE,QAAQ,EAAE,eAAe,EAAE,GAAG,kHAAM,CAAC,KAAK,EAAE,UAAU,CAAC;QAE/D,IAAI,CAAC,UAAU;YACb,QAAQ,KAAK,CAAC;YACd,OAAO,IAAI,QAAQ,CAAC,CAAC,aAAa,EAAE,mBAAmB,yBAAyB;QAClF;QAEA,IAAI,CAAC,iBAAiB;YACpB,QAAQ,KAAK,CAAC;YACd,OAAO,IAAI,QAAQ,CAAC,CAAC,aAAa,EAAE,mBAAmB,yBAAyB;QAClF;QAEA,2CAA2C;QAC3C,MAAM,QAAQ,gHAAM,CAAC,WAAW,CAAC,IAAI,QAAQ,CAAC;QAE9C,gFAAgF;QAChF,IAAI,SAAS,CAAC,cAAc,CAAC,YAAY,EAAE,MAAM,6CAA6C,CAAC;QAE/F,qCAAqC;QACrC,MAAM,cAAc,GAAG,gBAAgB,+BAA+B,CAAC;QACvE,MAAM,QAAQ;QACd,MAAM,eAAe;QAErB,MAAM,UAAU,CAAC,6CAA6C,CAAC,GAC7D,CAAC,UAAU,EAAE,mBAAmB,UAAU,CAAC,CAAC,GAC5C,CAAC,aAAa,EAAE,mBAAmB,aAAa,CAAC,CAAC,GAClD,CAAC,cAAc,EAAE,aAAa,CAAC,CAAC,GAChC,CAAC,MAAM,EAAE,mBAAmB,OAAO,CAAC,CAAC,GACrC,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC,GACjB,CAAC,oBAAoB,CAAC,GACtB,CAAC,cAAc,CAAC;QAElB,qBAAqB;QACrB,OAAO,IAAI,QAAQ,CAAC;IACtB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kCAAkC;QAChD,OAAO,IAAI,QAAQ,CAAC,CAAC,aAAa,EAAE,mBAAmB,6BAA6B;IACtF;AACF"}}]
}