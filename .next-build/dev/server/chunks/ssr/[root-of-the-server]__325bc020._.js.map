{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 48, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jurit/OneDrive/Desktop/sito%20upscale/lib/i18n.js"],"sourcesContent":["import { createContext, useContext, useState, useEffect, useMemo, useCallback } from 'react';\r\nimport { useRouter } from 'next/router';\r\n\r\nconst LanguageContext = createContext();\r\n\r\n// Cache per le traduzioni per evitare re-fetching\r\nconst translationsCache = {};\r\n\r\nexport function LanguageProvider({ children, initialTranslations = {} }) {\r\n  const router = useRouter();\r\n  const [locale, setLocale] = useState(router.locale || 'en');\r\n  const [translations, setTranslations] = useState(initialTranslations);\r\n\r\n  // Funzione di traduzione memoizzata\r\n  const t = useCallback((key) => {\r\n    if (!key || typeof key !== 'string') return key;\r\n    const keys = key.split('.');\r\n    let value = translations;\r\n    for (const k of keys) {\r\n      value = value?.[k];\r\n      if (value === undefined) return key;\r\n    }\r\n    return value || key;\r\n  }, [translations]);\r\n\r\n  // Caricamento traduzioni ottimizzato con cache\r\n  const loadTranslations = useCallback(async (lang) => {\r\n    // Controllo cache prima\r\n    if (translationsCache[lang]) {\r\n      setTranslations(translationsCache[lang]);\r\n      setLocale(lang);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Solo lato client\r\n      if (typeof window === 'undefined') {\r\n        return;\r\n      }\r\n      \r\n      const response = await fetch(`/locales/${lang}/common.json`);\r\n      if (!response.ok) {\r\n        throw new Error(`Failed to load translations: ${response.status}`);\r\n      }\r\n      const data = await response.json();\r\n      // Cache delle traduzioni\r\n      translationsCache[lang] = data;\r\n      setTranslations(data);\r\n      setLocale(lang);\r\n    } catch (error) {\r\n      console.error('Error loading translations:', error);\r\n      // Fallback to English solo se non siamo già su English\r\n      if (lang !== 'en' && typeof window !== 'undefined') {\r\n        loadTranslations('en');\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    // Ricarica traduzioni quando cambia la locale del router\r\n    if (router.locale && router.locale !== locale) {\r\n      loadTranslations(router.locale);\r\n    }\r\n  }, [router.locale, locale, loadTranslations]);\r\n\r\n  useEffect(() => {\r\n    // Load translations for current locale se non già caricate\r\n    const currentLocale = router.locale || 'en';\r\n    if (!initialTranslations || Object.keys(initialTranslations).length === 0) {\r\n      // Solo se non in cache\r\n      if (!translationsCache[currentLocale]) {\r\n        loadTranslations(currentLocale);\r\n      }\r\n    } else {\r\n      // Popola la cache con le traduzioni iniziali\r\n      if (!translationsCache[currentLocale]) {\r\n        translationsCache[currentLocale] = initialTranslations;\r\n      }\r\n    }\r\n  }, [router.locale, loadTranslations, initialTranslations]);\r\n\r\n  // Memoizza il valore del context per evitare re-render\r\n  const contextValue = useMemo(\r\n    () => ({ locale, translations, t }),\r\n    [locale, translations, t]\r\n  );\r\n\r\n  return (\r\n    <LanguageContext.Provider value={contextValue}>\r\n      {children}\r\n    </LanguageContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useTranslation() {\r\n  const context = useContext(LanguageContext);\r\n  if (!context) {\r\n    throw new Error('useTranslation must be used within LanguageProvider');\r\n  }\r\n  return context;\r\n}\r\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;;;;AAEA,MAAM,gCAAkB,IAAA,oHAAa;AAErC,kDAAkD;AAClD,MAAM,oBAAoB,CAAC;AAEpB,SAAS,iBAAiB,EAAE,QAAQ,EAAE,sBAAsB,CAAC,CAAC,EAAE;IACrE,MAAM,SAAS,IAAA,oIAAS;IACxB,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,+GAAQ,EAAC,OAAO,MAAM,IAAI;IACtD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,+GAAQ,EAAC;IAEjD,oCAAoC;IACpC,MAAM,IAAI,IAAA,kHAAW,EAAC,CAAC;QACrB,IAAI,CAAC,OAAO,OAAO,QAAQ,UAAU,OAAO;QAC5C,MAAM,OAAO,IAAI,KAAK,CAAC;QACvB,IAAI,QAAQ;QACZ,KAAK,MAAM,KAAK,KAAM;YACpB,QAAQ,OAAO,CAAC,EAAE;YAClB,IAAI,UAAU,WAAW,OAAO;QAClC;QACA,OAAO,SAAS;IAClB,GAAG;QAAC;KAAa;IAEjB,+CAA+C;IAC/C,MAAM,mBAAmB,IAAA,kHAAW,EAAC,OAAO;QAC1C,wBAAwB;QACxB,IAAI,iBAAiB,CAAC,KAAK,EAAE;YAC3B,gBAAgB,iBAAiB,CAAC,KAAK;YACvC,UAAU;YACV;QACF;QAEA,IAAI;YACF,mBAAmB;YACnB,wCAAmC;gBACjC;YACF;;;YAEA,MAAM;YAIN,MAAM;QAKR,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,+BAA+B;YAC7C,uDAAuD;YACvD;;QAGF;IACF,GAAG,EAAE;IAEL,IAAA,gHAAS,EAAC;QACR,yDAAyD;QACzD,IAAI,OAAO,MAAM,IAAI,OAAO,MAAM,KAAK,QAAQ;YAC7C,iBAAiB,OAAO,MAAM;QAChC;IACF,GAAG;QAAC,OAAO,MAAM;QAAE;QAAQ;KAAiB;IAE5C,IAAA,gHAAS,EAAC;QACR,2DAA2D;QAC3D,MAAM,gBAAgB,OAAO,MAAM,IAAI;QACvC,IAAI,CAAC,uBAAuB,OAAO,IAAI,CAAC,qBAAqB,MAAM,KAAK,GAAG;YACzE,uBAAuB;YACvB,IAAI,CAAC,iBAAiB,CAAC,cAAc,EAAE;gBACrC,iBAAiB;YACnB;QACF,OAAO;YACL,6CAA6C;YAC7C,IAAI,CAAC,iBAAiB,CAAC,cAAc,EAAE;gBACrC,iBAAiB,CAAC,cAAc,GAAG;YACrC;QACF;IACF,GAAG;QAAC,OAAO,MAAM;QAAE;QAAkB;KAAoB;IAEzD,uDAAuD;IACvD,MAAM,eAAe,IAAA,8GAAO,EAC1B,IAAM,CAAC;YAAE;YAAQ;YAAc;QAAE,CAAC,GAClC;QAAC;QAAQ;QAAc;KAAE;IAG3B,qBACE,qKAAC,gBAAgB,QAAQ;QAAC,OAAO;kBAC9B;;;;;;AAGP;AAEO,SAAS;IACd,MAAM,UAAU,IAAA,iHAAU,EAAC;IAC3B,IAAI,CAAC,SAAS;QACZ,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT"}},
    {"offset": {"line": 169, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jurit/OneDrive/Desktop/sito%20upscale/components/Toast.js"],"sourcesContent":["import { useState, useEffect, useRef } from 'react';\r\nimport { \r\n    HiCheckCircle, HiXCircle, HiInformationCircle, HiX, \r\n    HiExclamation, HiClock, HiLightningBolt, HiCog \r\n} from 'react-icons/hi';\r\n\r\nlet toastId = 0;\r\nconst toastListeners = new Set();\r\n\r\nexport const showToast = (message, type = 'success', duration = 4000, options = {}) => {\r\n    const id = toastId++;\r\n    const toast = { \r\n        id, \r\n        message, \r\n        type, \r\n        duration,\r\n        timestamp: new Date(),\r\n        progress: options.progress,\r\n        details: options.details,\r\n        technical: options.technical,\r\n        action: options.action\r\n    };\r\n    toastListeners.forEach(listener => listener(toast));\r\n    return id;\r\n};\r\n\r\nexport const updateToast = (id, updates) => {\r\n    toastListeners.forEach(listener => {\r\n        if (typeof listener === 'function') {\r\n            listener({ id, ...updates, update: true });\r\n        }\r\n    });\r\n};\r\n\r\nexport default function ToastContainer() {\r\n    const [toasts, setToasts] = useState([]);\r\n    const progressIntervals = useRef({});\r\n\r\n    useEffect(() => {\r\n        const listener = (toast) => {\r\n            if (toast.update) {\r\n                setToasts(prev => prev.map(t => \r\n                    t.id === toast.id ? { ...t, ...toast } : t\r\n                ));\r\n            } else {\r\n                setToasts(prev => [...prev, toast]);\r\n                \r\n                if (toast.duration > 0 && toast.type !== 'loading' && toast.type !== 'progress') {\r\n                    setTimeout(() => {\r\n                        setToasts(prev => prev.filter(t => t.id !== toast.id));\r\n                    }, toast.duration);\r\n                }\r\n            }\r\n        };\r\n\r\n        toastListeners.add(listener);\r\n        return () => toastListeners.delete(listener);\r\n    }, []);\r\n\r\n    const removeToast = (id) => {\r\n        if (progressIntervals.current[id]) {\r\n            clearInterval(progressIntervals.current[id]);\r\n            delete progressIntervals.current[id];\r\n        }\r\n        setToasts(prev => prev.filter(t => t.id !== id));\r\n    };\r\n\r\n    const formatTime = (date) => {\r\n        return date.toLocaleTimeString('it-IT', { \r\n            hour: '2-digit', \r\n            minute: '2-digit',\r\n            second: '2-digit'\r\n        });\r\n    };\r\n\r\n    const getIcon = (type) => {\r\n        const iconStyle = { ...styles.icon, ...styles.iconPulse };\r\n        switch(type) {\r\n            case 'success': return <HiCheckCircle style={iconStyle} />;\r\n            case 'error': return <HiXCircle style={iconStyle} />;\r\n            case 'info': return <HiInformationCircle style={iconStyle} />;\r\n            case 'warning': return <HiExclamation style={iconStyle} />;\r\n            case 'loading': return <HiCog style={{ ...iconStyle, animation: 'spin 1s linear infinite' }} />;\r\n            case 'progress': return <HiLightningBolt style={iconStyle} />;\r\n            default: return <HiInformationCircle style={iconStyle} />;\r\n        }\r\n    };\r\n\r\n    const getColors = (type) => {\r\n        switch(type) {\r\n            case 'success': \r\n                return { \r\n                    bg: 'linear-gradient(135deg, rgba(16, 185, 129, 0.95) 0%, rgba(5, 150, 105, 0.95) 100%)',\r\n                    border: 'rgba(16, 185, 129, 1)',\r\n                    glow: 'rgba(16, 185, 129, 0.4)',\r\n                    progress: 'rgba(255, 255, 255, 0.3)'\r\n                };\r\n            case 'error': \r\n                return { \r\n                    bg: 'linear-gradient(135deg, rgba(239, 68, 68, 0.95) 0%, rgba(220, 38, 38, 0.95) 100%)',\r\n                    border: 'rgba(239, 68, 68, 1)',\r\n                    glow: 'rgba(239, 68, 68, 0.4)',\r\n                    progress: 'rgba(255, 255, 255, 0.3)'\r\n                };\r\n            case 'info': \r\n                return { \r\n                    bg: 'linear-gradient(135deg, rgba(59, 130, 246, 0.95) 0%, rgba(37, 99, 235, 0.95) 100%)',\r\n                    border: 'rgba(59, 130, 246, 1)',\r\n                    glow: 'rgba(59, 130, 246, 0.4)',\r\n                    progress: 'rgba(255, 255, 255, 0.3)'\r\n                };\r\n            case 'warning':\r\n                return {\r\n                    bg: 'linear-gradient(135deg, rgba(245, 158, 11, 0.95) 0%, rgba(217, 119, 6, 0.95) 100%)',\r\n                    border: 'rgba(245, 158, 11, 1)',\r\n                    glow: 'rgba(245, 158, 11, 0.4)',\r\n                    progress: 'rgba(255, 255, 255, 0.3)'\r\n                };\r\n            case 'loading':\r\n            case 'progress':\r\n                return {\r\n                    bg: 'linear-gradient(135deg, rgba(139, 92, 246, 0.95) 0%, rgba(124, 58, 237, 0.95) 100%)',\r\n                    border: 'rgba(139, 92, 246, 1)',\r\n                    glow: 'rgba(139, 92, 246, 0.4)',\r\n                    progress: 'rgba(255, 255, 255, 0.4)'\r\n                };\r\n            default: \r\n                return { \r\n                    bg: 'linear-gradient(135deg, rgba(102, 126, 234, 0.95) 0%, rgba(79, 70, 229, 0.95) 100%)',\r\n                    border: 'rgba(102, 126, 234, 1)',\r\n                    glow: 'rgba(102, 126, 234, 0.4)',\r\n                    progress: 'rgba(255, 255, 255, 0.3)'\r\n                };\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div style={styles.container}>\r\n            {toasts.map((toast, index) => {\r\n                const colors = getColors(toast.type);\r\n                const progress = toast.progress !== undefined ? Math.min(100, Math.max(0, toast.progress)) : null;\r\n                \r\n                return (\r\n                    <div \r\n                        key={toast.id}\r\n                        style={{\r\n                            ...styles.toast,\r\n                            background: colors.bg,\r\n                            borderColor: colors.border,\r\n                            boxShadow: `0 8px 32px ${colors.glow}, 0 0 0 1px ${colors.border}`,\r\n                            transform: `translateY(${index * 8}px)`,\r\n                            zIndex: 9999 - index,\r\n                            animation: 'slideInRight 0.4s cubic-bezier(0.16, 1, 0.3, 1), fadeOut 0.3s ease-in ' + (toast.duration - 300) + 'ms forwards'\r\n                        }}\r\n                    >\r\n                        <div style={styles.toastContent}>\r\n                            <div style={styles.iconContainer}>\r\n                                {getIcon(toast.type)}\r\n                            </div>\r\n                            \r\n                            <div style={styles.messageContainer}>\r\n                                <div style={styles.messageHeader}>\r\n                                    <span style={styles.message}>{toast.message}</span>\r\n                                    {toast.timestamp && (\r\n                                        <span style={styles.timestamp}>\r\n                                            <HiClock style={{ width: 12, height: 12, marginRight: 4 }} />\r\n                                            {formatTime(toast.timestamp)}\r\n                                        </span>\r\n                                    )}\r\n                                </div>\r\n                                \r\n                                {toast.details && (\r\n                                    <div style={styles.details}>\r\n                                        {toast.details}\r\n                                    </div>\r\n                                )}\r\n                                \r\n                                {toast.technical && (\r\n                                    <div style={styles.technical}>\r\n                                        <code style={styles.technicalCode}>\r\n                                            {toast.technical}\r\n                                        </code>\r\n                                    </div>\r\n                                )}\r\n                                \r\n                                {(progress !== null || toast.type === 'loading' || toast.type === 'progress') && (\r\n                                    <div style={styles.progressContainer}>\r\n                                        <div style={styles.progressBar}>\r\n                                            <div \r\n                                                style={{\r\n                                                    ...styles.progressFill,\r\n                                                    width: progress !== null ? `${progress}%` : '100%',\r\n                                                    background: colors.progress,\r\n                                                    animation: progress === null ? 'pulse 1.5s ease-in-out infinite' : 'none'\r\n                                                }}\r\n                                            />\r\n                                        </div>\r\n                                        {progress !== null && (\r\n                                            <span style={styles.progressText}>{progress}%</span>\r\n                                        )}\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                            \r\n                            <button \r\n                                onClick={() => removeToast(toast.id)}\r\n                                style={styles.closeBtn}\r\n                                aria-label=\"Chiudi notifica\"\r\n                                onMouseEnter={(e) => {\r\n                                    e.currentTarget.style.background = 'rgba(255,255,255,0.3)';\r\n                                }}\r\n                                onMouseLeave={(e) => {\r\n                                    e.currentTarget.style.background = 'rgba(255,255,255,0.2)';\r\n                                }}\r\n                            >\r\n                                <HiX style={{ width: 16, height: 16 }} />\r\n                            </button>\r\n                        </div>\r\n                        \r\n                        {toast.action && (\r\n                            <div style={styles.actionContainer}>\r\n                                <button \r\n                                    onClick={() => {\r\n                                        toast.action.onClick();\r\n                                        if (toast.action.closeOnClick) {\r\n                                            removeToast(toast.id);\r\n                                        }\r\n                                    }}\r\n                                    style={styles.actionButton}\r\n                                    onMouseEnter={(e) => {\r\n                                        e.currentTarget.style.background = 'rgba(255, 255, 255, 0.25)';\r\n                                        e.currentTarget.style.transform = 'translateY(-1px)';\r\n                                    }}\r\n                                    onMouseLeave={(e) => {\r\n                                        e.currentTarget.style.background = 'rgba(255, 255, 255, 0.15)';\r\n                                        e.currentTarget.style.transform = 'translateY(0)';\r\n                                    }}\r\n                                >\r\n                                    {toast.action.label}\r\n                                </button>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                );\r\n            })}\r\n            <style jsx global>{`\r\n                @keyframes slideInRight {\r\n                    from {\r\n                        transform: translateX(450px) scale(0.9);\r\n                        opacity: 0;\r\n                    }\r\n                    to {\r\n                        transform: translateX(0) scale(1);\r\n                        opacity: 1;\r\n                    }\r\n                }\r\n                @keyframes fadeOut {\r\n                    from {\r\n                        opacity: 1;\r\n                        transform: translateX(0) scale(1);\r\n                    }\r\n                    to {\r\n                        opacity: 0;\r\n                        transform: translateX(120px) scale(0.9);\r\n                    }\r\n                }\r\n                @keyframes spin {\r\n                    from {\r\n                        transform: rotate(0deg);\r\n                    }\r\n                    to {\r\n                        transform: rotate(360deg);\r\n                    }\r\n                }\r\n                @keyframes pulse {\r\n                    0%, 100% {\r\n                        opacity: 0.6;\r\n                    }\r\n                    50% {\r\n                        opacity: 1;\r\n                    }\r\n                }\r\n                @keyframes shimmer {\r\n                    0% {\r\n                        background-position: -1000px 0;\r\n                    }\r\n                    100% {\r\n                        background-position: 1000px 0;\r\n                    }\r\n                }\r\n            `}</style>\r\n        </div>\r\n    );\r\n}\r\n\r\nconst styles = {\r\n    container: {\r\n        position: 'fixed',\r\n        top: '80px',\r\n        right: '20px',\r\n        zIndex: 9999,\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        gap: '14px',\r\n        pointerEvents: 'none',\r\n        maxWidth: '420px',\r\n        width: '100%'\r\n    },\r\n    toast: {\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        padding: '0',\r\n        minWidth: '320px',\r\n        maxWidth: '420px',\r\n        backdropFilter: 'blur(20px) saturate(180%)',\r\n        WebkitBackdropFilter: 'blur(20px) saturate(180%)',\r\n        border: '1.5px solid',\r\n        borderRadius: '16px',\r\n        color: '#ffffff',\r\n        fontSize: '14px',\r\n        fontWeight: '500',\r\n        pointerEvents: 'auto',\r\n        cursor: 'default',\r\n        overflow: 'hidden',\r\n        transition: 'all 0.3s cubic-bezier(0.16, 1, 0.3, 1)',\r\n        position: 'relative'\r\n    },\r\n    toastContent: {\r\n        display: 'flex',\r\n        alignItems: 'flex-start',\r\n        gap: '14px',\r\n        padding: '16px 18px'\r\n    },\r\n    iconContainer: {\r\n        flexShrink: 0,\r\n        marginTop: '2px'\r\n    },\r\n    icon: {\r\n        width: 26,\r\n        height: 26,\r\n        flexShrink: 0,\r\n        filter: 'drop-shadow(0 2px 4px rgba(0,0,0,0.2))'\r\n    },\r\n    iconPulse: {\r\n        animation: 'pulse 2s ease-in-out infinite'\r\n    },\r\n    messageContainer: {\r\n        flex: 1,\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        gap: '8px',\r\n        minWidth: 0\r\n    },\r\n    messageHeader: {\r\n        display: 'flex',\r\n        alignItems: 'flex-start',\r\n        justifyContent: 'space-between',\r\n        gap: '12px',\r\n        flexWrap: 'wrap'\r\n    },\r\n    message: {\r\n        flex: 1,\r\n        lineHeight: '1.5',\r\n        fontWeight: '600',\r\n        fontSize: '15px',\r\n        letterSpacing: '-0.01em'\r\n    },\r\n    timestamp: {\r\n        fontSize: '11px',\r\n        opacity: 0.85,\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        fontWeight: '400',\r\n        whiteSpace: 'nowrap',\r\n        fontFamily: 'monospace',\r\n        letterSpacing: '0.5px'\r\n    },\r\n    details: {\r\n        fontSize: '13px',\r\n        opacity: 0.9,\r\n        lineHeight: '1.5',\r\n        marginTop: '2px',\r\n        fontWeight: '400'\r\n    },\r\n    technical: {\r\n        marginTop: '4px',\r\n        padding: '8px 12px',\r\n        background: 'rgba(0, 0, 0, 0.2)',\r\n        borderRadius: '8px',\r\n        border: '1px solid rgba(255, 255, 255, 0.1)',\r\n        fontSize: '12px',\r\n        fontFamily: 'monospace',\r\n        overflowX: 'auto'\r\n    },\r\n    technicalCode: {\r\n        color: '#ffffff',\r\n        opacity: 0.95,\r\n        fontWeight: '500',\r\n        letterSpacing: '0.3px'\r\n    },\r\n    progressContainer: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        gap: '10px',\r\n        marginTop: '6px'\r\n    },\r\n    progressBar: {\r\n        flex: 1,\r\n        height: '6px',\r\n        background: 'rgba(0, 0, 0, 0.2)',\r\n        borderRadius: '10px',\r\n        overflow: 'hidden',\r\n        position: 'relative'\r\n    },\r\n    progressFill: {\r\n        height: '100%',\r\n        borderRadius: '10px',\r\n        transition: 'width 0.3s ease-out',\r\n        position: 'relative',\r\n        overflow: 'hidden'\r\n    },\r\n    progressText: {\r\n        fontSize: '11px',\r\n        fontWeight: '600',\r\n        opacity: 0.9,\r\n        minWidth: '35px',\r\n        textAlign: 'right',\r\n        fontFamily: 'monospace',\r\n        letterSpacing: '0.5px'\r\n    },\r\n    closeBtn: {\r\n        background: 'rgba(255,255,255,0.2)',\r\n        border: 'none',\r\n        borderRadius: '8px',\r\n        padding: '6px',\r\n        cursor: 'pointer',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        color: '#ffffff',\r\n        transition: 'all 0.2s ease',\r\n        flexShrink: 0,\r\n        width: '28px',\r\n        height: '28px',\r\n        marginTop: '-2px'\r\n    },\r\n    actionContainer: {\r\n        padding: '0 18px 16px 18px',\r\n        borderTop: '1px solid rgba(255, 255, 255, 0.1)',\r\n        marginTop: '8px',\r\n        paddingTop: '12px'\r\n    },\r\n    actionButton: {\r\n        width: '100%',\r\n        padding: '10px 16px',\r\n        background: 'rgba(255, 255, 255, 0.15)',\r\n        border: '1px solid rgba(255, 255, 255, 0.2)',\r\n        borderRadius: '10px',\r\n        color: '#ffffff',\r\n        fontSize: '13px',\r\n        fontWeight: '600',\r\n        cursor: 'pointer',\r\n        transition: 'all 0.2s ease',\r\n        backdropFilter: 'blur(10px)'\r\n    }\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 775, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jurit/OneDrive/Desktop/sito%20upscale/lib/performance.js"],"sourcesContent":["/**\r\n * Performance optimization utilities\r\n * Helps with Core Web Vitals and overall site performance\r\n */\r\n\r\n// Debounce function for performance\r\nexport function debounce(func, wait) {\r\n  let timeout;\r\n  return function executedFunction(...args) {\r\n    const later = () => {\r\n      clearTimeout(timeout);\r\n      func(...args);\r\n    };\r\n    clearTimeout(timeout);\r\n    timeout = setTimeout(later, wait);\r\n  };\r\n}\r\n\r\n// Throttle function for performance\r\nexport function throttle(func, limit) {\r\n  let inThrottle;\r\n  return function(...args) {\r\n    if (!inThrottle) {\r\n      func.apply(this, args);\r\n      inThrottle = true;\r\n      setTimeout(() => (inThrottle = false), limit);\r\n    }\r\n  };\r\n}\r\n\r\n// Intersection Observer for lazy loading\r\nexport function createIntersectionObserver(callback, options = {}) {\r\n  if (typeof window === 'undefined' || !('IntersectionObserver' in window)) {\r\n    return null;\r\n  }\r\n\r\n  const defaultOptions = {\r\n    root: null,\r\n    rootMargin: '50px',\r\n    threshold: 0.01,\r\n    ...options,\r\n  };\r\n\r\n  return new IntersectionObserver(callback, defaultOptions);\r\n}\r\n\r\n// Preload critical resources\r\nexport function preloadResource(href, as, crossorigin = false) {\r\n  if (typeof document === 'undefined') return;\r\n  \r\n  const link = document.createElement('link');\r\n  link.rel = 'preload';\r\n  link.href = href;\r\n  link.as = as;\r\n  if (crossorigin) {\r\n    link.crossOrigin = 'anonymous';\r\n  }\r\n  document.head.appendChild(link);\r\n}\r\n\r\n// Prefetch route\r\nexport function prefetchRoute(href) {\r\n  if (typeof document === 'undefined') return;\r\n  \r\n  const link = document.createElement('link');\r\n  link.rel = 'prefetch';\r\n  link.href = href;\r\n  document.head.appendChild(link);\r\n}\r\n\r\n// Optimize images with lazy loading - improved performance\r\nexport function setupLazyImages() {\r\n  if (typeof window === 'undefined' || typeof document === 'undefined') {\r\n    return;\r\n  }\r\n\r\n  // Use requestIdleCallback for non-critical image loading\r\n  if ('requestIdleCallback' in window) {\r\n    requestIdleCallback(() => {\r\n      initLazyImages();\r\n    }, { timeout: 2000 });\r\n  } else {\r\n    setTimeout(initLazyImages, 100);\r\n  }\r\n}\r\n\r\nfunction initLazyImages() {\r\n  const imageObserver = createIntersectionObserver((entries) => {\r\n    entries.forEach((entry) => {\r\n      if (entry.isIntersecting) {\r\n        const img = entry.target;\r\n        if (img && img.dataset && img.dataset.src) {\r\n          // Load image with priority hint\r\n          if (img.dataset.srcset) {\r\n            img.srcset = img.dataset.srcset;\r\n          }\r\n          img.src = img.dataset.src;\r\n          img.loading = 'lazy';\r\n          img.removeAttribute('data-src');\r\n          img.removeAttribute('data-srcset');\r\n          \r\n          // Add fade-in animation\r\n          img.style.opacity = '0';\r\n          img.style.transition = 'opacity 0.3s ease-in';\r\n          img.onload = () => {\r\n            img.style.opacity = '1';\r\n          };\r\n          \r\n          if (imageObserver) {\r\n            imageObserver.unobserve(img);\r\n          }\r\n        }\r\n      }\r\n    });\r\n  }, {\r\n    rootMargin: '50px', // Start loading 50px before image enters viewport\r\n    threshold: 0.01,\r\n  });\r\n\r\n  if (!imageObserver) {\r\n    return;\r\n  }\r\n\r\n  // Observe all images with data-src (native lazy loading fallback)\r\n  try {\r\n    const images = document.querySelectorAll('img[data-src]:not([loading=\"eager\"])');\r\n    images.forEach((img) => {\r\n      // Set width and height if available to prevent layout shift\r\n      if (img.dataset.width && img.dataset.height) {\r\n        img.style.aspectRatio = `${img.dataset.width} / ${img.dataset.height}`;\r\n      }\r\n      \r\n      if (img && imageObserver) {\r\n        imageObserver.observe(img);\r\n      }\r\n    });\r\n  } catch (error) {\r\n    if (process.env.NODE_ENV === 'development') {\r\n      console.warn('Error setting up lazy images:', error);\r\n    }\r\n  }\r\n}\r\n\r\n// Optimize Core Web Vitals - enhanced version\r\nexport function optimizeCoreWebVitals() {\r\n  if (typeof window === 'undefined') return;\r\n\r\n  // Prevent layout shift for images with aspect ratio\r\n  const images = document.querySelectorAll('img:not([style*=\"aspect-ratio\"])');\r\n  images.forEach((img) => {\r\n    if (!img.complete && img.naturalWidth && img.naturalHeight) {\r\n      // Set aspect ratio to prevent layout shift\r\n      const aspectRatio = img.naturalWidth / img.naturalHeight;\r\n      img.style.aspectRatio = `${aspectRatio}`;\r\n      img.style.width = img.style.width || 'auto';\r\n      img.style.height = img.style.height || 'auto';\r\n    }\r\n    \r\n    // Add loading=\"lazy\" to images that don't have it\r\n    if (!img.hasAttribute('loading') && !img.closest('[data-above-fold]')) {\r\n      img.loading = 'lazy';\r\n    }\r\n  });\r\n\r\n  // Optimize font loading with display swap\r\n  if ('fonts' in document) {\r\n    document.fonts.ready.then(() => {\r\n      document.documentElement.classList.add('fonts-loaded');\r\n    });\r\n  }\r\n  \r\n  // Preload critical resources\r\n  preloadCriticalResources();\r\n}\r\n\r\nfunction preloadCriticalResources() {\r\n  if (typeof document === 'undefined') return;\r\n  \r\n  // Preload critical CSS (if any)\r\n  const criticalStyles = document.querySelectorAll('link[rel=\"stylesheet\"]:not([media])');\r\n  criticalStyles.forEach(link => {\r\n    if (link.href && !link.href.startsWith('data:')) {\r\n      link.rel = 'preload';\r\n      link.as = 'style';\r\n    }\r\n  });\r\n  \r\n  // Preload above-the-fold images\r\n  const aboveFoldImages = document.querySelectorAll('img[data-above-fold=\"true\"]');\r\n  aboveFoldImages.forEach(img => {\r\n    if (img.src) {\r\n      const link = document.createElement('link');\r\n      link.rel = 'preload';\r\n      link.as = 'image';\r\n      link.href = img.src;\r\n      if (img.srcset) {\r\n        link.imagesrcset = img.srcset;\r\n      }\r\n      document.head.appendChild(link);\r\n    }\r\n  });\r\n}\r\n\r\n// Request Idle Callback polyfill\r\nexport function requestIdleCallback(callback, options = {}) {\r\n  if (typeof window === 'undefined') return;\r\n  \r\n  if ('requestIdleCallback' in window) {\r\n    return window.requestIdleCallback(callback, options);\r\n  }\r\n  \r\n  // Fallback\r\n  const timeout = options.timeout || 2000;\r\n  return setTimeout(() => {\r\n    callback({\r\n      didTimeout: false,\r\n      timeRemaining: () => 5,\r\n    });\r\n  }, timeout);\r\n}\r\n\r\n// Cancel Idle Callback\r\nexport function cancelIdleCallback(id) {\r\n  if (typeof window === 'undefined') return;\r\n  \r\n  if ('cancelIdleCallback' in window) {\r\n    window.cancelIdleCallback(id);\r\n  } else {\r\n    clearTimeout(id);\r\n  }\r\n}\r\n\r\n// Measure performance\r\nexport function measurePerformance(name, fn) {\r\n  if (typeof window === 'undefined' || !('performance' in window)) {\r\n    return fn();\r\n  }\r\n\r\n  const start = performance.now();\r\n  const result = fn();\r\n  const end = performance.now();\r\n  \r\n  if (process.env.NODE_ENV === 'development') {\r\n    console.log(`[Performance] ${name}: ${(end - start).toFixed(2)}ms`);\r\n  }\r\n  \r\n  return result;\r\n}\r\n\r\n// Batch DOM updates\r\nexport function batchDOMUpdates(updates) {\r\n  if (typeof window === 'undefined' || !('requestAnimationFrame' in window)) {\r\n    updates.forEach(update => update());\r\n    return;\r\n  }\r\n\r\n  requestAnimationFrame(() => {\r\n    updates.forEach(update => update());\r\n  });\r\n}\r\n\r\n// Performance monitoring utility\r\nexport function measureWebVitals() {\r\n  if (typeof window === 'undefined' || process.env.NODE_ENV !== 'production') {\r\n    return;\r\n  }\r\n\r\n  try {\r\n    // Measure Largest Contentful Paint (LCP)\r\n    if ('PerformanceObserver' in window) {\r\n      const lcpObserver = new PerformanceObserver((list) => {\r\n        const entries = list.getEntries();\r\n        const lastEntry = entries[entries.length - 1];\r\n        console.log('LCP:', lastEntry.renderTime || lastEntry.loadTime);\r\n      });\r\n      \r\n      try {\r\n        lcpObserver.observe({ entryTypes: ['largest-contentful-paint'] });\r\n      } catch (e) {\r\n        // Browser doesn't support LCP\r\n      }\r\n      \r\n      // Measure First Input Delay (FID)\r\n      const fidObserver = new PerformanceObserver((list) => {\r\n        const entries = list.getEntries();\r\n        entries.forEach((entry) => {\r\n          console.log('FID:', entry.processingStart - entry.startTime);\r\n        });\r\n      });\r\n      \r\n      try {\r\n        fidObserver.observe({ entryTypes: ['first-input'] });\r\n      } catch (e) {\r\n        // Browser doesn't support FID\r\n      }\r\n      \r\n      // Measure Cumulative Layout Shift (CLS)\r\n      let clsValue = 0;\r\n      const clsObserver = new PerformanceObserver((list) => {\r\n        const entries = list.getEntries();\r\n        entries.forEach((entry) => {\r\n          if (!entry.hadRecentInput) {\r\n            clsValue += entry.value;\r\n          }\r\n        });\r\n        console.log('CLS:', clsValue);\r\n      });\r\n      \r\n      try {\r\n        clsObserver.observe({ entryTypes: ['layout-shift'] });\r\n      } catch (e) {\r\n        // Browser doesn't support CLS\r\n      }\r\n    }\r\n  } catch (error) {\r\n    // Silently fail in production\r\n    if (process.env.NODE_ENV === 'development') {\r\n      console.warn('Performance monitoring failed:', error);\r\n    }\r\n  }\r\n}\r\n\r\n// Optimize animation performance\r\nexport function optimizeAnimations() {\r\n  if (typeof window === 'undefined') return;\r\n  \r\n  // Use CSS will-change for animated elements\r\n  const animatedElements = document.querySelectorAll('[class*=\"animate-\"], [class*=\"transition\"]');\r\n  animatedElements.forEach((el) => {\r\n    if (el && el.style) {\r\n      el.style.willChange = 'transform, opacity';\r\n      \r\n      // Remove will-change after animation to free resources\r\n      if (el.addEventListener) {\r\n        el.addEventListener('animationend', () => {\r\n          el.style.willChange = 'auto';\r\n        }, { once: true });\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\n// Mobile-specific optimizations\r\nexport function optimizeMobilePerformance() {\r\n  if (typeof window === 'undefined') return;\r\n  \r\n  // Detect mobile device\r\n  const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || window.innerWidth <= 768;\r\n  \r\n  if (!isMobile) return;\r\n  \r\n  // Reduce animation complexity on mobile\r\n  const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;\r\n  \r\n  if (prefersReducedMotion) {\r\n    document.documentElement.style.setProperty('--animation-duration', '0.01ms');\r\n  }\r\n  \r\n  // Optimize touch events\r\n  let touchStartTime = 0;\r\n  document.addEventListener('touchstart', (e) => {\r\n    touchStartTime = performance.now();\r\n  }, { passive: true });\r\n  \r\n  // Prevent double-tap zoom on buttons\r\n  let lastTouchEnd = 0;\r\n  document.addEventListener('touchend', (e) => {\r\n    const now = Date.now();\r\n    if (now - lastTouchEnd <= 300) {\r\n      e.preventDefault();\r\n    }\r\n    lastTouchEnd = now;\r\n  }, { passive: false });\r\n  \r\n  // Optimize scroll performance\r\n  let ticking = false;\r\n  const optimizeScroll = () => {\r\n    if (!ticking) {\r\n      window.requestAnimationFrame(() => {\r\n        // Scroll optimizations here\r\n        ticking = false;\r\n      });\r\n      ticking = true;\r\n    }\r\n  };\r\n  \r\n  window.addEventListener('scroll', optimizeScroll, { passive: true });\r\n}\r\n\r\n// Virtual scrolling helper for long lists (React hook - use in components)\r\n// This is a utility function, actual implementation should be in a React component\r\nexport function createVirtualScrollConfig(items, itemHeight, containerHeight, scrollTop) {\r\n  const startIndex = Math.max(0, Math.floor(scrollTop / itemHeight) - 1);\r\n  const visibleCount = Math.ceil(containerHeight / itemHeight) + 2;\r\n  const endIndex = Math.min(startIndex + visibleCount, items.length);\r\n  \r\n  const visibleItems = items.slice(startIndex, endIndex);\r\n  const offsetY = startIndex * itemHeight;\r\n  \r\n  return { \r\n    visibleItems, \r\n    startIndex, \r\n    endIndex,\r\n    offsetY,\r\n    totalHeight: items.length * itemHeight\r\n  };\r\n}\r\n\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1026, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jurit/OneDrive/Desktop/sito%20upscale/lib/downloadManager.js"],"sourcesContent":["// Download Manager - Gestione coda download, riprendi download interrotti, cronologia\r\n\r\nclass DownloadManager {\r\n  constructor() {\r\n    this.queue = [];\r\n    this.activeDownloads = new Map();\r\n    this.history = [];\r\n    this.maxConcurrent = 3; // Max download simultanei\r\n    this.listeners = new Set();\r\n    \r\n    // Carica cronologia da localStorage\r\n    this.loadHistory();\r\n    \r\n    // Carica coda da sessionStorage (persiste durante la sessione)\r\n    this.loadQueue();\r\n    \r\n    // Riprendi download interrotti al caricamento\r\n    this.resumeInterruptedDownloads();\r\n  }\r\n\r\n  // Carica cronologia da localStorage\r\n  loadHistory() {\r\n    if (typeof window === 'undefined') return;\r\n    \r\n    try {\r\n      const stored = localStorage.getItem('download_history');\r\n      this.history = stored ? JSON.parse(stored) : [];\r\n      \r\n      // Mantieni solo ultimi 100 download\r\n      if (this.history.length > 100) {\r\n        this.history = this.history.slice(0, 100);\r\n        this.saveHistory();\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading download history:', error);\r\n      this.history = [];\r\n    }\r\n  }\r\n\r\n  // Salva cronologia in localStorage\r\n  saveHistory() {\r\n    if (typeof window === 'undefined') return;\r\n    \r\n    try {\r\n      localStorage.setItem('download_history', JSON.stringify(this.history));\r\n    } catch (error) {\r\n      console.error('Error saving download history:', error);\r\n    }\r\n  }\r\n\r\n  // Carica coda da sessionStorage\r\n  loadQueue() {\r\n    if (typeof window === 'undefined') return;\r\n    \r\n    try {\r\n      const stored = sessionStorage.getItem('download_queue');\r\n      if (stored) {\r\n        const queueData = JSON.parse(stored);\r\n        // Ripristina solo download pending (non quelli in corso)\r\n        this.queue = queueData.filter(item => item.status === 'pending');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading download queue:', error);\r\n    }\r\n  }\r\n\r\n  // Salva coda in sessionStorage\r\n  saveQueue() {\r\n    if (typeof window === 'undefined') return;\r\n      \r\n    try {\r\n      const queueToSave = this.queue.map(item => ({\r\n        ...item,\r\n        // Non salvare blob/object URL\r\n        url: item.urlType === 'blob' ? null : item.url,\r\n        blob: null\r\n      }));\r\n      sessionStorage.setItem('download_queue', JSON.stringify(queueToSave));\r\n    } catch (error) {\r\n      console.error('Error saving download queue:', error);\r\n    }\r\n  }\r\n\r\n  // Aggiungi listener per aggiornamenti\r\n  addListener(callback) {\r\n    this.listeners.add(callback);\r\n    return () => this.listeners.delete(callback);\r\n  }\r\n\r\n  // Notifica tutti i listener\r\n  notify() {\r\n    this.listeners.forEach(callback => {\r\n      try {\r\n        callback({\r\n          queue: [...this.queue],\r\n          activeDownloads: Array.from(this.activeDownloads.values()),\r\n          history: [...this.history]\r\n        });\r\n      } catch (error) {\r\n        console.error('Error in download manager listener:', error);\r\n      }\r\n    });\r\n  }\r\n\r\n  // Aggiungi download alla coda\r\n  addDownload({ url, filename, tool, metadata = {} }) {\r\n    const downloadId = `download_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n    \r\n    const downloadItem = {\r\n      id: downloadId,\r\n      url,\r\n      filename: filename || `download_${Date.now()}`,\r\n      tool: tool || 'Unknown',\r\n      metadata,\r\n      status: 'pending',\r\n      progress: 0,\r\n      speed: 0,\r\n      size: 0,\r\n      downloaded: 0,\r\n      startTime: null,\r\n      endTime: null,\r\n      error: null,\r\n      urlType: url.startsWith('blob:') ? 'blob' : 'url',\r\n      createdAt: new Date().toISOString()\r\n    };\r\n\r\n    this.queue.push(downloadItem);\r\n    this.saveQueue();\r\n    this.notify();\r\n    \r\n    // Avvia download se c'è spazio\r\n    this.processQueue();\r\n    \r\n    return downloadId;\r\n  }\r\n\r\n  // Processa la coda download\r\n  async processQueue() {\r\n    // Conta download attivi\r\n    const activeCount = Array.from(this.activeDownloads.values())\r\n      .filter(d => d.status === 'downloading').length;\r\n    \r\n    if (activeCount >= this.maxConcurrent) {\r\n      return;\r\n    }\r\n\r\n    // Trova prossimo download pending\r\n    const nextDownload = this.queue.find(item => item.status === 'pending');\r\n    if (!nextDownload) {\r\n      return;\r\n    }\r\n\r\n    // Avvia download\r\n    this.startDownload(nextDownload.id);\r\n  }\r\n\r\n  // Avvia un download\r\n  async startDownload(downloadId) {\r\n    const downloadItem = this.queue.find(item => item.id === downloadId);\r\n    if (!downloadItem || downloadItem.status !== 'pending') {\r\n      return;\r\n    }\r\n\r\n    downloadItem.status = 'downloading';\r\n    downloadItem.startTime = new Date().toISOString();\r\n    this.activeDownloads.set(downloadId, downloadItem);\r\n    this.saveQueue();\r\n    this.notify();\r\n\r\n    try {\r\n      // Se è un blob URL, scarica direttamente\r\n      if (downloadItem.urlType === 'blob') {\r\n        await this.downloadBlob(downloadItem);\r\n      } else {\r\n        // Download da URL con progress tracking\r\n        await this.downloadFromUrl(downloadItem);\r\n      }\r\n    } catch (error) {\r\n      downloadItem.status = 'failed';\r\n      downloadItem.error = error.message;\r\n      downloadItem.endTime = new Date().toISOString();\r\n      this.saveQueue();\r\n      this.notify();\r\n      \r\n      // Rimuovi da active dopo 5 secondi\r\n      setTimeout(() => {\r\n        this.activeDownloads.delete(downloadId);\r\n        this.notify();\r\n      }, 5000);\r\n    }\r\n  }\r\n\r\n  // Download da blob URL\r\n  async downloadBlob(downloadItem) {\r\n    try {\r\n      const response = await fetch(downloadItem.url);\r\n      const blob = await response.blob();\r\n      \r\n      // Crea link e scarica\r\n      const url = URL.createObjectURL(blob);\r\n      const a = document.createElement('a');\r\n      a.href = url;\r\n      a.download = downloadItem.filename;\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      document.body.removeChild(a);\r\n      \r\n      // Cleanup dopo un delay\r\n      setTimeout(() => URL.revokeObjectURL(url), 1000);\r\n      \r\n      // Aggiorna stato\r\n      downloadItem.status = 'completed';\r\n      downloadItem.progress = 100;\r\n      downloadItem.size = blob.size;\r\n      downloadItem.downloaded = blob.size;\r\n      downloadItem.endTime = new Date().toISOString();\r\n      \r\n      // Aggiungi a cronologia\r\n      this.addToHistory(downloadItem);\r\n      \r\n      // Rimuovi da coda e active\r\n      this.queue = this.queue.filter(item => item.id !== downloadItem.id);\r\n      this.activeDownloads.delete(downloadItem.id);\r\n      this.saveQueue();\r\n      this.notify();\r\n      \r\n      // Processa prossimo download\r\n      this.processQueue();\r\n    } catch (error) {\r\n      throw new Error(`Download failed: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  // Download da URL con progress tracking\r\n  async downloadFromUrl(downloadItem) {\r\n    return new Promise((resolve, reject) => {\r\n      const xhr = new XMLHttpRequest();\r\n      \r\n      xhr.addEventListener('progress', (e) => {\r\n        if (e.lengthComputable) {\r\n          const progress = (e.loaded / e.total) * 100;\r\n          downloadItem.progress = Math.round(progress);\r\n          downloadItem.size = e.total;\r\n          downloadItem.downloaded = e.loaded;\r\n          \r\n          // Calcola velocità\r\n          if (downloadItem.startTime) {\r\n            const elapsed = (Date.now() - new Date(downloadItem.startTime).getTime()) / 1000;\r\n            downloadItem.speed = e.loaded / elapsed;\r\n          }\r\n          \r\n          this.notify();\r\n        }\r\n      });\r\n\r\n      xhr.addEventListener('load', () => {\r\n        if (xhr.status === 200) {\r\n          const blob = new Blob([xhr.response]);\r\n          const url = URL.createObjectURL(blob);\r\n          const a = document.createElement('a');\r\n          a.href = url;\r\n          a.download = downloadItem.filename;\r\n          document.body.appendChild(a);\r\n          a.click();\r\n          document.body.removeChild(a);\r\n          \r\n          setTimeout(() => URL.revokeObjectURL(url), 1000);\r\n          \r\n          downloadItem.status = 'completed';\r\n          downloadItem.progress = 100;\r\n          downloadItem.endTime = new Date().toISOString();\r\n          \r\n          this.addToHistory(downloadItem);\r\n          this.queue = this.queue.filter(item => item.id !== downloadItem.id);\r\n          this.activeDownloads.delete(downloadItem.id);\r\n          this.saveQueue();\r\n          this.notify();\r\n          \r\n          this.processQueue();\r\n          resolve();\r\n        } else {\r\n          reject(new Error(`HTTP ${xhr.status}: ${xhr.statusText}`));\r\n        }\r\n      });\r\n\r\n      xhr.addEventListener('error', () => {\r\n        reject(new Error('Network error'));\r\n      });\r\n\r\n      xhr.addEventListener('abort', () => {\r\n        reject(new Error('Download cancelled'));\r\n      });\r\n\r\n      xhr.open('GET', downloadItem.url);\r\n      xhr.responseType = 'blob';\r\n      xhr.send();\r\n      \r\n      // Salva xhr per poterlo cancellare\r\n      downloadItem._xhr = xhr;\r\n    });\r\n  }\r\n\r\n  // Riprendi download interrotto\r\n  resumeDownload(downloadId) {\r\n    const downloadItem = this.queue.find(item => item.id === downloadId);\r\n    if (!downloadItem) {\r\n      // Cerca nella cronologia\r\n      const historyItem = this.history.find(item => item.id === downloadId);\r\n      if (historyItem && historyItem.status === 'failed') {\r\n        // Ricrea download dalla cronologia\r\n        const newDownload = {\r\n          ...historyItem,\r\n          id: `download_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n          status: 'pending',\r\n          progress: 0,\r\n          error: null,\r\n          startTime: null,\r\n          endTime: null\r\n        };\r\n        this.queue.push(newDownload);\r\n        this.saveQueue();\r\n        this.notify();\r\n        this.processQueue();\r\n        return newDownload.id;\r\n      }\r\n      return null;\r\n    }\r\n\r\n    if (downloadItem.status === 'failed' || downloadItem.status === 'paused') {\r\n      downloadItem.status = 'pending';\r\n      downloadItem.error = null;\r\n      this.saveQueue();\r\n      this.notify();\r\n      this.processQueue();\r\n      return downloadId;\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  // Pausa download (solo per URL, non blob)\r\n  pauseDownload(downloadId) {\r\n    const downloadItem = this.activeDownloads.get(downloadId);\r\n    if (downloadItem && downloadItem._xhr) {\r\n      downloadItem._xhr.abort();\r\n      downloadItem.status = 'paused';\r\n      downloadItem._xhr = null;\r\n      this.activeDownloads.delete(downloadId);\r\n      this.saveQueue();\r\n      this.notify();\r\n      this.processQueue();\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  // Cancella download\r\n  cancelDownload(downloadId) {\r\n    // Se è in corso, fermalo\r\n    const activeItem = this.activeDownloads.get(downloadId);\r\n    if (activeItem && activeItem._xhr) {\r\n      activeItem._xhr.abort();\r\n      activeItem._xhr = null;\r\n    }\r\n\r\n    // Rimuovi da coda\r\n    this.queue = this.queue.filter(item => item.id !== downloadId);\r\n    this.activeDownloads.delete(downloadId);\r\n    this.saveQueue();\r\n    this.notify();\r\n    \r\n    // Processa prossimo download\r\n    this.processQueue();\r\n  }\r\n\r\n  // Aggiungi a cronologia\r\n  addToHistory(downloadItem) {\r\n    const historyEntry = {\r\n      id: downloadItem.id,\r\n      filename: downloadItem.filename,\r\n      tool: downloadItem.tool,\r\n      metadata: downloadItem.metadata,\r\n      status: downloadItem.status,\r\n      size: downloadItem.size,\r\n      createdAt: downloadItem.createdAt,\r\n      completedAt: downloadItem.endTime || new Date().toISOString(),\r\n      error: downloadItem.error\r\n    };\r\n\r\n    this.history.unshift(historyEntry);\r\n    \r\n    // Mantieni solo ultimi 100\r\n    if (this.history.length > 100) {\r\n      this.history = this.history.slice(0, 100);\r\n    }\r\n    \r\n    this.saveHistory();\r\n  }\r\n\r\n  // Riprendi download interrotti al caricamento\r\n  resumeInterruptedDownloads() {\r\n    if (typeof window === 'undefined') return;\r\n    \r\n    // Cerca download con status 'downloading' nella coda\r\n    const interrupted = this.queue.filter(item => item.status === 'downloading');\r\n    interrupted.forEach(item => {\r\n      item.status = 'pending';\r\n      item.error = null;\r\n    });\r\n    \r\n    if (interrupted.length > 0) {\r\n      this.saveQueue();\r\n      this.notify();\r\n      this.processQueue();\r\n    }\r\n  }\r\n\r\n  // Ottieni stato corrente\r\n  getState() {\r\n    return {\r\n      queue: [...this.queue],\r\n      activeDownloads: Array.from(this.activeDownloads.values()),\r\n      history: [...this.history],\r\n      stats: {\r\n        pending: this.queue.filter(item => item.status === 'pending').length,\r\n        downloading: Array.from(this.activeDownloads.values())\r\n          .filter(item => item.status === 'downloading').length,\r\n        completed: this.history.filter(item => item.status === 'completed').length,\r\n        failed: this.history.filter(item => item.status === 'failed').length\r\n      }\r\n    };\r\n  }\r\n\r\n  // Pulisci cronologia\r\n  clearHistory() {\r\n    this.history = [];\r\n    this.saveHistory();\r\n    this.notify();\r\n  }\r\n\r\n  // Rimuovi elemento dalla cronologia\r\n  removeFromHistory(downloadId) {\r\n    this.history = this.history.filter(item => item.id !== downloadId);\r\n    this.saveHistory();\r\n    this.notify();\r\n  }\r\n}\r\n\r\n// Singleton instance\r\nlet downloadManagerInstance = null;\r\n\r\nexport function getDownloadManager() {\r\n  if (typeof window === 'undefined') {\r\n    // Server-side: ritorna mock object\r\n    return {\r\n      addDownload: () => {},\r\n      resumeDownload: () => {},\r\n      pauseDownload: () => {},\r\n      cancelDownload: () => {},\r\n      addListener: () => () => {},\r\n      getState: () => ({ queue: [], activeDownloads: [], history: [], stats: {} }),\r\n      clearHistory: () => {},\r\n      removeFromHistory: () => {}\r\n    };\r\n  }\r\n\r\n  if (!downloadManagerInstance) {\r\n    downloadManagerInstance = new DownloadManager();\r\n  }\r\n  \r\n  return downloadManagerInstance;\r\n}\r\n\r\n// Utility per formattare dimensioni file\r\nexport function formatFileSize(bytes) {\r\n  if (!bytes || bytes === 0) return '0 B';\r\n  \r\n  const k = 1024;\r\n  const sizes = ['B', 'KB', 'MB', 'GB'];\r\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n  \r\n  return Math.round((bytes / Math.pow(k, i)) * 100) / 100 + ' ' + sizes[i];\r\n}\r\n\r\n// Utility per formattare velocità\r\nexport function formatSpeed(bytesPerSecond) {\r\n  if (!bytesPerSecond) return '0 B/s';\r\n  return formatFileSize(bytesPerSecond) + '/s';\r\n}\r\n\r\n// Utility per formattare tempo rimanente\r\nexport function formatTimeRemaining(downloaded, total, speed) {\r\n  if (!speed || speed === 0 || !total) return '--';\r\n  \r\n  const remaining = total - downloaded;\r\n  const seconds = Math.ceil(remaining / speed);\r\n  \r\n  if (seconds < 60) return `${seconds}s`;\r\n  if (seconds < 3600) return `${Math.floor(seconds / 60)}m ${seconds % 60}s`;\r\n  \r\n  const hours = Math.floor(seconds / 3600);\r\n  const minutes = Math.floor((seconds % 3600) / 60);\r\n  return `${hours}h ${minutes}m`;\r\n}\r\n\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1443, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jurit/OneDrive/Desktop/sito%20upscale/lib/useDownloadManager.js"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\r\nimport { getDownloadManager } from './downloadManager';\r\n\r\nexport function useDownloadManager() {\r\n  const [state, setState] = useState(() => {\r\n    const manager = getDownloadManager();\r\n    return manager.getState();\r\n  });\r\n\r\n  useEffect(() => {\r\n    const manager = getDownloadManager();\r\n    \r\n    const unsubscribe = manager.addListener((newState) => {\r\n      setState(manager.getState());\r\n    });\r\n\r\n    // Aggiorna stato iniziale\r\n    setState(manager.getState());\r\n\r\n    return unsubscribe;\r\n  }, []);\r\n\r\n  const addDownload = useCallback((options) => {\r\n    const manager = getDownloadManager();\r\n    return manager.addDownload(options);\r\n  }, []);\r\n\r\n  const resumeDownload = useCallback((downloadId) => {\r\n    const manager = getDownloadManager();\r\n    return manager.resumeDownload(downloadId);\r\n  }, []);\r\n\r\n  const pauseDownload = useCallback((downloadId) => {\r\n    const manager = getDownloadManager();\r\n    return manager.pauseDownload(downloadId);\r\n  }, []);\r\n\r\n  const cancelDownload = useCallback((downloadId) => {\r\n    const manager = getDownloadManager();\r\n    manager.cancelDownload(downloadId);\r\n  }, []);\r\n\r\n  const clearHistory = useCallback(() => {\r\n    const manager = getDownloadManager();\r\n    manager.clearHistory();\r\n  }, []);\r\n\r\n  const removeFromHistory = useCallback((downloadId) => {\r\n    const manager = getDownloadManager();\r\n    manager.removeFromHistory(downloadId);\r\n  }, []);\r\n\r\n  return {\r\n    ...state,\r\n    addDownload,\r\n    resumeDownload,\r\n    pauseDownload,\r\n    cancelDownload,\r\n    clearHistory,\r\n    removeFromHistory\r\n  };\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS;IACd,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,+GAAQ,EAAC;QACjC,MAAM,UAAU,IAAA,qIAAkB;QAClC,OAAO,QAAQ,QAAQ;IACzB;IAEA,IAAA,gHAAS,EAAC;QACR,MAAM,UAAU,IAAA,qIAAkB;QAElC,MAAM,cAAc,QAAQ,WAAW,CAAC,CAAC;YACvC,SAAS,QAAQ,QAAQ;QAC3B;QAEA,0BAA0B;QAC1B,SAAS,QAAQ,QAAQ;QAEzB,OAAO;IACT,GAAG,EAAE;IAEL,MAAM,cAAc,IAAA,kHAAW,EAAC,CAAC;QAC/B,MAAM,UAAU,IAAA,qIAAkB;QAClC,OAAO,QAAQ,WAAW,CAAC;IAC7B,GAAG,EAAE;IAEL,MAAM,iBAAiB,IAAA,kHAAW,EAAC,CAAC;QAClC,MAAM,UAAU,IAAA,qIAAkB;QAClC,OAAO,QAAQ,cAAc,CAAC;IAChC,GAAG,EAAE;IAEL,MAAM,gBAAgB,IAAA,kHAAW,EAAC,CAAC;QACjC,MAAM,UAAU,IAAA,qIAAkB;QAClC,OAAO,QAAQ,aAAa,CAAC;IAC/B,GAAG,EAAE;IAEL,MAAM,iBAAiB,IAAA,kHAAW,EAAC,CAAC;QAClC,MAAM,UAAU,IAAA,qIAAkB;QAClC,QAAQ,cAAc,CAAC;IACzB,GAAG,EAAE;IAEL,MAAM,eAAe,IAAA,kHAAW,EAAC;QAC/B,MAAM,UAAU,IAAA,qIAAkB;QAClC,QAAQ,YAAY;IACtB,GAAG,EAAE;IAEL,MAAM,oBAAoB,IAAA,kHAAW,EAAC,CAAC;QACrC,MAAM,UAAU,IAAA,qIAAkB;QAClC,QAAQ,iBAAiB,CAAC;IAC5B,GAAG,EAAE;IAEL,OAAO;QACL,GAAG,KAAK;QACR;QACA;QACA;QACA;QACA;QACA;IACF;AACF"}},
    {"offset": {"line": 1503, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jurit/OneDrive/Desktop/sito%20upscale/components/DownloadManager.js"],"sourcesContent":["import { useState } from 'react';\r\nimport { \r\n  HiDownload, HiX, HiPause, HiPlay, HiTrash, HiClock, \r\n  HiCheckCircle, HiExclamationCircle, HiChevronDown, HiChevronUp\r\n} from 'react-icons/hi';\r\nimport { useDownloadManager } from '../lib/useDownloadManager';\r\nimport { formatFileSize, formatSpeed, formatTimeRemaining } from '../lib/downloadManager';\r\n\r\nexport default function DownloadManager() {\r\n  const {\r\n    queue,\r\n    activeDownloads,\r\n    history,\r\n    stats,\r\n    resumeDownload,\r\n    pauseDownload,\r\n    cancelDownload,\r\n    clearHistory,\r\n    removeFromHistory\r\n  } = useDownloadManager();\r\n\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [activeTab, setActiveTab] = useState('queue'); // 'queue' | 'history'\r\n  const [expandedItems, setExpandedItems] = useState(new Set());\r\n\r\n  // Combina coda e download attivi\r\n  const allActive = [\r\n    ...queue.filter(item => item.status === 'pending'),\r\n    ...Array.from(activeDownloads.values())\r\n  ];\r\n\r\n  const toggleExpanded = (id) => {\r\n    const newExpanded = new Set(expandedItems);\r\n    if (newExpanded.has(id)) {\r\n      newExpanded.delete(id);\r\n    } else {\r\n      newExpanded.add(id);\r\n    }\r\n    setExpandedItems(newExpanded);\r\n  };\r\n\r\n  const getStatusIcon = (status) => {\r\n    switch (status) {\r\n      case 'completed':\r\n        return <HiCheckCircle style={{ width: 18, height: 18, color: '#10b981' }} />;\r\n      case 'failed':\r\n        return <HiExclamationCircle style={{ width: 18, height: 18, color: '#ef4444' }} />;\r\n      case 'downloading':\r\n        return <div style={styles.spinner}></div>;\r\n      case 'paused':\r\n        return <HiPause style={{ width: 18, height: 18, color: '#f59e0b' }} />;\r\n      default:\r\n        return <HiClock style={{ width: 18, height: 18, color: '#94a3b8' }} />;\r\n    }\r\n  };\r\n\r\n  const getStatusText = (status) => {\r\n    switch (status) {\r\n      case 'completed':\r\n        return 'Completato';\r\n      case 'failed':\r\n        return 'Fallito';\r\n      case 'downloading':\r\n        return 'In download...';\r\n      case 'paused':\r\n        return 'In pausa';\r\n      case 'pending':\r\n        return 'In attesa';\r\n      default:\r\n        return status;\r\n    }\r\n  };\r\n\r\n  // Conta download attivi per badge\r\n  const activeCount = allActive.length;\r\n\r\n  if (!isOpen && activeCount === 0) {\r\n    return null; // Non mostrare nulla se non ci sono download\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {/* Floating Button */}\r\n      {activeCount > 0 && (\r\n        <button\r\n          onClick={() => setIsOpen(true)}\r\n          style={styles.floatingButton}\r\n          aria-label=\"Download Manager\"\r\n        >\r\n          <HiDownload style={{ width: 20, height: 20 }} />\r\n          {activeCount > 0 && (\r\n            <span style={styles.badge}>{activeCount}</span>\r\n          )}\r\n        </button>\r\n      )}\r\n\r\n      {/* Modal/Panel */}\r\n      {isOpen && (\r\n        <div style={styles.overlay} onClick={() => setIsOpen(false)}>\r\n          <div style={styles.panel} onClick={(e) => e.stopPropagation()}>\r\n            {/* Header */}\r\n            <div style={styles.header}>\r\n              <div style={styles.headerLeft}>\r\n                <HiDownload style={{ width: 24, height: 24 }} />\r\n                <h2 style={styles.title}>Download Manager</h2>\r\n                {stats.downloading > 0 && (\r\n                  <span style={styles.activeBadge}>\r\n                    {stats.downloading} attivo{stats.downloading > 1 ? 'i' : ''}\r\n                  </span>\r\n                )}\r\n              </div>\r\n              <button\r\n                onClick={() => setIsOpen(false)}\r\n                style={styles.closeButton}\r\n                aria-label=\"Chiudi\"\r\n              >\r\n                <HiX style={{ width: 20, height: 20 }} />\r\n              </button>\r\n            </div>\r\n\r\n            {/* Tabs */}\r\n            <div style={styles.tabs}>\r\n              <button\r\n                onClick={() => setActiveTab('queue')}\r\n                style={{\r\n                  ...styles.tab,\r\n                  ...(activeTab === 'queue' ? styles.tabActive : {})\r\n                }}\r\n              >\r\n                Coda ({allActive.length})\r\n              </button>\r\n              <button\r\n                onClick={() => setActiveTab('history')}\r\n                style={{\r\n                  ...styles.tab,\r\n                  ...(activeTab === 'history' ? styles.tabActive : {})\r\n                }}\r\n              >\r\n                Cronologia ({history.length})\r\n              </button>\r\n            </div>\r\n\r\n            {/* Content */}\r\n            <div style={styles.content}>\r\n              {activeTab === 'queue' ? (\r\n                <div style={styles.queueContainer}>\r\n                  {allActive.length === 0 ? (\r\n                    <div style={styles.emptyState}>\r\n                      <HiCheckCircle style={{ width: 48, height: 48, color: '#94a3b8', marginBottom: '16px' }} />\r\n                      <p style={styles.emptyText}>Nessun download in corso</p>\r\n                    </div>\r\n                  ) : (\r\n                    allActive.map((item) => (\r\n                      <div key={item.id} style={styles.downloadItem}>\r\n                        <div style={styles.downloadHeader}>\r\n                          <div style={styles.downloadInfo}>\r\n                            {getStatusIcon(item.status)}\r\n                            <div style={styles.downloadDetails}>\r\n                              <div style={styles.filename}>{item.filename}</div>\r\n                              <div style={styles.meta}>\r\n                                {item.tool && (\r\n                                  <span style={styles.toolTag}>{item.tool}</span>\r\n                                )}\r\n                                {item.size > 0 && (\r\n                                  <span style={styles.size}>{formatFileSize(item.size)}</span>\r\n                                )}\r\n                                <span style={styles.status}>{getStatusText(item.status)}</span>\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                          <div style={styles.downloadActions}>\r\n                            {item.status === 'downloading' && (\r\n                              <button\r\n                                onClick={() => pauseDownload(item.id)}\r\n                                style={styles.actionButton}\r\n                                title=\"Pausa\"\r\n                              >\r\n                                <HiPause style={{ width: 16, height: 16 }} />\r\n                              </button>\r\n                            )}\r\n                            {(item.status === 'paused' || item.status === 'failed') && (\r\n                              <button\r\n                                onClick={() => resumeDownload(item.id)}\r\n                                style={styles.actionButton}\r\n                                title=\"Riprendi\"\r\n                              >\r\n                                <HiPlay style={{ width: 16, height: 16 }} />\r\n                              </button>\r\n                            )}\r\n                            <button\r\n                              onClick={() => cancelDownload(item.id)}\r\n                              style={styles.actionButton}\r\n                              title=\"Cancella\"\r\n                            >\r\n                              <HiX style={{ width: 16, height: 16 }} />\r\n                            </button>\r\n                            <button\r\n                              onClick={() => toggleExpanded(item.id)}\r\n                              style={styles.actionButton}\r\n                              title=\"Dettagli\"\r\n                            >\r\n                              {expandedItems.has(item.id) ? (\r\n                                <HiChevronUp style={{ width: 16, height: 16 }} />\r\n                              ) : (\r\n                                <HiChevronDown style={{ width: 16, height: 16 }} />\r\n                              )}\r\n                            </button>\r\n                          </div>\r\n                        </div>\r\n\r\n                        {/* Progress Bar */}\r\n                        {item.status === 'downloading' && (\r\n                          <div style={styles.progressContainer}>\r\n                            <div style={styles.progressBar}>\r\n                              <div\r\n                                style={{\r\n                                  ...styles.progressFill,\r\n                                  width: `${item.progress || 0}%`\r\n                                }}\r\n                              />\r\n                            </div>\r\n                            <div style={styles.progressInfo}>\r\n                              <span>{item.progress || 0}%</span>\r\n                              {item.speed > 0 && (\r\n                                <span>{formatSpeed(item.speed)}</span>\r\n                              )}\r\n                              {item.size > 0 && item.downloaded > 0 && item.speed > 0 && (\r\n                                <span>\r\n                                  {formatTimeRemaining(item.downloaded, item.size, item.speed)} rimanenti\r\n                                </span>\r\n                              )}\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n\r\n                        {/* Expanded Details */}\r\n                        {expandedItems.has(item.id) && (\r\n                          <div style={styles.expandedDetails}>\r\n                            <div style={styles.detailRow}>\r\n                              <span style={styles.detailLabel}>ID:</span>\r\n                              <span style={styles.detailValue}>{item.id}</span>\r\n                            </div>\r\n                            {item.metadata && Object.keys(item.metadata).length > 0 && (\r\n                              <div style={styles.detailRow}>\r\n                                <span style={styles.detailLabel}>Metadata:</span>\r\n                                <span style={styles.detailValue}>\r\n                                  {JSON.stringify(item.metadata, null, 2)}\r\n                                </span>\r\n                              </div>\r\n                            )}\r\n                            {item.error && (\r\n                              <div style={styles.detailRow}>\r\n                                <span style={styles.detailLabel}>Errore:</span>\r\n                                <span style={{ ...styles.detailValue, color: '#ef4444' }}>\r\n                                  {item.error}\r\n                                </span>\r\n                              </div>\r\n                            )}\r\n                            {item.createdAt && (\r\n                              <div style={styles.detailRow}>\r\n                                <span style={styles.detailLabel}>Creato:</span>\r\n                                <span style={styles.detailValue}>\r\n                                  {new Date(item.createdAt).toLocaleString('it-IT')}\r\n                                </span>\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    ))\r\n                  )}\r\n                </div>\r\n              ) : (\r\n                <div style={styles.historyContainer}>\r\n                  {history.length === 0 ? (\r\n                    <div style={styles.emptyState}>\r\n                      <HiClock style={{ width: 48, height: 48, color: '#94a3b8', marginBottom: '16px' }} />\r\n                      <p style={styles.emptyText}>Nessun download nella cronologia</p>\r\n                    </div>\r\n                  ) : (\r\n                    <>\r\n                      <div style={styles.historyHeader}>\r\n                        <button\r\n                          onClick={clearHistory}\r\n                          style={styles.clearButton}\r\n                        >\r\n                          <HiTrash style={{ width: 16, height: 16 }} />\r\n                          Pulisci cronologia\r\n                        </button>\r\n                      </div>\r\n                      {history.map((item) => (\r\n                        <div key={item.id} style={styles.historyItem}>\r\n                          <div style={styles.historyHeaderItem}>\r\n                            <div style={styles.historyInfo}>\r\n                              {getStatusIcon(item.status)}\r\n                              <div style={styles.historyDetails}>\r\n                                <div style={styles.filename}>{item.filename}</div>\r\n                                <div style={styles.meta}>\r\n                                  {item.tool && (\r\n                                    <span style={styles.toolTag}>{item.tool}</span>\r\n                                  )}\r\n                                  {item.size > 0 && (\r\n                                    <span style={styles.size}>{formatFileSize(item.size)}</span>\r\n                                  )}\r\n                                  <span style={styles.status}>{getStatusText(item.status)}</span>\r\n                                  {item.completedAt && (\r\n                                    <span style={styles.date}>\r\n                                      {new Date(item.completedAt).toLocaleString('it-IT')}\r\n                                    </span>\r\n                                  )}\r\n                                </div>\r\n                              </div>\r\n                            </div>\r\n                            <button\r\n                              onClick={() => removeFromHistory(item.id)}\r\n                              style={styles.actionButton}\r\n                              title=\"Rimuovi\"\r\n                            >\r\n                              <HiTrash style={{ width: 16, height: 16 }} />\r\n                            </button>\r\n                          </div>\r\n                          {item.status === 'failed' && item.error && (\r\n                            <div style={styles.errorMessage}>\r\n                              <HiExclamationCircle style={{ width: 16, height: 16 }} />\r\n                              <span>{item.error}</span>\r\n                            </div>\r\n                          )}\r\n                          {item.status === 'failed' && (\r\n                            <button\r\n                              onClick={() => resumeDownload(item.id)}\r\n                              style={styles.resumeButton}\r\n                            >\r\n                              <HiPlay style={{ width: 16, height: 16 }} />\r\n                              Riprendi download\r\n                            </button>\r\n                          )}\r\n                        </div>\r\n                      ))}\r\n                    </>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Footer Stats */}\r\n            <div style={styles.footer}>\r\n              <div style={styles.stats}>\r\n                <span>Completati: {stats.completed || 0}</span>\r\n                <span>Falliti: {stats.failed || 0}</span>\r\n                <span>In attesa: {stats.pending || 0}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n\r\nconst styles = {\r\n  overlay: {\r\n    position: 'fixed',\r\n    top: 0,\r\n    left: 0,\r\n    right: 0,\r\n    bottom: 0,\r\n    background: 'rgba(0, 0, 0, 0.7)',\r\n    backdropFilter: 'blur(8px)',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    zIndex: 10000,\r\n    padding: '20px'\r\n  },\r\n  panel: {\r\n    background: 'rgba(15, 23, 42, 0.98)',\r\n    border: '1px solid rgba(102, 126, 234, 0.3)',\r\n    borderRadius: '16px',\r\n    maxWidth: '700px',\r\n    width: '100%',\r\n    maxHeight: '80vh',\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    boxShadow: '0 20px 60px rgba(0, 0, 0, 0.5)'\r\n  },\r\n  header: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'space-between',\r\n    padding: '20px 24px',\r\n    borderBottom: '1px solid rgba(102, 126, 234, 0.2)'\r\n  },\r\n  headerLeft: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    gap: '12px'\r\n  },\r\n  title: {\r\n    margin: 0,\r\n    fontSize: '20px',\r\n    fontWeight: '700',\r\n    color: '#e2e8f0'\r\n  },\r\n  activeBadge: {\r\n    padding: '4px 10px',\r\n    background: 'rgba(16, 185, 129, 0.2)',\r\n    border: '1px solid rgba(16, 185, 129, 0.3)',\r\n    borderRadius: '12px',\r\n    fontSize: '12px',\r\n    fontWeight: '600',\r\n    color: '#10b981'\r\n  },\r\n  closeButton: {\r\n    background: 'rgba(102, 126, 234, 0.1)',\r\n    border: 'none',\r\n    borderRadius: '8px',\r\n    padding: '8px',\r\n    cursor: 'pointer',\r\n    color: '#cbd5e1',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    transition: 'background 0.2s'\r\n  },\r\n  tabs: {\r\n    display: 'flex',\r\n    borderBottom: '1px solid rgba(102, 126, 234, 0.2)'\r\n  },\r\n  tab: {\r\n    flex: 1,\r\n    padding: '12px 20px',\r\n    background: 'transparent',\r\n    border: 'none',\r\n    borderBottom: '2px solid transparent',\r\n    color: '#94a3b8',\r\n    fontSize: '14px',\r\n    fontWeight: '600',\r\n    cursor: 'pointer',\r\n    transition: 'all 0.2s'\r\n  },\r\n  tabActive: {\r\n    color: '#667eea',\r\n    borderBottomColor: '#667eea'\r\n  },\r\n  content: {\r\n    flex: 1,\r\n    overflowY: 'auto',\r\n    padding: '20px'\r\n  },\r\n  queueContainer: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    gap: '12px'\r\n  },\r\n  historyContainer: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    gap: '12px'\r\n  },\r\n  historyHeader: {\r\n    display: 'flex',\r\n    justifyContent: 'flex-end',\r\n    marginBottom: '8px'\r\n  },\r\n  clearButton: {\r\n    padding: '8px 16px',\r\n    background: 'rgba(239, 68, 68, 0.1)',\r\n    border: '1px solid rgba(239, 68, 68, 0.3)',\r\n    borderRadius: '8px',\r\n    color: '#ef4444',\r\n    fontSize: '13px',\r\n    fontWeight: '600',\r\n    cursor: 'pointer',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    gap: '6px',\r\n    transition: 'all 0.2s'\r\n  },\r\n  downloadItem: {\r\n    background: 'rgba(30, 41, 59, 0.5)',\r\n    border: '1px solid rgba(102, 126, 234, 0.2)',\r\n    borderRadius: '12px',\r\n    padding: '16px',\r\n    transition: 'all 0.2s'\r\n  },\r\n  historyItem: {\r\n    background: 'rgba(30, 41, 59, 0.5)',\r\n    border: '1px solid rgba(102, 126, 234, 0.2)',\r\n    borderRadius: '12px',\r\n    padding: '16px',\r\n    transition: 'all 0.2s'\r\n  },\r\n  downloadHeader: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'space-between',\r\n    gap: '12px'\r\n  },\r\n  historyHeaderItem: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'space-between',\r\n    gap: '12px'\r\n  },\r\n  downloadInfo: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    gap: '12px',\r\n    flex: 1,\r\n    minWidth: 0\r\n  },\r\n  historyInfo: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    gap: '12px',\r\n    flex: 1,\r\n    minWidth: 0\r\n  },\r\n  downloadDetails: {\r\n    flex: 1,\r\n    minWidth: 0\r\n  },\r\n  historyDetails: {\r\n    flex: 1,\r\n    minWidth: 0\r\n  },\r\n  filename: {\r\n    fontSize: '14px',\r\n    fontWeight: '600',\r\n    color: '#e2e8f0',\r\n    marginBottom: '4px',\r\n    overflow: 'hidden',\r\n    textOverflow: 'ellipsis',\r\n    whiteSpace: 'nowrap'\r\n  },\r\n  meta: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    gap: '8px',\r\n    flexWrap: 'wrap',\r\n    fontSize: '12px',\r\n    color: '#94a3b8'\r\n  },\r\n  toolTag: {\r\n    padding: '2px 8px',\r\n    background: 'rgba(102, 126, 234, 0.2)',\r\n    borderRadius: '6px',\r\n    color: '#a78bfa',\r\n    fontWeight: '500'\r\n  },\r\n  size: {\r\n    color: '#94a3b8'\r\n  },\r\n  status: {\r\n    color: '#94a3b8'\r\n  },\r\n  date: {\r\n    color: '#64748b',\r\n    fontSize: '11px'\r\n  },\r\n  downloadActions: {\r\n    display: 'flex',\r\n    gap: '6px'\r\n  },\r\n  actionButton: {\r\n    padding: '6px',\r\n    background: 'rgba(102, 126, 234, 0.1)',\r\n    border: '1px solid rgba(102, 126, 234, 0.2)',\r\n    borderRadius: '6px',\r\n    color: '#cbd5e1',\r\n    cursor: 'pointer',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    transition: 'all 0.2s'\r\n  },\r\n  progressContainer: {\r\n    marginTop: '12px'\r\n  },\r\n  progressBar: {\r\n    width: '100%',\r\n    height: '6px',\r\n    background: 'rgba(102, 126, 234, 0.2)',\r\n    borderRadius: '3px',\r\n    overflow: 'hidden',\r\n    marginBottom: '8px'\r\n  },\r\n  progressFill: {\r\n    height: '100%',\r\n    background: 'linear-gradient(90deg, #667eea 0%, #764ba2 100%)',\r\n    transition: 'width 0.3s ease',\r\n    borderRadius: '3px'\r\n  },\r\n  progressInfo: {\r\n    display: 'flex',\r\n    justifyContent: 'space-between',\r\n    fontSize: '11px',\r\n    color: '#94a3b8',\r\n    gap: '12px'\r\n  },\r\n  expandedDetails: {\r\n    marginTop: '12px',\r\n    paddingTop: '12px',\r\n    borderTop: '1px solid rgba(102, 126, 234, 0.1)',\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    gap: '8px'\r\n  },\r\n  detailRow: {\r\n    display: 'flex',\r\n    gap: '8px',\r\n    fontSize: '12px'\r\n  },\r\n  detailLabel: {\r\n    fontWeight: '600',\r\n    color: '#94a3b8',\r\n    minWidth: '80px'\r\n  },\r\n  detailValue: {\r\n    color: '#cbd5e1',\r\n    wordBreak: 'break-word'\r\n  },\r\n  errorMessage: {\r\n    marginTop: '8px',\r\n    padding: '8px 12px',\r\n    background: 'rgba(239, 68, 68, 0.1)',\r\n    border: '1px solid rgba(239, 68, 68, 0.2)',\r\n    borderRadius: '6px',\r\n    color: '#ef4444',\r\n    fontSize: '12px',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    gap: '6px'\r\n  },\r\n  resumeButton: {\r\n    marginTop: '8px',\r\n    padding: '8px 16px',\r\n    background: 'rgba(102, 126, 234, 0.2)',\r\n    border: '1px solid rgba(102, 126, 234, 0.3)',\r\n    borderRadius: '8px',\r\n    color: '#a78bfa',\r\n    fontSize: '13px',\r\n    fontWeight: '600',\r\n    cursor: 'pointer',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    gap: '6px',\r\n    transition: 'all 0.2s'\r\n  },\r\n  emptyState: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    padding: '60px 20px',\r\n    textAlign: 'center'\r\n  },\r\n  emptyText: {\r\n    fontSize: '14px',\r\n    color: '#94a3b8',\r\n    margin: 0\r\n  },\r\n  footer: {\r\n    padding: '16px 24px',\r\n    borderTop: '1px solid rgba(102, 126, 234, 0.2)'\r\n  },\r\n  stats: {\r\n    display: 'flex',\r\n    justifyContent: 'space-around',\r\n    fontSize: '12px',\r\n    color: '#94a3b8',\r\n    gap: '16px'\r\n  },\r\n  floatingButton: {\r\n    position: 'fixed',\r\n    bottom: '24px',\r\n    right: '24px',\r\n    width: '56px',\r\n    height: '56px',\r\n    borderRadius: '50%',\r\n    background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\r\n    border: 'none',\r\n    color: '#ffffff',\r\n    cursor: 'pointer',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    boxShadow: '0 8px 24px rgba(102, 126, 234, 0.4)',\r\n    zIndex: 9999,\r\n    transition: 'all 0.3s',\r\n    position: 'relative'\r\n  },\r\n  badge: {\r\n    position: 'absolute',\r\n    top: '-4px',\r\n    right: '-4px',\r\n    background: '#ef4444',\r\n    color: '#ffffff',\r\n    fontSize: '12px',\r\n    fontWeight: '700',\r\n    width: '20px',\r\n    height: '20px',\r\n    borderRadius: '50%',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center'\r\n  },\r\n  spinner: {\r\n    width: '18px',\r\n    height: '18px',\r\n    border: '2px solid rgba(102, 126, 234, 0.3)',\r\n    borderTopColor: '#667eea',\r\n    borderRadius: '50%',\r\n    animation: 'spin 1s linear infinite'\r\n  }\r\n};\r\n\r\n// Aggiungi animazione spinner\r\nif (typeof document !== 'undefined') {\r\n  const styleId = 'download-manager-spinner';\r\n  if (!document.getElementById(styleId)) {\r\n    const style = document.createElement('style');\r\n    style.id = styleId;\r\n    style.textContent = `\r\n      @keyframes spin {\r\n        to { transform: rotate(360deg); }\r\n      }\r\n    `;\r\n    document.head.appendChild(style);\r\n  }\r\n}\r\n\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2804, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jurit/OneDrive/Desktop/sito%20upscale/lib/supportKnowledgeBase.js"],"sourcesContent":["// Base di conoscenza per il supporto - FAQ e risposte intelligenti\r\n\r\nexport const supportCategories = {\r\n  general: 'Generale',\r\n  tools: 'Strumenti',\r\n  account: 'Account',\r\n  billing: 'Fatturazione',\r\n  technical: 'Tecnico',\r\n  features: 'Funzionalità'\r\n};\r\n\r\nexport const faqDatabase = [\r\n  // Generale\r\n  {\r\n    id: 'faq-1',\r\n    category: 'general',\r\n    question: 'Cos\\'è MegaPixelAI?',\r\n    answer: 'MegaPixelAI è una piattaforma completa di strumenti AI per immagini, documenti, video e audio. Offriamo upscaling immagini, rimozione sfondo, OCR avanzato, conversione file, e molto altro.',\r\n    keywords: ['cosa', 'cos\\'è', 'megapixel', 'piattaforma', 'strumenti'],\r\n    relatedTools: ['upscaler', 'background-remover', 'ocr']\r\n  },\r\n  {\r\n    id: 'faq-2',\r\n    category: 'general',\r\n    question: 'Come funziona?',\r\n    answer: 'È semplice! Carica il tuo file, scegli lo strumento che preferisci, e ottieni il risultato in pochi secondi. Tutti i processi avvengono in modo sicuro e privato.',\r\n    keywords: ['come', 'funziona', 'usare', 'utilizzare', 'processo'],\r\n    relatedTools: []\r\n  },\r\n  {\r\n    id: 'faq-3',\r\n    category: 'general',\r\n    question: 'È gratuito?',\r\n    answer: 'Offriamo un piano gratuito con funzionalità base. Per funzionalità avanzate e maggiore velocità, puoi passare a un piano Pro. Visita la pagina Pricing per maggiori dettagli.',\r\n    keywords: ['gratuito', 'prezzo', 'costo', 'piano', 'abbonamento', 'free'],\r\n    relatedTools: []\r\n  },\r\n\r\n  // Strumenti\r\n  {\r\n    id: 'faq-4',\r\n    category: 'tools',\r\n    question: 'Quali formati di file sono supportati?',\r\n    answer: 'Supportiamo un\\'ampia gamma di formati:\\n\\n**Immagini:** JPG, PNG, WEBP, GIF, BMP, TIFF\\n**Documenti:** PDF, DOCX, DOC, TXT, RTF\\n**Fogli di calcolo:** XLSX, XLS, CSV\\n**Presentazioni:** PPTX, PPT\\n**Video:** MP4, AVI, MOV, MKV\\n**Audio:** MP3, WAV, OGG, FLAC\\n**Archivi:** ZIP, RAR, 7Z, TAR',\r\n    keywords: ['formati', 'formato', 'supportati', 'file', 'tipi', 'estensioni'],\r\n    relatedTools: ['pdf-converter', 'generic-converter']\r\n  },\r\n  {\r\n    id: 'faq-5',\r\n    category: 'tools',\r\n    question: 'Come funziona l\\'upscaling delle immagini?',\r\n    answer: 'Il nostro upscaler AI utilizza algoritmi avanzati di deep learning per aumentare la risoluzione delle immagini fino a 4x mantenendo la qualità. Basta caricare l\\'immagine e scegliere il fattore di upscaling desiderato.',\r\n    keywords: ['upscale', 'upscaling', 'risoluzione', 'immagine', 'qualità', 'ingrandire'],\r\n    relatedTools: ['upscaler']\r\n  },\r\n  {\r\n    id: 'faq-6',\r\n    category: 'tools',\r\n    question: 'Posso rimuovere lo sfondo da qualsiasi immagine?',\r\n    answer: 'Sì! Il nostro strumento di rimozione sfondo AI funziona con qualsiasi immagine. Funziona meglio con immagini che hanno un soggetto chiaro e uno sfondo contrastante.',\r\n    keywords: ['sfondo', 'rimuovere', 'background', 'remove', 'trasparente'],\r\n    relatedTools: ['rimozione-sfondo-ai']\r\n  },\r\n  {\r\n    id: 'faq-7',\r\n    category: 'tools',\r\n    question: 'Come funziona l\\'OCR?',\r\n    answer: 'L\\'OCR (Optical Character Recognition) avanzato estrae testo da immagini, PDF scansionati e documenti. Supporta più di 100 lingue e mantiene la formattazione quando possibile.',\r\n    keywords: ['ocr', 'testo', 'estrarre', 'immagine', 'pdf', 'scansionato'],\r\n    relatedTools: ['ocr-avanzato-ai']\r\n  },\r\n  {\r\n    id: 'faq-8',\r\n    category: 'tools',\r\n    question: 'Posso convertire più file contemporaneamente?',\r\n    answer: 'Sì! Molti strumenti supportano il batch processing. Puoi caricare più file e processarli tutti in una volta. I risultati verranno forniti come download singoli o in un archivio ZIP.',\r\n    keywords: ['batch', 'multipli', 'più file', 'contemporaneamente', 'bulk'],\r\n    relatedTools: ['combina-splitta-pdf', 'generic-converter']\r\n  },\r\n\r\n  // Account\r\n  {\r\n    id: 'faq-9',\r\n    category: 'account',\r\n    question: 'Come creo un account?',\r\n    answer: 'Clicca su \"Registrati\" in alto a destra, inserisci nome, email e password. Riceverai un\\'email di conferma. Una volta confermato, avrai accesso a tutte le funzionalità.',\r\n    keywords: ['account', 'registrarsi', 'signup', 'iscriversi', 'creare'],\r\n    relatedTools: []\r\n  },\r\n  {\r\n    id: 'faq-10',\r\n    category: 'account',\r\n    question: 'Ho dimenticato la password',\r\n    answer: 'Vai alla pagina di login e clicca su \"Password dimenticata\". Inserisci la tua email e riceverai un link per reimpostare la password.',\r\n    keywords: ['password', 'dimenticata', 'reset', 'recuperare', 'forgot'],\r\n    relatedTools: []\r\n  },\r\n  {\r\n    id: 'faq-11',\r\n    category: 'account',\r\n    question: 'Come elimino il mio account?',\r\n    answer: 'Vai alla Dashboard, sezione Impostazioni, e clicca su \"Elimina Account\". Conferma l\\'operazione. Nota: questa azione è irreversibile.',\r\n    keywords: ['eliminare', 'cancellare', 'account', 'delete', 'rimuovere'],\r\n    relatedTools: []\r\n  },\r\n\r\n  // Fatturazione\r\n  {\r\n    id: 'faq-12',\r\n    category: 'billing',\r\n    question: 'Come funziona la fatturazione?',\r\n    answer: 'I piani Pro sono fatturati mensilmente o annualmente. Puoi cancellare in qualsiasi momento dalla Dashboard. Non ci sono costi nascosti o commissioni.',\r\n    keywords: ['fatturazione', 'billing', 'pagamento', 'piano', 'pro'],\r\n    relatedTools: []\r\n  },\r\n  {\r\n    id: 'faq-13',\r\n    category: 'billing',\r\n    question: 'Posso cambiare piano?',\r\n    answer: 'Sì! Puoi aggiornare o downgrade il tuo piano in qualsiasi momento dalla Dashboard. Le modifiche entrano in vigore immediatamente.',\r\n    keywords: ['cambiare', 'piano', 'upgrade', 'downgrade', 'modificare'],\r\n    relatedTools: []\r\n  },\r\n  {\r\n    id: 'faq-14',\r\n    category: 'billing',\r\n    question: 'Cosa succede se supero i limiti del piano?',\r\n    answer: 'Riceverai una notifica quando ti avvicini ai limiti. Puoi aggiornare il piano o attendere il reset mensile. Alcune funzionalità potrebbero essere temporaneamente limitate.',\r\n    keywords: ['limiti', 'superare', 'quota', 'limite', 'esaurito'],\r\n    relatedTools: []\r\n  },\r\n\r\n  // Tecnico\r\n  {\r\n    id: 'faq-15',\r\n    category: 'technical',\r\n    question: 'I miei file sono sicuri?',\r\n    answer: 'Assolutamente sì! Tutti i file vengono processati in modo sicuro e vengono eliminati automaticamente dopo 24 ore. Non condividiamo mai i tuoi file con terze parti.',\r\n    keywords: ['sicurezza', 'privacy', 'sicuro', 'dati', 'protezione'],\r\n    relatedTools: []\r\n  },\r\n  {\r\n    id: 'faq-16',\r\n    category: 'technical',\r\n    question: 'Qual è la dimensione massima del file?',\r\n    answer: 'Il limite dipende dal piano:\\n- **Gratuito:** 10 MB per file\\n- **Pro:** 100 MB per file\\n- **Enterprise:** 500 MB per file\\n\\nPer file più grandi, contattaci per soluzioni personalizzate.',\r\n    keywords: ['dimensione', 'dimensione massima', 'limite', 'size', 'mb'],\r\n    relatedTools: []\r\n  },\r\n  {\r\n    id: 'faq-17',\r\n    category: 'technical',\r\n    question: 'Il processo è veloce?',\r\n    answer: 'Sì! La maggior parte dei processi viene completata in pochi secondi. I tempi dipendono dalla dimensione del file e dalla complessità dell\\'operazione. I piani Pro hanno priorità più alta.',\r\n    keywords: ['velocità', 'veloce', 'tempo', 'quanto', 'lento'],\r\n    relatedTools: []\r\n  },\r\n  {\r\n    id: 'faq-18',\r\n    category: 'technical',\r\n    question: 'Cosa succede se il processo fallisce?',\r\n    answer: 'Se un processo fallisce, riceverai un messaggio di errore con dettagli. Puoi riprovare gratuitamente. Se il problema persiste, contatta il supporto con i dettagli dell\\'errore.',\r\n    keywords: ['errore', 'fallito', 'problema', 'non funziona', 'bug'],\r\n    relatedTools: []\r\n  },\r\n\r\n  // Funzionalità\r\n  {\r\n    id: 'faq-19',\r\n    category: 'features',\r\n    question: 'Cosa sono i crediti?',\r\n    answer: 'I crediti sono unità di consumo per le operazioni AI. Ogni operazione consuma un certo numero di crediti in base alla complessità. I crediti si ricaricano mensilmente o puoi acquistarli.',\r\n    keywords: ['crediti', 'credits', 'consumo', 'unità'],\r\n    relatedTools: []\r\n  },\r\n  {\r\n    id: 'faq-20',\r\n    category: 'features',\r\n    question: 'Posso usare l\\'API?',\r\n    answer: 'Sì! Offriamo un\\'API pubblica per sviluppatori. Visita la sezione API nella Dashboard per ottenere la tua API key e la documentazione completa.',\r\n    keywords: ['api', 'sviluppatori', 'developer', 'integrazione'],\r\n    relatedTools: []\r\n  },\r\n  {\r\n    id: 'faq-21',\r\n    category: 'features',\r\n    question: 'C\\'è un\\'app mobile?',\r\n    answer: 'Attualmente siamo disponibili solo come applicazione web responsive. Stiamo lavorando su app native iOS e Android. Iscriviti alla newsletter per essere aggiornato!',\r\n    keywords: ['mobile', 'app', 'ios', 'android', 'telefono'],\r\n    relatedTools: []\r\n  }\r\n];\r\n\r\n// Funzione per cercare nella base di conoscenza\r\nexport function searchKnowledgeBase(query) {\r\n  if (!query || query.trim().length < 2) {\r\n    return [];\r\n  }\r\n\r\n  const lowerQuery = query.toLowerCase().trim();\r\n  const words = lowerQuery.split(/\\s+/);\r\n\r\n  // Calcola score per ogni FAQ\r\n  const scoredFAQs = faqDatabase.map(faq => {\r\n    let score = 0;\r\n    const lowerQuestion = faq.question.toLowerCase();\r\n    const lowerAnswer = faq.answer.toLowerCase();\r\n    const lowerKeywords = faq.keywords.map(k => k.toLowerCase());\r\n\r\n    // Match esatto nella domanda (peso alto)\r\n    if (lowerQuestion.includes(lowerQuery)) {\r\n      score += 10;\r\n    }\r\n\r\n    // Match parziale nella domanda\r\n    words.forEach(word => {\r\n      if (lowerQuestion.includes(word)) {\r\n        score += 5;\r\n      }\r\n    });\r\n\r\n    // Match nelle keywords (peso medio)\r\n    words.forEach(word => {\r\n      if (lowerKeywords.some(k => k.includes(word) || lowerKeywords.includes(word))) {\r\n        score += 3;\r\n      }\r\n    });\r\n\r\n    // Match nella risposta (peso basso)\r\n    words.forEach(word => {\r\n      if (lowerAnswer.includes(word)) {\r\n        score += 1;\r\n      }\r\n    });\r\n\r\n    return { ...faq, score };\r\n  });\r\n\r\n  // Ordina per score e filtra\r\n  return scoredFAQs\r\n    .filter(faq => faq.score > 0)\r\n    .sort((a, b) => b.score - a.score)\r\n    .slice(0, 5); // Top 5 risultati\r\n}\r\n\r\n// Ottieni FAQ per categoria\r\nexport function getFAQsByCategory(category) {\r\n  return faqDatabase.filter(faq => faq.category === category);\r\n}\r\n\r\n// Ottieni suggerimenti basati su query\r\nexport function getSuggestions(query) {\r\n  if (!query || query.trim().length < 2) {\r\n    // Suggerimenti di default\r\n    return [\r\n      'Come funziona l\\'upscaling?',\r\n      'Quali formati sono supportati?',\r\n      'Come creo un account?',\r\n      'I miei file sono sicuri?',\r\n      'Quanto costa?'\r\n    ];\r\n  }\r\n\r\n  const results = searchKnowledgeBase(query);\r\n  return results.map(faq => faq.question);\r\n}\r\n\r\n// Ottieni FAQ correlata\r\nexport function getRelatedFAQs(faqId, limit = 3) {\r\n  const faq = faqDatabase.find(f => f.id === faqId);\r\n  if (!faq) return [];\r\n\r\n  // Cerca FAQ con stessa categoria o strumenti correlati\r\n  return faqDatabase\r\n    .filter(f => \r\n      f.id !== faqId && \r\n      (f.category === faq.category || \r\n       f.relatedTools.some(tool => faq.relatedTools.includes(tool)))\r\n    )\r\n    .slice(0, limit);\r\n}\r\n\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3216, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jurit/OneDrive/Desktop/sito%20upscale/components/ChatSupport.js"],"sourcesContent":["import { useState, useEffect, useRef } from 'react';\r\nimport { \r\n  HiChat, HiX, HiSearch, HiLightBulb, HiQuestionMarkCircle,\r\n  HiChevronDown, HiChevronUp, HiPaperAirplane, HiSparkles\r\n} from 'react-icons/hi';\r\nimport { searchKnowledgeBase, getSuggestions, getRelatedFAQs } from '../lib/supportKnowledgeBase';\r\n\r\nexport default function ChatSupport() {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [messages, setMessages] = useState([]);\r\n  const [inputValue, setInputValue] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [showSuggestions, setShowSuggestions] = useState(true);\r\n  const [expandedFAQ, setExpandedFAQ] = useState(null);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [searchResults, setSearchResults] = useState([]);\r\n  const [activeTab, setActiveTab] = useState('chat'); // 'chat' | 'faq'\r\n  const messagesEndRef = useRef(null);\r\n  const inputRef = useRef(null);\r\n  const [isMobile, setIsMobile] = useState(false);\r\n\r\n  // Safe client-side mobile detection\r\n  useEffect(() => {\r\n    const checkMobile = () => setIsMobile(window.innerWidth <= 768);\r\n    checkMobile();\r\n    window.addEventListener('resize', checkMobile);\r\n    return () => window.removeEventListener('resize', checkMobile);\r\n  }, []);\r\n\r\n  // Messaggio iniziale\r\n  useEffect(() => {\r\n    if (isOpen && messages.length === 0) {\r\n      const welcomeMessage = {\r\n        id: 'welcome',\r\n        role: 'assistant',\r\n        content: 'Ciao! 👋 Sono il tuo assistente virtuale. Posso aiutarti con:\\n\\n• Domande su strumenti e funzionalità\\n• Problemi tecnici\\n• Informazioni su account e fatturazione\\n• Suggerimenti e best practices\\n\\nCome posso aiutarti oggi?',\r\n        timestamp: new Date().toISOString(),\r\n        type: 'text'\r\n      };\r\n      setMessages([welcomeMessage]);\r\n    }\r\n  }, [isOpen]);\r\n\r\n  // Scroll automatico\r\n  useEffect(() => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  }, [messages]);\r\n\r\n  // Suggerimenti iniziali\r\n  const initialSuggestions = getSuggestions('');\r\n\r\n  // Cerca nella base di conoscenza\r\n  const handleSearch = (query) => {\r\n    setSearchQuery(query);\r\n    if (query.trim().length >= 2) {\r\n      const results = searchKnowledgeBase(query);\r\n      setSearchResults(results);\r\n    } else {\r\n      setSearchResults([]);\r\n    }\r\n  };\r\n\r\n  // Invia messaggio\r\n  const handleSendMessage = async () => {\r\n    if (!inputValue.trim() || isLoading) return;\r\n\r\n    const userMessage = {\r\n      id: `msg-${Date.now()}`,\r\n      role: 'user',\r\n      content: inputValue.trim(),\r\n      timestamp: new Date().toISOString(),\r\n      type: 'text'\r\n    };\r\n\r\n    setMessages(prev => [...prev, userMessage]);\r\n    setInputValue('');\r\n    setShowSuggestions(false);\r\n    setIsLoading(true);\r\n\r\n    try {\r\n      // Cerca nella base di conoscenza\r\n      const kbResults = searchKnowledgeBase(inputValue.trim());\r\n      \r\n      // Chiama API supporto AI\r\n      const { getApiUrl } = await import('../utils/getApiUrl');\r\n      const response = await fetch(getApiUrl('/api/support/chat'), {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          message: inputValue.trim(),\r\n          context: kbResults.slice(0, 3).map(r => ({\r\n            question: r.question,\r\n            answer: r.answer\r\n          })),\r\n          conversationHistory: messages.slice(-5).map(m => ({\r\n            role: m.role,\r\n            content: m.content\r\n          }))\r\n        })\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Errore nella risposta del supporto');\r\n      }\r\n\r\n      const text = await response.text();\r\n      const data = text && text.trim() ? JSON.parse(text) : {};\r\n      \r\n      const assistantMessage = {\r\n        id: `msg-${Date.now()}-ai`,\r\n        role: 'assistant',\r\n        content: data.response,\r\n        timestamp: new Date().toISOString(),\r\n        type: 'text',\r\n        relatedFAQs: data.relatedFAQs || [],\r\n        suggestions: data.suggestions || []\r\n      };\r\n\r\n      setMessages(prev => [...prev, assistantMessage]);\r\n      \r\n      // Se ci sono FAQ correlate, mostra suggerimenti\r\n      if (data.relatedFAQs && data.relatedFAQs.length > 0) {\r\n        setShowSuggestions(true);\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error('Support chat error:', error);\r\n      \r\n      // Fallback: usa risultati base di conoscenza\r\n      const kbResults = searchKnowledgeBase(inputValue.trim());\r\n      \r\n      let fallbackResponse = 'Mi dispiace, non sono riuscito a trovare una risposta precisa. ';\r\n      \r\n      if (kbResults.length > 0) {\r\n        fallbackResponse += `Ecco alcune informazioni che potrebbero aiutarti:\\n\\n**${kbResults[0].question}**\\n${kbResults[0].answer}`;\r\n      } else {\r\n        fallbackResponse += 'Potresti riformulare la domanda o contattare il supporto diretto?';\r\n      }\r\n\r\n      const assistantMessage = {\r\n        id: `msg-${Date.now()}-fallback`,\r\n        role: 'assistant',\r\n        content: fallbackResponse,\r\n        timestamp: new Date().toISOString(),\r\n        type: 'text',\r\n        relatedFAQs: kbResults.slice(0, 3)\r\n      };\r\n\r\n      setMessages(prev => [...prev, assistantMessage]);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Click su suggerimento\r\n  const handleSuggestionClick = (suggestion) => {\r\n    setInputValue(suggestion);\r\n    inputRef.current?.focus();\r\n  };\r\n\r\n  // Click su FAQ\r\n  const handleFAQClick = (faq) => {\r\n    const message = {\r\n      id: `faq-${Date.now()}`,\r\n      role: 'assistant',\r\n      content: `**${faq.question}**\\n\\n${faq.answer}`,\r\n      timestamp: new Date().toISOString(),\r\n      type: 'faq',\r\n      faqId: faq.id\r\n    };\r\n    setMessages(prev => [...prev, message]);\r\n    setExpandedFAQ(faq.id);\r\n    \r\n    // Mostra FAQ correlate\r\n    const related = getRelatedFAQs(faq.id);\r\n    if (related.length > 0) {\r\n      setTimeout(() => {\r\n        const relatedMessage = {\r\n          id: `related-${Date.now()}`,\r\n          role: 'assistant',\r\n          content: `**FAQ correlate:**\\n\\n${related.map(f => `• ${f.question}`).join('\\n')}`,\r\n          timestamp: new Date().toISOString(),\r\n          type: 'suggestions'\r\n        };\r\n        setMessages(prev => [...prev, relatedMessage]);\r\n      }, 500);\r\n    }\r\n  };\r\n\r\n  // Tasto Enter\r\n  const handleKeyPress = (e) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      handleSendMessage();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {/* Floating Button */}\r\n      <button\r\n        onClick={() => setIsOpen(true)}\r\n        style={styles.floatingButton}\r\n        aria-label=\"Supporto Chat\"\r\n        title=\"Supporto Chat\"\r\n      >\r\n        <HiChat style={{ width: 24, height: 24 }} />\r\n      </button>\r\n\r\n      {/* Chat Panel */}\r\n      {isOpen && (\r\n        <div style={styles.overlay} onClick={() => setIsOpen(false)}>\r\n          <div style={styles.panel} onClick={(e) => e.stopPropagation()}>\r\n            {/* Header */}\r\n            <div style={styles.header}>\r\n              <div style={styles.headerLeft}>\r\n                <div style={styles.headerIcon}>\r\n                  <HiSparkles style={{ width: 20, height: 20 }} />\r\n                </div>\r\n                <div>\r\n                  <h3 style={styles.headerTitle}>Supporto AI</h3>\r\n                  <p style={styles.headerSubtitle}>Assistente virtuale intelligente</p>\r\n                </div>\r\n              </div>\r\n              <button\r\n                onClick={() => setIsOpen(false)}\r\n                style={styles.closeButton}\r\n                aria-label=\"Chiudi\"\r\n              >\r\n                <HiX style={{ width: 20, height: 20 }} />\r\n              </button>\r\n            </div>\r\n\r\n            {/* Tabs */}\r\n            <div style={styles.tabs}>\r\n              <button\r\n                onClick={() => setActiveTab('chat')}\r\n                style={{\r\n                  ...styles.tab,\r\n                  ...(activeTab === 'chat' ? styles.tabActive : {})\r\n                }}\r\n              >\r\n                Chat\r\n              </button>\r\n              <button\r\n                onClick={() => setActiveTab('faq')}\r\n                style={{\r\n                  ...styles.tab,\r\n                  ...(activeTab === 'faq' ? styles.tabActive : {})\r\n                }}\r\n              >\r\n                FAQ\r\n              </button>\r\n            </div>\r\n\r\n            {/* Content */}\r\n            <div style={styles.content}>\r\n              {activeTab === 'chat' ? (\r\n                <>\r\n                  {/* Messages */}\r\n                  <div style={styles.messagesContainer}>\r\n                    {messages.map((message) => (\r\n                      <div\r\n                        key={message.id}\r\n                        style={{\r\n                          ...styles.message,\r\n                          ...(message.role === 'user' ? styles.userMessage : styles.assistantMessage)\r\n                        }}\r\n                      >\r\n                        <div style={styles.messageContent}>\r\n                          {message.type === 'text' && (\r\n                            <div style={styles.textContent}>\r\n                              {message.content.split('\\n').map((line, i) => {\r\n                                // Formattazione markdown semplice\r\n                                if (line.startsWith('**') && line.endsWith('**')) {\r\n                                  return (\r\n                                    <strong key={i} style={styles.boldText}>\r\n                                      {line.replace(/\\*\\*/g, '')}\r\n                                    </strong>\r\n                                  );\r\n                                }\r\n                                if (line.trim() === '') {\r\n                                  return <br key={i} />;\r\n                                }\r\n                                return <p key={i} style={styles.paragraph}>{line}</p>;\r\n                              })}\r\n                            </div>\r\n                          )}\r\n\r\n                          {/* FAQ Correlate */}\r\n                          {message.relatedFAQs && message.relatedFAQs.length > 0 && (\r\n                            <div style={styles.relatedFAQs}>\r\n                              <div style={styles.relatedTitle}>Potrebbe interessarti:</div>\r\n                              {message.relatedFAQs.map((faq) => (\r\n                                <button\r\n                                  key={faq.id}\r\n                                  onClick={() => handleFAQClick(faq)}\r\n                                  style={styles.faqButton}\r\n                                >\r\n                                  <HiQuestionMarkCircle style={{ width: 16, height: 16 }} />\r\n                                  {faq.question}\r\n                                </button>\r\n                              ))}\r\n                            </div>\r\n                          )}\r\n\r\n                          {/* Timestamp */}\r\n                          <div style={styles.timestamp}>\r\n                            {new Date(message.timestamp).toLocaleTimeString('it-IT', {\r\n                              hour: '2-digit',\r\n                              minute: '2-digit'\r\n                            })}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n\r\n                    {isLoading && (\r\n                      <div style={styles.loadingMessage}>\r\n                        <div style={styles.typingIndicator}>\r\n                          <span></span>\r\n                          <span></span>\r\n                          <span></span>\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n\r\n                    <div ref={messagesEndRef} />\r\n                  </div>\r\n\r\n                  {/* Suggestions */}\r\n                  {showSuggestions && messages.length <= 1 && (\r\n                    <div style={styles.suggestionsContainer}>\r\n                      <div style={styles.suggestionsTitle}>\r\n                        <HiLightBulb style={{ width: 16, height: 16 }} />\r\n                        Suggerimenti\r\n                      </div>\r\n                      <div style={styles.suggestionsGrid}>\r\n                        {initialSuggestions.slice(0, 4).map((suggestion, i) => (\r\n                          <button\r\n                            key={i}\r\n                            onClick={() => handleSuggestionClick(suggestion)}\r\n                            style={styles.suggestionButton}\r\n                          >\r\n                            {suggestion}\r\n                          </button>\r\n                        ))}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Input */}\r\n                  <div style={styles.inputContainer}>\r\n                    <div style={styles.inputWrapper}>\r\n                      <input\r\n                        ref={inputRef}\r\n                        type=\"text\"\r\n                        value={inputValue}\r\n                        onChange={(e) => setInputValue(e.target.value)}\r\n                        onKeyPress={handleKeyPress}\r\n                        placeholder=\"Scrivi la tua domanda...\"\r\n                        style={styles.input}\r\n                        disabled={isLoading}\r\n                      />\r\n                      <button\r\n                        onClick={handleSendMessage}\r\n                        disabled={!inputValue.trim() || isLoading}\r\n                        style={{\r\n                          ...styles.sendButton,\r\n                          ...((!inputValue.trim() || isLoading) && styles.sendButtonDisabled)\r\n                        }}\r\n                      >\r\n                        <HiPaperAirplane style={{ width: 18, height: 18 }} />\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </>\r\n              ) : (\r\n                <div style={styles.faqContainer}>\r\n                  {/* Search */}\r\n                  <div style={styles.searchContainer}>\r\n                    <HiSearch style={{ width: 20, height: 20, color: '#94a3b8' }} />\r\n                    <input\r\n                      type=\"text\"\r\n                      value={searchQuery}\r\n                      onChange={(e) => handleSearch(e.target.value)}\r\n                      placeholder=\"Cerca nelle FAQ...\"\r\n                      style={styles.searchInput}\r\n                    />\r\n                  </div>\r\n\r\n                  {/* Results */}\r\n                  <div style={styles.faqResults}>\r\n                    {searchResults.length > 0 ? (\r\n                      searchResults.map((faq) => (\r\n                        <div key={faq.id} style={styles.faqItem}>\r\n                          <button\r\n                            onClick={() => {\r\n                              setExpandedFAQ(expandedFAQ === faq.id ? null : faq.id);\r\n                              handleFAQClick(faq);\r\n                            }}\r\n                            style={styles.faqQuestion}\r\n                          >\r\n                            <span>{faq.question}</span>\r\n                            {expandedFAQ === faq.id ? (\r\n                              <HiChevronUp style={{ width: 20, height: 20 }} />\r\n                            ) : (\r\n                              <HiChevronDown style={{ width: 20, height: 20 }} />\r\n                            )}\r\n                          </button>\r\n                          {expandedFAQ === faq.id && (\r\n                            <div style={styles.faqAnswer}>\r\n                              {faq.answer.split('\\n').map((line, i) => {\r\n                                if (line.startsWith('**') && line.endsWith('**')) {\r\n                                  return (\r\n                                    <strong key={i} style={styles.boldText}>\r\n                                      {line.replace(/\\*\\*/g, '')}\r\n                                    </strong>\r\n                                  );\r\n                                }\r\n                                return <p key={i} style={styles.paragraph}>{line}</p>;\r\n                              })}\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                      ))\r\n                    ) : (\r\n                      <div style={styles.emptyState}>\r\n                        <HiQuestionMarkCircle style={{ width: 48, height: 48, color: '#94a3b8', marginBottom: '16px' }} />\r\n                        <p style={styles.emptyText}>\r\n                          {searchQuery ? 'Nessun risultato trovato' : 'Cerca nelle FAQ o passa alla chat'}\r\n                        </p>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n\r\nconst styles = {\r\n  floatingButton: {\r\n    position: 'fixed',\r\n    bottom: '24px',\r\n    right: '24px',\r\n    width: '56px',\r\n    height: '56px',\r\n    borderRadius: '50%',\r\n    background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\r\n    border: 'none',\r\n    color: '#ffffff',\r\n    cursor: 'pointer',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    boxShadow: '0 8px 24px rgba(102, 126, 234, 0.4)',\r\n    zIndex: 9998,\r\n    transition: 'all 0.3s',\r\n    WebkitTapHighlightColor: 'transparent'\r\n  },\r\n  overlay: {\r\n    position: 'fixed',\r\n    top: 0,\r\n    left: 0,\r\n    right: 0,\r\n    bottom: 0,\r\n    background: 'rgba(0, 0, 0, 0.7)',\r\n    backdropFilter: 'blur(8px)',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    zIndex: 9999,\r\n    padding: '20px'\r\n  },\r\n  panel: {\r\n    background: 'rgba(15, 23, 42, 0.98)',\r\n    border: '1px solid rgba(102, 126, 234, 0.3)',\r\n    borderRadius: '16px',\r\n    maxWidth: '600px',\r\n    width: '100%',\r\n    maxHeight: '80vh',\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    boxShadow: '0 20px 60px rgba(0, 0, 0, 0.5)'\r\n  },\r\n  header: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'space-between',\r\n    padding: '20px 24px',\r\n    borderBottom: '1px solid rgba(102, 126, 234, 0.2)'\r\n  },\r\n  headerLeft: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    gap: '12px'\r\n  },\r\n  headerIcon: {\r\n    width: '40px',\r\n    height: '40px',\r\n    borderRadius: '10px',\r\n    background: 'linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(118, 75, 162, 0.2) 100%)',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    color: '#a78bfa'\r\n  },\r\n  headerTitle: {\r\n    margin: 0,\r\n    fontSize: '18px',\r\n    fontWeight: '700',\r\n    color: '#e2e8f0'\r\n  },\r\n  headerSubtitle: {\r\n    margin: 0,\r\n    fontSize: '12px',\r\n    color: '#94a3b8'\r\n  },\r\n  closeButton: {\r\n    background: 'rgba(102, 126, 234, 0.1)',\r\n    border: 'none',\r\n    borderRadius: '8px',\r\n    padding: '8px',\r\n    cursor: 'pointer',\r\n    color: '#cbd5e1',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    transition: 'background 0.2s'\r\n  },\r\n  tabs: {\r\n    display: 'flex',\r\n    borderBottom: '1px solid rgba(102, 126, 234, 0.2)'\r\n  },\r\n  tab: {\r\n    flex: 1,\r\n    padding: '12px 20px',\r\n    background: 'transparent',\r\n    border: 'none',\r\n    borderBottom: '2px solid transparent',\r\n    color: '#94a3b8',\r\n    fontSize: '14px',\r\n    fontWeight: '600',\r\n    cursor: 'pointer',\r\n    transition: 'all 0.2s'\r\n  },\r\n  tabActive: {\r\n    color: '#667eea',\r\n    borderBottomColor: '#667eea'\r\n  },\r\n  content: {\r\n    flex: 1,\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    overflow: 'hidden'\r\n  },\r\n  messagesContainer: {\r\n    flex: 1,\r\n    overflowY: 'auto',\r\n    padding: '20px',\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    gap: '16px'\r\n  },\r\n  message: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    maxWidth: '85%',\r\n    animation: 'fadeIn 0.3s ease-in'\r\n  },\r\n  userMessage: {\r\n    alignSelf: 'flex-end',\r\n    alignItems: 'flex-end'\r\n  },\r\n  assistantMessage: {\r\n    alignSelf: 'flex-start',\r\n    alignItems: 'flex-start'\r\n  },\r\n  messageContent: {\r\n    padding: '12px 16px',\r\n    borderRadius: '12px',\r\n    background: 'rgba(102, 126, 234, 0.1)',\r\n    border: '1px solid rgba(102, 126, 234, 0.2)'\r\n  },\r\n  textContent: {\r\n    fontSize: '14px',\r\n    lineHeight: '1.6',\r\n    color: '#e2e8f0'\r\n  },\r\n  paragraph: {\r\n    margin: '4px 0',\r\n    color: '#e2e8f0'\r\n  },\r\n  boldText: {\r\n    fontWeight: '700',\r\n    color: '#a78bfa',\r\n    display: 'block',\r\n    margin: '8px 0'\r\n  },\r\n  relatedFAQs: {\r\n    marginTop: '12px',\r\n    paddingTop: '12px',\r\n    borderTop: '1px solid rgba(102, 126, 234, 0.2)'\r\n  },\r\n  relatedTitle: {\r\n    fontSize: '12px',\r\n    fontWeight: '600',\r\n    color: '#94a3b8',\r\n    marginBottom: '8px'\r\n  },\r\n  faqButton: {\r\n    width: '100%',\r\n    padding: '8px 12px',\r\n    marginBottom: '6px',\r\n    background: 'rgba(102, 126, 234, 0.1)',\r\n    border: '1px solid rgba(102, 126, 234, 0.2)',\r\n    borderRadius: '8px',\r\n    color: '#a78bfa',\r\n    fontSize: '13px',\r\n    textAlign: 'left',\r\n    cursor: 'pointer',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    gap: '8px',\r\n    transition: 'all 0.2s'\r\n  },\r\n  timestamp: {\r\n    fontSize: '11px',\r\n    color: '#64748b',\r\n    marginTop: '8px'\r\n  },\r\n  loadingMessage: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    gap: '8px',\r\n    padding: '12px 16px',\r\n    background: 'rgba(102, 126, 234, 0.1)',\r\n    borderRadius: '12px',\r\n    border: '1px solid rgba(102, 126, 234, 0.2)',\r\n    maxWidth: '85px'\r\n  },\r\n  typingIndicator: {\r\n    display: 'flex',\r\n    gap: '4px'\r\n  },\r\n  suggestionsContainer: {\r\n    padding: '16px 20px',\r\n    borderTop: '1px solid rgba(102, 126, 234, 0.2)',\r\n    background: 'rgba(102, 126, 234, 0.05)'\r\n  },\r\n  suggestionsTitle: {\r\n    fontSize: '12px',\r\n    fontWeight: '600',\r\n    color: '#94a3b8',\r\n    marginBottom: '12px',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    gap: '6px'\r\n  },\r\n  suggestionsGrid: {\r\n    display: 'grid',\r\n    gridTemplateColumns: 'repeat(2, 1fr)',\r\n    gap: '8px'\r\n  },\r\n  suggestionButton: {\r\n    padding: '10px 14px',\r\n    background: 'rgba(102, 126, 234, 0.1)',\r\n    border: '1px solid rgba(102, 126, 234, 0.2)',\r\n    borderRadius: '8px',\r\n    color: '#a78bfa',\r\n    fontSize: '13px',\r\n    textAlign: 'left',\r\n    cursor: 'pointer',\r\n    transition: 'all 0.2s'\r\n  },\r\n  inputContainer: {\r\n    padding: '16px 20px',\r\n    borderTop: '1px solid rgba(102, 126, 234, 0.2)',\r\n    background: 'rgba(15, 23, 42, 0.8)'\r\n  },\r\n  inputWrapper: {\r\n    display: 'flex',\r\n    gap: '8px',\r\n    alignItems: 'center'\r\n  },\r\n  input: {\r\n    flex: 1,\r\n    padding: '12px 16px',\r\n    background: 'rgba(255, 255, 255, 0.05)',\r\n    border: '1px solid rgba(102, 126, 234, 0.3)',\r\n    borderRadius: '12px',\r\n    color: '#e2e8f0',\r\n    fontSize: '14px',\r\n    outline: 'none',\r\n    transition: 'all 0.2s'\r\n  },\r\n  sendButton: {\r\n    padding: '12px',\r\n    background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\r\n    border: 'none',\r\n    borderRadius: '12px',\r\n    color: '#ffffff',\r\n    cursor: 'pointer',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    transition: 'all 0.2s'\r\n  },\r\n  sendButtonDisabled: {\r\n    opacity: 0.5,\r\n    cursor: 'not-allowed'\r\n  },\r\n  faqContainer: {\r\n    flex: 1,\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    overflow: 'hidden'\r\n  },\r\n  searchContainer: {\r\n    padding: '16px 20px',\r\n    borderBottom: '1px solid rgba(102, 126, 234, 0.2)',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    gap: '12px',\r\n    background: 'rgba(102, 126, 234, 0.05)'\r\n  },\r\n  searchInput: {\r\n    flex: 1,\r\n    padding: '10px 12px',\r\n    background: 'rgba(255, 255, 255, 0.05)',\r\n    border: '1px solid rgba(102, 126, 234, 0.3)',\r\n    borderRadius: '8px',\r\n    color: '#e2e8f0',\r\n    fontSize: '14px',\r\n    outline: 'none'\r\n  },\r\n  faqResults: {\r\n    flex: 1,\r\n    overflowY: 'auto',\r\n    padding: '20px'\r\n  },\r\n  faqItem: {\r\n    marginBottom: '12px',\r\n    background: 'rgba(30, 41, 59, 0.5)',\r\n    border: '1px solid rgba(102, 126, 234, 0.2)',\r\n    borderRadius: '12px',\r\n    overflow: 'hidden'\r\n  },\r\n  faqQuestion: {\r\n    width: '100%',\r\n    padding: '16px',\r\n    background: 'transparent',\r\n    border: 'none',\r\n    color: '#e2e8f0',\r\n    fontSize: '14px',\r\n    fontWeight: '600',\r\n    textAlign: 'left',\r\n    cursor: 'pointer',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'space-between',\r\n    gap: '12px',\r\n    transition: 'background 0.2s'\r\n  },\r\n  faqAnswer: {\r\n    padding: '0 16px 16px',\r\n    fontSize: '13px',\r\n    lineHeight: '1.6',\r\n    color: '#cbd5e1'\r\n  },\r\n  emptyState: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    padding: '60px 20px',\r\n    textAlign: 'center'\r\n  },\r\n  emptyText: {\r\n    fontSize: '14px',\r\n    color: '#94a3b8',\r\n    margin: 0\r\n  }\r\n};\r\n\r\n// Aggiungi animazioni\r\nif (typeof document !== 'undefined') {\r\n  const styleId = 'chat-support-styles';\r\n  if (!document.getElementById(styleId)) {\r\n    const style = document.createElement('style');\r\n    style.id = styleId;\r\n    style.textContent = `\r\n      @keyframes fadeIn {\r\n        from {\r\n          opacity: 0;\r\n          transform: translateY(10px);\r\n        }\r\n        to {\r\n          opacity: 1;\r\n          transform: translateY(0);\r\n        }\r\n      }\r\n      \r\n      @keyframes typing {\r\n        0%, 60%, 100% {\r\n          transform: translateY(0);\r\n        }\r\n        30% {\r\n          transform: translateY(-10px);\r\n        }\r\n      }\r\n    `;\r\n    document.head.appendChild(style);\r\n  }\r\n}\r\n\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4356, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jurit/OneDrive/Desktop/sito%20upscale/lib/analytics.js"],"sourcesContent":["// ============================================\r\n// COMPREHENSIVE ANALYTICS SYSTEM\r\n// ============================================\r\n// Google Analytics 4, Google Tag Manager, Vercel Analytics\r\n// Web Vitals, Custom Events, Error Tracking\r\n\r\n// ============================================\r\n// CONFIGURATION\r\n// ============================================\r\nexport const GA_TRACKING_ID = process.env.NEXT_PUBLIC_GA_ID || 'G-XXXXXXXXXX';\r\nexport const GTM_ID = process.env.NEXT_PUBLIC_GTM_ID || 'GTM-XXXXXXX';\r\nexport const META_PIXEL_ID = process.env.NEXT_PUBLIC_META_PIXEL_ID || null;\r\nexport const BING_WEBMASTER_ID = process.env.NEXT_PUBLIC_BING_WEBMASTER_ID || null;\r\nexport const ENABLE_ANALYTICS = process.env.NODE_ENV === 'production';\r\n\r\n// ============================================\r\n// UTILITY FUNCTIONS\r\n// ============================================\r\nexport const isGAEnabled = () => {\r\n    return typeof window !== 'undefined' && \r\n           window.gtag && \r\n           GA_TRACKING_ID !== 'G-XXXXXXXXXX' &&\r\n           ENABLE_ANALYTICS;\r\n};\r\n\r\nexport const isGTMEnabled = () => {\r\n    return typeof window !== 'undefined' && \r\n           window.dataLayer && \r\n           GTM_ID !== 'GTM-XXXXXXX' &&\r\n           ENABLE_ANALYTICS;\r\n};\r\n\r\nexport const isMetaPixelEnabled = () => {\r\n    return typeof window !== 'undefined' && \r\n           META_PIXEL_ID && \r\n           META_PIXEL_ID !== '' &&\r\n           ENABLE_ANALYTICS;\r\n};\r\n\r\nexport const isBingWebmasterEnabled = () => {\r\n    return typeof window !== 'undefined' && \r\n           BING_WEBMASTER_ID && \r\n           BING_WEBMASTER_ID !== '' &&\r\n           ENABLE_ANALYTICS;\r\n};\r\n\r\n// Get user properties for enhanced tracking\r\nconst getUserProperties = () => {\r\n    if (typeof window === 'undefined') return {};\r\n    \r\n    return {\r\n        screen_resolution: `${window.screen?.width}x${window.screen?.height}`,\r\n        viewport_size: `${window.innerWidth}x${window.innerHeight}`,\r\n        user_agent: navigator.userAgent,\r\n        language: navigator.language || 'en',\r\n        timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,\r\n        referrer: document.referrer || 'direct',\r\n        page_url: window.location.href,\r\n        page_path: window.location.pathname,\r\n        page_title: document.title,\r\n    };\r\n};\r\n\r\n// ============================================\r\n// PAGEVIEW TRACKING\r\n// ============================================\r\nexport const pageview = (url) => {\r\n    if (!ENABLE_ANALYTICS) return;\r\n    \r\n    const fullUrl = url.startsWith('http') ? url : `${window.location.origin}${url}`;\r\n    \r\n    // Google Analytics 4\r\n    if (isGAEnabled()) {\r\n        window.gtag('config', GA_TRACKING_ID, {\r\n            page_path: url,\r\n            page_location: fullUrl,\r\n            page_title: document.title,\r\n            ...getUserProperties(),\r\n        });\r\n    }\r\n    \r\n    // Google Tag Manager\r\n    if (isGTMEnabled()) {\r\n        window.dataLayer = window.dataLayer || [];\r\n        window.dataLayer.push({\r\n            event: 'page_view',\r\n            page_path: url,\r\n            page_location: fullUrl,\r\n            page_title: document.title,\r\n            ...getUserProperties(),\r\n        });\r\n    }\r\n};\r\n\r\n// ============================================\r\n// EVENT TRACKING (Enhanced)\r\n// ============================================\r\nexport const event = ({ \r\n    action, \r\n    category, \r\n    label, \r\n    value,\r\n    items = [],\r\n    currency = 'EUR',\r\n    custom_parameters = {}\r\n}) => {\r\n    if (!ENABLE_ANALYTICS) return;\r\n    \r\n    const eventData = {\r\n        event_category: category,\r\n        event_label: label,\r\n        value: value,\r\n        currency: currency,\r\n        ...getUserProperties(),\r\n        ...custom_parameters,\r\n    };\r\n    \r\n    // Google Analytics 4\r\n    if (isGAEnabled()) {\r\n        window.gtag('event', action, {\r\n            ...eventData,\r\n            items: items.length > 0 ? items : undefined,\r\n        });\r\n    }\r\n    \r\n    // Google Tag Manager\r\n    if (isGTMEnabled()) {\r\n        window.dataLayer = window.dataLayer || [];\r\n        window.dataLayer.push({\r\n            event: action,\r\n            event_category: category,\r\n            event_label: label,\r\n            value: value,\r\n            currency: currency,\r\n            items: items.length > 0 ? items : undefined,\r\n            ...eventData,\r\n        });\r\n    }\r\n};\r\n\r\n// ============================================\r\n// TOOL USAGE TRACKING\r\n// ============================================\r\nexport const trackToolUsage = (toolName, action = 'use', metadata = {}) => {\r\n    event({\r\n        action: action,\r\n        category: 'Tool Usage',\r\n        label: toolName,\r\n        custom_parameters: {\r\n            tool_name: toolName,\r\n            tool_action: action,\r\n            ...metadata,\r\n        },\r\n    });\r\n};\r\n\r\nexport const trackToolStart = (toolName, fileType = null, fileSize = null) => {\r\n    trackToolUsage(toolName, 'tool_start', {\r\n        file_type: fileType,\r\n        file_size: fileSize,\r\n    });\r\n};\r\n\r\nexport const trackToolComplete = (toolName, duration = null, success = true) => {\r\n    trackToolUsage(toolName, success ? 'tool_complete' : 'tool_failed', {\r\n        duration_ms: duration,\r\n        success: success,\r\n    });\r\n};\r\n\r\n// ============================================\r\n// FILE & CONVERSION TRACKING\r\n// ============================================\r\nexport const trackFileUpload = (fileType, fileSize, toolName = null) => {\r\n    event({\r\n        action: 'file_upload',\r\n        category: 'File Operations',\r\n        label: `${toolName || 'general'} - ${fileType}`,\r\n        value: Math.round(fileSize / 1024), // Size in KB\r\n        custom_parameters: {\r\n            file_type: fileType,\r\n            file_size: fileSize,\r\n            file_size_kb: Math.round(fileSize / 1024),\r\n            file_size_mb: Math.round((fileSize / 1024 / 1024) * 100) / 100,\r\n            tool_name: toolName,\r\n        },\r\n    });\r\n};\r\n\r\nexport const trackConversion = (conversionType, fromFormat, toFormat, fileSize = 0, duration = null) => {\r\n    event({\r\n        action: 'conversion',\r\n        category: 'Conversion',\r\n        label: `${fromFormat} to ${toFormat}`,\r\n        value: Math.round(fileSize / 1024),\r\n        custom_parameters: {\r\n            conversion_type: conversionType,\r\n            from_format: fromFormat,\r\n            to_format: toFormat,\r\n            file_size: fileSize,\r\n            duration_ms: duration,\r\n        },\r\n    });\r\n    \r\n    // Track as conversion event for GA4\r\n    if (isGAEnabled()) {\r\n        window.gtag('event', 'conversion', {\r\n            conversion_type: conversionType,\r\n            from_format: fromFormat,\r\n            to_format: toFormat,\r\n            value: Math.round(fileSize / 1024),\r\n            currency: 'EUR',\r\n        });\r\n    }\r\n};\r\n\r\nexport const trackDownload = (fileType, toolName, fileSize = null) => {\r\n    event({\r\n        action: 'file_download',\r\n        category: 'Engagement',\r\n        label: `${toolName} - ${fileType}`,\r\n        value: fileSize ? Math.round(fileSize / 1024) : undefined,\r\n        custom_parameters: {\r\n            file_type: fileType,\r\n            tool_name: toolName,\r\n            file_size: fileSize,\r\n        },\r\n    });\r\n};\r\n\r\n// ============================================\r\n// USER ACTIONS TRACKING\r\n// ============================================\r\nexport const trackSignup = (method = 'email', plan = 'free') => {\r\n    event({\r\n        action: 'sign_up',\r\n        category: 'User',\r\n        label: method,\r\n        custom_parameters: {\r\n            signup_method: method,\r\n            plan: plan,\r\n        },\r\n    });\r\n    \r\n    // GA4 conversion event\r\n    if (isGAEnabled()) {\r\n        window.gtag('event', 'sign_up', {\r\n            method: method,\r\n            plan: plan,\r\n        });\r\n    }\r\n};\r\n\r\nexport const trackLogin = (method = 'email') => {\r\n    event({\r\n        action: 'login',\r\n        category: 'User',\r\n        label: method,\r\n        custom_parameters: {\r\n            login_method: method,\r\n        },\r\n    });\r\n};\r\n\r\nexport const trackLogout = () => {\r\n    event({\r\n        action: 'logout',\r\n        category: 'User',\r\n    });\r\n};\r\n\r\nexport const trackUpgrade = (plan = 'pro', price = 19) => {\r\n    event({\r\n        action: 'purchase',\r\n        category: 'Revenue',\r\n        label: plan,\r\n        value: price,\r\n        currency: 'EUR',\r\n        custom_parameters: {\r\n            plan: plan,\r\n            price: price,\r\n        },\r\n    });\r\n    \r\n    // GA4 ecommerce event\r\n    if (isGAEnabled()) {\r\n        window.gtag('event', 'purchase', {\r\n            transaction_id: `upgrade_${Date.now()}`,\r\n            value: price,\r\n            currency: 'EUR',\r\n            items: [{\r\n                item_id: plan,\r\n                item_name: `${plan} Plan`,\r\n                price: price,\r\n                quantity: 1,\r\n            }],\r\n        });\r\n    }\r\n};\r\n\r\n// ============================================\r\n// ENGAGEMENT TRACKING\r\n// ============================================\r\nexport const trackButtonClick = (buttonName, location) => {\r\n    event({\r\n        action: 'button_click',\r\n        category: 'Engagement',\r\n        label: buttonName,\r\n        custom_parameters: {\r\n            button_name: buttonName,\r\n            location: location,\r\n        },\r\n    });\r\n};\r\n\r\nexport const trackSearch = (searchTerm, resultsCount = null) => {\r\n    event({\r\n        action: 'search',\r\n        category: 'Engagement',\r\n        label: searchTerm,\r\n        value: resultsCount,\r\n        custom_parameters: {\r\n            search_term: searchTerm,\r\n            results_count: resultsCount,\r\n        },\r\n    });\r\n};\r\n\r\nexport const trackVideoPlay = (videoName, duration = null) => {\r\n    event({\r\n        action: 'video_play',\r\n        category: 'Engagement',\r\n        label: videoName,\r\n        value: duration,\r\n        custom_parameters: {\r\n            video_name: videoName,\r\n            video_duration: duration,\r\n        },\r\n    });\r\n};\r\n\r\nexport const trackTimeOnPage = (pageName, timeSpent) => {\r\n    event({\r\n        action: 'time_on_page',\r\n        category: 'Engagement',\r\n        label: pageName,\r\n        value: Math.round(timeSpent),\r\n        custom_parameters: {\r\n            page_name: pageName,\r\n            time_spent_seconds: Math.round(timeSpent),\r\n        },\r\n    });\r\n};\r\n\r\n// ============================================\r\n// ERROR TRACKING\r\n// ============================================\r\nexport const trackError = (errorMessage, errorLocation, errorType = 'general', errorCode = null) => {\r\n    event({\r\n        action: 'error',\r\n        category: 'Error',\r\n        label: `${errorLocation}: ${errorMessage}`,\r\n        custom_parameters: {\r\n            error_message: errorMessage,\r\n            error_location: errorLocation,\r\n            error_type: errorType,\r\n            error_code: errorCode,\r\n        },\r\n    });\r\n    \r\n    // Send to GA4 as exception\r\n    if (isGAEnabled()) {\r\n        window.gtag('event', 'exception', {\r\n            description: errorMessage,\r\n            fatal: errorType === 'fatal',\r\n            error_location: errorLocation,\r\n        });\r\n    }\r\n};\r\n\r\nexport const trackAPIError = (endpoint, statusCode, errorMessage) => {\r\n    trackError(\r\n        errorMessage || `API Error: ${statusCode}`,\r\n        endpoint,\r\n        'api_error',\r\n        statusCode\r\n    );\r\n};\r\n\r\n// ============================================\r\n// PERFORMANCE TRACKING\r\n// ============================================\r\nexport const trackPerformance = (metric, value, unit = 'ms') => {\r\n    event({\r\n        action: 'performance',\r\n        category: 'Performance',\r\n        label: metric,\r\n        value: Math.round(value),\r\n        custom_parameters: {\r\n            metric_name: metric,\r\n            metric_value: value,\r\n            metric_unit: unit,\r\n        },\r\n    });\r\n};\r\n\r\n// Web Vitals tracking\r\nexport const trackWebVital = (metric) => {\r\n    const { name, value, id, delta } = metric;\r\n    \r\n    if (isGAEnabled()) {\r\n        window.gtag('event', name, {\r\n            event_category: 'Web Vitals',\r\n            value: Math.round(name === 'CLS' ? delta * 1000 : delta),\r\n            event_label: id,\r\n            non_interaction: true,\r\n        });\r\n    }\r\n    \r\n    trackPerformance(name, value, name === 'CLS' ? 'score' : 'ms');\r\n};\r\n\r\n// ============================================\r\n// ECOMMERCE TRACKING\r\n// ============================================\r\nexport const trackAddToCart = (itemId, itemName, price, quantity = 1) => {\r\n    event({\r\n        action: 'add_to_cart',\r\n        category: 'Ecommerce',\r\n        label: itemName,\r\n        value: price * quantity,\r\n        currency: 'EUR',\r\n        items: [{\r\n            item_id: itemId,\r\n            item_name: itemName,\r\n            price: price,\r\n            quantity: quantity,\r\n        }],\r\n    });\r\n    \r\n    if (isGAEnabled()) {\r\n        window.gtag('event', 'add_to_cart', {\r\n            currency: 'EUR',\r\n            value: price * quantity,\r\n            items: [{\r\n                item_id: itemId,\r\n                item_name: itemName,\r\n                price: price,\r\n                quantity: quantity,\r\n            }],\r\n        });\r\n    }\r\n};\r\n\r\nexport const trackBeginCheckout = (value, items = []) => {\r\n    event({\r\n        action: 'begin_checkout',\r\n        category: 'Ecommerce',\r\n        value: value,\r\n        currency: 'EUR',\r\n        items: items,\r\n    });\r\n    \r\n    if (isGAEnabled()) {\r\n        window.gtag('event', 'begin_checkout', {\r\n            currency: 'EUR',\r\n            value: value,\r\n            items: items,\r\n        });\r\n    }\r\n};\r\n\r\n// ============================================\r\n// SESSION TRACKING\r\n// ============================================\r\nexport const trackSessionStart = () => {\r\n    const sessionId = `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n    \r\n    if (typeof window !== 'undefined') {\r\n        sessionStorage.setItem('analytics_session_id', sessionId);\r\n    }\r\n    \r\n    event({\r\n        action: 'session_start',\r\n        category: 'Session',\r\n        custom_parameters: {\r\n            session_id: sessionId,\r\n        },\r\n    });\r\n};\r\n\r\nexport const trackSessionEnd = (duration = null) => {\r\n    const sessionId = sessionStorage?.getItem('analytics_session_id');\r\n    \r\n    event({\r\n        action: 'session_end',\r\n        category: 'Session',\r\n        value: duration ? Math.round(duration) : undefined,\r\n        custom_parameters: {\r\n            session_id: sessionId,\r\n            session_duration: duration,\r\n        },\r\n    });\r\n};\r\n\r\n// ============================================\r\n// CUSTOM USER PROPERTIES\r\n// ============================================\r\nexport const setUserProperty = (propertyName, propertyValue) => {\r\n    if (isGAEnabled()) {\r\n        window.gtag('set', 'user_properties', {\r\n            [propertyName]: propertyValue,\r\n        });\r\n    }\r\n    \r\n    if (isGTMEnabled()) {\r\n        window.dataLayer = window.dataLayer || [];\r\n        window.dataLayer.push({\r\n            user_property: propertyName,\r\n            user_property_value: propertyValue,\r\n        });\r\n    }\r\n};\r\n\r\nexport const setUserId = (userId) => {\r\n    if (isGAEnabled()) {\r\n        window.gtag('set', { user_id: userId });\r\n    }\r\n    \r\n    setUserProperty('user_id', userId);\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4741, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jurit/OneDrive/Desktop/sito%20upscale/utils/history.js"],"sourcesContent":["// LocalStorage history manager\r\n\r\nconst HISTORY_KEY = 'megapixelai_history';\r\nconst MAX_HISTORY_ITEMS = 3; // Ridotto per evitare problemi di quota\r\nconst MAX_THUMBNAIL_SIZE = 50000; // Max 50KB per thumbnail (circa 200x200px)\r\nconst MAX_TOTAL_SIZE = 2 * 1024 * 1024; // Max 2MB totali per localStorage\r\n\r\n// Funzione per ridurre la dimensione di un'immagine base64\r\nconst compressThumbnail = (base64String, maxSize = MAX_THUMBNAIL_SIZE) => {\r\n    if (!base64String || typeof base64String !== 'string') return null;\r\n    \r\n    // Se è già piccolo, restituiscilo così com'è\r\n    const currentSize = new Blob([base64String]).size;\r\n    if (currentSize <= maxSize) return base64String;\r\n    \r\n    // Se è troppo grande, restituisci null (non salvare)\r\n    // In alternativa, potresti implementare una compressione più avanzata\r\n    return null;\r\n};\r\n\r\n// Controlla la dimensione totale della history\r\nconst checkStorageSize = () => {\r\n    try {\r\n        const history = getHistory();\r\n        const totalSize = new Blob([JSON.stringify(history)]).size;\r\n        return totalSize;\r\n    } catch (error) {\r\n        return 0;\r\n    }\r\n};\r\n\r\nexport const saveToHistory = (item) => {\r\n    try {\r\n        // Controlla se abbiamo spazio disponibile\r\n        const currentSize = checkStorageSize();\r\n        if (currentSize > MAX_TOTAL_SIZE) {\r\n            console.warn('History storage limit reached, clearing old items');\r\n            // Rimuovi gli elementi più vecchi fino a quando non c'è spazio\r\n            const history = getHistory();\r\n            while (checkStorageSize() > MAX_TOTAL_SIZE * 0.7 && history.length > 0) {\r\n                history.pop(); // Rimuovi l'elemento più vecchio\r\n                try {\r\n                    localStorage.setItem(HISTORY_KEY, JSON.stringify(history));\r\n                } catch (e) {\r\n                    // Se ancora non c'è spazio, svuota tutto\r\n                    clearHistory();\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        \r\n        const history = getHistory();\r\n        \r\n        // Comprimi il thumbnail se presente\r\n        const compressedThumbnail = item.thumbnail ? compressThumbnail(item.thumbnail) : null;\r\n        \r\n        // Non salvare il result se è troppo grande (solo URL o null)\r\n        let result = item.result;\r\n        if (result && typeof result === 'string' && result.startsWith('data:')) {\r\n            // Se è un data URL e troppo grande, non salvarlo\r\n            const resultSize = new Blob([result]).size;\r\n            if (resultSize > 500000) { // Se più di 500KB, non salvare\r\n                result = null;\r\n            }\r\n        }\r\n        \r\n        const newItem = {\r\n            id: Date.now(),\r\n            timestamp: new Date().toISOString(),\r\n            tool: item.tool,\r\n            filename: item.filename,\r\n            thumbnail: compressedThumbnail, // thumbnail compresso o null\r\n            params: item.params,\r\n            result: result // URL o null (non salvare immagini base64 grandi)\r\n        };\r\n\r\n        // Add to beginning and limit to MAX_HISTORY_ITEMS\r\n        const updatedHistory = [newItem, ...history].slice(0, MAX_HISTORY_ITEMS);\r\n        \r\n        // Prova a salvare, se fallisce per quota, rimuovi elementi più vecchi\r\n        try {\r\n            localStorage.setItem(HISTORY_KEY, JSON.stringify(updatedHistory));\r\n        } catch (quotaError) {\r\n            console.warn('Quota exceeded, trying to free space');\r\n            // Rimuovi metà degli elementi più vecchi\r\n            const reducedHistory = updatedHistory.slice(0, Math.floor(MAX_HISTORY_ITEMS / 2));\r\n            try {\r\n                localStorage.setItem(HISTORY_KEY, JSON.stringify(reducedHistory));\r\n            } catch (e) {\r\n                // Se ancora non funziona, svuota tutto\r\n                clearHistory();\r\n                console.error('Could not save to history, storage full');\r\n                return null;\r\n            }\r\n        }\r\n        \r\n        return newItem.id;\r\n    } catch (error) {\r\n        console.error('Error saving to history:', error);\r\n        // Se è un errore di quota, prova a pulire\r\n        if (error.name === 'QuotaExceededError') {\r\n            clearHistory();\r\n            console.warn('History cleared due to quota exceeded');\r\n        }\r\n        return null;\r\n    }\r\n};\r\n\r\nexport const getHistory = () => {\r\n    try {\r\n        const history = localStorage.getItem(HISTORY_KEY);\r\n        return history ? JSON.parse(history) : [];\r\n    } catch (error) {\r\n        console.error('Error reading history:', error);\r\n        return [];\r\n    }\r\n};\r\n\r\nexport const clearHistory = () => {\r\n    try {\r\n        localStorage.removeItem(HISTORY_KEY);\r\n        return true;\r\n    } catch (error) {\r\n        console.error('Error clearing history:', error);\r\n        return false;\r\n    }\r\n};\r\n\r\n// Pulisci automaticamente la history se è troppo grande (chiama all'avvio)\r\nexport const cleanupHistory = () => {\r\n    try {\r\n        const history = getHistory();\r\n        const currentSize = checkStorageSize();\r\n        \r\n        if (currentSize > MAX_TOTAL_SIZE || history.length > MAX_HISTORY_ITEMS) {\r\n            // Mantieni solo gli elementi più recenti\r\n            const cleanedHistory = history\r\n                .slice(0, MAX_HISTORY_ITEMS)\r\n                .map(item => ({\r\n                    ...item,\r\n                    // Rimuovi result se troppo grande\r\n                    result: item.result && typeof item.result === 'string' && item.result.startsWith('data:') && new Blob([item.result]).size > 500000 \r\n                        ? null \r\n                        : item.result,\r\n                    // Comprimi thumbnail se troppo grande\r\n                    thumbnail: item.thumbnail ? compressThumbnail(item.thumbnail) : null\r\n                }));\r\n            \r\n            localStorage.setItem(HISTORY_KEY, JSON.stringify(cleanedHistory));\r\n            console.log('History cleaned up');\r\n        }\r\n    } catch (error) {\r\n        console.error('Error cleaning up history:', error);\r\n        // Se c'è ancora un errore, svuota tutto\r\n        if (error.name === 'QuotaExceededError') {\r\n            clearHistory();\r\n        }\r\n    }\r\n};\r\n\r\nexport const removeHistoryItem = (id) => {\r\n    try {\r\n        const history = getHistory();\r\n        const updatedHistory = history.filter(item => item.id !== id);\r\n        localStorage.setItem(HISTORY_KEY, JSON.stringify(updatedHistory));\r\n        return true;\r\n    } catch (error) {\r\n        console.error('Error removing history item:', error);\r\n        return false;\r\n    }\r\n};\r\n\r\nexport const formatTimestamp = (timestamp) => {\r\n    const date = new Date(timestamp);\r\n    const now = new Date();\r\n    const diffMs = now - date;\r\n    const diffMins = Math.floor(diffMs / 60000);\r\n    const diffHours = Math.floor(diffMs / 3600000);\r\n    const diffDays = Math.floor(diffMs / 86400000);\r\n\r\n    if (diffMins < 1) return 'Ora';\r\n    if (diffMins < 60) return `${diffMins} min fa`;\r\n    if (diffHours < 24) return `${diffHours} ore fa`;\r\n    if (diffDays < 7) return `${diffDays} giorni fa`;\r\n    \r\n    return date.toLocaleDateString('it-IT', { day: 'numeric', month: 'short' });\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4935, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jurit/OneDrive/Desktop/sito%20upscale/pages/_app.js"],"sourcesContent":["import '../styles/styles.css';\r\nimport '../styles/animations.css';\r\nimport '../styles/dropdown.css';\r\nimport Head from 'next/head';\r\nimport { useRouter } from 'next/router';\r\nimport { useEffect, Component, useState } from 'react';\r\nimport Script from 'next/script';\r\nimport { SpeedInsights } from '@vercel/speed-insights/next';\r\nimport { Analytics } from '@vercel/analytics/react';\r\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query';\r\nimport { LanguageProvider } from '../lib/i18n';\r\nimport ToastContainer from '../components/Toast';\r\nimport { optimizeCoreWebVitals, setupLazyImages } from '../lib/performance';\r\nimport DownloadManager from '../components/DownloadManager';\r\nimport ChatSupport from '../components/ChatSupport';\r\n\r\nimport * as analytics from '../lib/analytics';\r\nimport { cleanupHistory } from '../utils/history';\r\n\r\n// Error Boundary Component\r\nclass ErrorBoundary extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = { hasError: false, error: null };\r\n  }\r\n\r\n  static getDerivedStateFromError(error) {\r\n    return { hasError: true, error };\r\n  }\r\n\r\n  componentDidCatch(error, errorInfo) {\r\n    console.error('Error caught by boundary:', error, errorInfo);\r\n    console.error('Error stack:', error.stack);\r\n    console.error('Component stack:', errorInfo.componentStack);\r\n    if (typeof window !== 'undefined' && analytics && analytics.trackError) {\r\n      try {\r\n        analytics.trackError(\r\n          error.message || 'Unknown error',\r\n          errorInfo.componentStack || 'unknown',\r\n          'error_boundary',\r\n          error.stack\r\n        );\r\n      } catch (e) {\r\n        console.error('Failed to track error:', e);\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    if (this.state.hasError) {\r\n      const error = this.state.error;\r\n      return (\r\n        <div style={{\r\n          display: 'flex',\r\n          flexDirection: 'column',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          minHeight: '100vh',\r\n          padding: '20px',\r\n          textAlign: 'center',\r\n          fontFamily: 'system-ui, -apple-system, sans-serif'\r\n        }}>\r\n          <h1 style={{ fontSize: '24px', marginBottom: '16px', color: '#333' }}>Something went wrong</h1>\r\n          <p style={{ marginBottom: '8px', color: '#666', fontSize: '14px' }}>\r\n            {error?.message || 'An unexpected error occurred'}\r\n          </p>\r\n          {error?.stack && (\r\n            <details style={{ marginTop: '16px', textAlign: 'left', maxWidth: '600px', fontSize: '12px', color: '#999' }}>\r\n              <summary style={{ cursor: 'pointer', marginBottom: '8px' }}>Error Details</summary>\r\n              <pre style={{ \r\n                background: '#f5f5f5', \r\n                padding: '12px', \r\n                borderRadius: '4px', \r\n                overflow: 'auto',\r\n                maxHeight: '200px'\r\n              }}>\r\n                {error.stack}\r\n              </pre>\r\n            </details>\r\n          )}\r\n          <button\r\n            onClick={() => {\r\n              if (typeof window !== 'undefined') {\r\n                window.location.reload();\r\n              }\r\n            }}\r\n            style={{\r\n              marginTop: '20px',\r\n              padding: '10px 20px',\r\n              backgroundColor: '#0070f3',\r\n              color: 'white',\r\n              border: 'none',\r\n              borderRadius: '5px',\r\n              cursor: 'pointer',\r\n              fontSize: '14px'\r\n            }}\r\n          >\r\n            Reload Page\r\n          </button>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return this.props.children;\r\n  }\r\n}\r\n\r\n// Create React Query client with optimized settings\r\nconst queryClient = new QueryClient({\r\n  defaultOptions: {\r\n    queries: {\r\n      staleTime: 5 * 60 * 1000, // 5 minutes\r\n      gcTime: 10 * 60 * 1000, // 10 minutes (renamed from cacheTime in v5)\r\n      refetchOnWindowFocus: false,\r\n      retry: 1,\r\n    },\r\n  },\r\n});\r\n\r\nfunction MyApp({ Component, pageProps }) {\r\n  // Suppress Stripe tracking prevention warnings (browser privacy feature, not errors)\r\n  useEffect(() => {\r\n    if (typeof window !== 'undefined') {\r\n      const originalError = console.error;\r\n      console.error = (...args) => {\r\n        // Filter out Stripe tracking prevention warnings\r\n        const message = args.join(' ');\r\n        if (message.includes('Tracking Prevention blocked') && message.includes('stripe')) {\r\n          return; // Suppress these warnings\r\n        }\r\n        originalError.apply(console, args);\r\n      };\r\n      \r\n      return () => {\r\n        console.error = originalError;\r\n      };\r\n    }\r\n  }, []);\r\n  const router = useRouter();\r\n  const [mounted, setMounted] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setMounted(true);\r\n    // Pulisci la history se è troppo grande\r\n    if (typeof window !== 'undefined') {\r\n      try {\r\n        cleanupHistory();\r\n      } catch (error) {\r\n        console.warn('Failed to cleanup history on mount:', error);\r\n      }\r\n    }\r\n  }, []);\r\n  \r\n  // Applica classe per abilitare animazioni solo lato client\r\n  useEffect(() => {\r\n    if (!mounted) return;\r\n    if (typeof window === 'undefined' || typeof document === 'undefined') return;\r\n    try {\r\n      document.documentElement.classList.add('animations-ready');\r\n      // Applica animazioni a tutti gli elementi con classi animate-*\r\n      const animatedElements = document.querySelectorAll('[class*=\"animate-\"]');\r\n      if (animatedElements && animatedElements.length > 0) {\r\n        animatedElements.forEach((el) => {\r\n          if (el && el.classList) {\r\n            el.classList.add('animate-ready');\r\n          }\r\n        });\r\n      }\r\n      \r\n      // Setup lazy loading and Core Web Vitals optimizations\r\n      try {\r\n        if (typeof optimizeCoreWebVitals === 'function') {\r\n          optimizeCoreWebVitals();\r\n        }\r\n        if (typeof setupLazyImages === 'function') {\r\n          setupLazyImages();\r\n        }\r\n        // Import and use additional performance utilities\r\n        import('../lib/performance').then(({ optimizeAnimations, measureWebVitals, optimizeMobilePerformance }) => {\r\n          if (typeof optimizeAnimations === 'function') {\r\n            optimizeAnimations();\r\n          }\r\n          if (typeof measureWebVitals === 'function') {\r\n            measureWebVitals();\r\n          }\r\n          if (typeof optimizeMobilePerformance === 'function') {\r\n            optimizeMobilePerformance();\r\n          }\r\n        }).catch(() => {\r\n          // Silently fail if performance utils can't be loaded\r\n        });\r\n      } catch (error) {\r\n        if (process.env.NODE_ENV === 'development') {\r\n          console.warn('Performance optimization setup failed:', error);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.warn('Animation setup failed:', error);\r\n    }\r\n  }, [mounted]);\r\n\r\n  useEffect(() => {\r\n    // Previeni scroll orizzontale (solo client-side)\r\n    if (typeof window !== 'undefined' && typeof document !== 'undefined') {\r\n      document.body.style.overflowX = 'hidden';\r\n      document.documentElement.style.overflowX = 'hidden';\r\n    }\r\n    \r\n    // Intelligent prefetching after page load for better performance\r\n    if (typeof window !== 'undefined') {\r\n      // Wait for page to be fully interactive\r\n      const prefetchCriticalRoutes = () => {\r\n        // Prefetch critical routes based on current page\r\n        const currentPath = router.asPath;\r\n        const criticalRoutes = [];\r\n        \r\n        // Always prefetch main navigation routes\r\n        criticalRoutes.push('/tools', '/upscaler', '/pdf');\r\n        \r\n        // Add route-specific prefetches\r\n        if (currentPath === '/') {\r\n          criticalRoutes.push('/home', '/tools/rimozione-sfondo-ai', '/tools/generazione-immagini-ai');\r\n        } else if (currentPath.startsWith('/tools')) {\r\n          criticalRoutes.push('/tools/rimozione-sfondo-ai', '/upscaler');\r\n        }\r\n        \r\n        // Prefetch routes with delay to avoid blocking\r\n        criticalRoutes.slice(0, 5).forEach((route, index) => {\r\n          setTimeout(() => {\r\n            router.prefetch(route).catch(() => {}); // Ignore errors\r\n          }, index * 200 + 1000); // Start after 1s, 200ms between each\r\n        });\r\n      };\r\n      \r\n      // Use requestIdleCallback if available, otherwise use setTimeout\r\n      if ('requestIdleCallback' in window) {\r\n        requestIdleCallback(prefetchCriticalRoutes, { timeout: 3000 });\r\n      } else {\r\n        setTimeout(prefetchCriticalRoutes, 2000);\r\n      }\r\n      \r\n      // Prefetch on link hover (user intent)\r\n      const prefetchOnHover = (e) => {\r\n        const link = e.target.closest('a[href]');\r\n        if (link && link.href.startsWith(window.location.origin)) {\r\n          const href = link.getAttribute('href');\r\n          if (href && !href.startsWith('#') && !href.startsWith('http')) {\r\n            router.prefetch(href).catch(() => {});\r\n          }\r\n        }\r\n      };\r\n      \r\n      // Add prefetch on hover for better UX\r\n      document.addEventListener('mouseover', prefetchOnHover, { passive: true });\r\n      \r\n      // Cleanup\r\n      return () => {\r\n        document.removeEventListener('mouseover', prefetchOnHover);\r\n      };\r\n    }\r\n\r\n    // Track pageviews con Google Analytics e GTM\r\n    const handleRouteChange = (url) => {\r\n      analytics.pageview(url);\r\n    };\r\n    router.events.on('routeChangeComplete', handleRouteChange);\r\n    \r\n    // Track initial pageview\r\n    if (router.asPath) {\r\n      analytics.pageview(router.asPath);\r\n    }\r\n    \r\n    return () => {\r\n      router.events.off('routeChangeComplete', handleRouteChange);\r\n    };\r\n  }, [router]);\r\n\r\n  // Register Service Worker for performance\r\n  useEffect(() => {\r\n    if (typeof window !== 'undefined' && 'serviceWorker' in navigator && process.env.NODE_ENV === 'production') {\r\n      // Use requestIdleCallback for non-critical registration\r\n      if ('requestIdleCallback' in window) {\r\n        requestIdleCallback(() => {\r\n          navigator.serviceWorker\r\n            .register('/sw.js')\r\n            .then((registration) => {\r\n              console.log('Service Worker registered:', registration.scope);\r\n            })\r\n            .catch((error) => {\r\n              // Silently fail - service worker is optional\r\n              if (process.env.NODE_ENV === 'development') {\r\n                console.log('Service Worker registration failed:', error);\r\n              }\r\n            });\r\n        });\r\n      } else {\r\n        // Fallback for browsers without requestIdleCallback\r\n        setTimeout(() => {\r\n          navigator.serviceWorker\r\n            .register('/sw.js')\r\n            .catch(() => {\r\n              // Silently fail\r\n            });\r\n        }, 2000);\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  // Web Vitals Tracking\r\n  useEffect(() => {\r\n    if (typeof window === 'undefined' || process.env.NODE_ENV !== 'production') return;\r\n\r\n    // Load web-vitals library dynamically (optional)\r\n    import('web-vitals').then(({ onCLS, onFID, onFCP, onLCP, onTTFB, onINP }) => {\r\n      onCLS(analytics.trackWebVital);\r\n      onFID(analytics.trackWebVital);\r\n      onFCP(analytics.trackWebVital);\r\n      onLCP(analytics.trackWebVital);\r\n      onTTFB(analytics.trackWebVital);\r\n      if (onINP) onINP(analytics.trackWebVital);\r\n    }).catch(() => {\r\n      // Web-vitals not available, skip silently\r\n    });\r\n\r\n    // Global error tracking\r\n    const handleError = (event) => {\r\n      analytics.trackError(\r\n        event.message || 'Unknown error',\r\n        event.filename || 'unknown',\r\n        'javascript_error',\r\n        event.lineno\r\n      );\r\n    };\r\n\r\n    const handleUnhandledRejection = (event) => {\r\n      analytics.trackError(\r\n        event.reason?.message || 'Unhandled promise rejection',\r\n        'promise_rejection',\r\n        'promise_error'\r\n      );\r\n    };\r\n\r\n    window.addEventListener('error', handleError);\r\n    window.addEventListener('unhandledrejection', handleUnhandledRejection);\r\n\r\n    return () => {\r\n      window.removeEventListener('error', handleError);\r\n      window.removeEventListener('unhandledrejection', handleUnhandledRejection);\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <ErrorBoundary>\r\n      <QueryClientProvider client={queryClient}>\r\n        <LanguageProvider initialTranslations={pageProps.translations || {}}>\r\n        <Head>\r\n          <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, viewport-fit=cover\" />\r\n          <meta name=\"mobile-web-app-capable\" content=\"yes\" />\r\n          <meta name=\"apple-mobile-web-app-capable\" content=\"yes\" />\r\n          <meta name=\"apple-mobile-web-app-status-bar-style\" content=\"black-translucent\" />\r\n          <meta name=\"apple-mobile-web-app-title\" content=\"MegaPixelAI ToolSuite\" />\r\n          <meta name=\"theme-color\" content=\"#0a0e1a\" />\r\n          <meta name=\"msapplication-TileColor\" content=\"#0a0e1a\" />\r\n          <meta name=\"msapplication-navbutton-color\" content=\"#0a0e1a\" />\r\n          <link rel=\"icon\" href=\"/favicon.svg\" type=\"image/svg+xml\" />\r\n          <link rel=\"alternate icon\" href=\"/logo.svg\" type=\"image/svg+xml\" />\r\n          <link rel=\"apple-touch-icon\" href=\"/logo-with-text.jpg\" />\r\n          \r\n          {/* Performance: Preconnect to external domains */}\r\n          <link rel=\"preconnect\" href=\"https://www.googletagmanager.com\" crossOrigin=\"anonymous\" />\r\n          <link rel=\"preconnect\" href=\"https://www.google-analytics.com\" crossOrigin=\"anonymous\" />\r\n          <link rel=\"preconnect\" href=\"https://connect.facebook.net\" crossOrigin=\"anonymous\" />\r\n          <link rel=\"preconnect\" href=\"https://www.clarity.ms\" crossOrigin=\"anonymous\" />\r\n          <link rel=\"preconnect\" href=\"https://fonts.googleapis.com\" crossOrigin=\"anonymous\" />\r\n          <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossOrigin=\"anonymous\" />\r\n          \r\n          {/* DNS Prefetch for faster resolution */}\r\n          <link rel=\"dns-prefetch\" href=\"https://www.googletagmanager.com\" />\r\n          <link rel=\"dns-prefetch\" href=\"https://www.google-analytics.com\" />\r\n          <link rel=\"dns-prefetch\" href=\"https://connect.facebook.net\" />\r\n          <link rel=\"dns-prefetch\" href=\"https://www.clarity.ms\" />\r\n          <link rel=\"dns-prefetch\" href=\"https://fonts.googleapis.com\" />\r\n          <link rel=\"dns-prefetch\" href=\"https://fonts.gstatic.com\" />\r\n          \r\n          {/* CSS files are already imported above, no need for link tags */}\r\n          \r\n          {/* DNS prefetch for external resources */}\r\n          <link rel=\"dns-prefetch\" href=\"https://fonts.googleapis.com\" />\r\n          <link rel=\"dns-prefetch\" href=\"https://fonts.gstatic.com\" />\r\n          \r\n          {/* Resource hints for critical routes (prefetch in production only) */}\r\n          {process.env.NODE_ENV === 'production' && (\r\n            <>\r\n              <link rel=\"prefetch\" href=\"/tools\" as=\"document\" />\r\n              <link rel=\"prefetch\" href=\"/upscaler\" as=\"document\" />\r\n              <link rel=\"prefetch\" href=\"/pdf\" as=\"document\" />\r\n            </>\r\n          )}\r\n          \r\n          <title>Tool Suite - Upscaler AI & PDF Converter</title>\r\n          <style>{`\r\n            html {\r\n              overflow-y: scroll;\r\n              overflow-x: hidden;\r\n              width: 100%;\r\n              max-width: 100%;\r\n            }\r\n            body {\r\n              overflow-x: hidden;\r\n              max-width: 100%;\r\n              width: 100%;\r\n              position: relative;\r\n              margin: 0;\r\n              padding: 0;\r\n              box-sizing: border-box;\r\n            }\r\n            * {\r\n              box-sizing: border-box;\r\n            }\r\n            /* Force scrollbar to always show to prevent layout shift */\r\n            :root {\r\n              overflow-y: scroll;\r\n              overflow-x: hidden;\r\n              scrollbar-gutter: stable;\r\n              width: 100%;\r\n              max-width: 100%;\r\n            }\r\n            /* Prevent horizontal scroll */\r\n            #__next {\r\n              overflow-x: hidden;\r\n              max-width: 100%;\r\n              width: 100%;\r\n            }\r\n            /* Ottimizzazioni performance */\r\n            * {\r\n              -webkit-font-smoothing: antialiased;\r\n              -moz-osx-font-smoothing: grayscale;\r\n              -webkit-tap-highlight-color: transparent;\r\n            }\r\n            /* GPU acceleration per animazioni */\r\n            [style*=\"transform\"], [style*=\"opacity\"] {\r\n              will-change: transform, opacity;\r\n            }\r\n            /* Smooth scrolling - disabilitato su mobile per performance */\r\n            @media (prefers-reduced-motion: no-preference) {\r\n              html {\r\n                scroll-behavior: smooth;\r\n              }\r\n            }\r\n            /* Ottimizzazione rendering */\r\n            img, video {\r\n              content-visibility: auto;\r\n            }\r\n            /* Mobile optimizations */\r\n            @media (max-width: 768px) {\r\n              * {\r\n                -webkit-tap-highlight-color: rgba(102, 126, 234, 0.2);\r\n                touch-action: manipulation;\r\n              }\r\n              button, a, [role=\"button\"] {\r\n                -webkit-tap-highlight-color: rgba(102, 126, 234, 0.3);\r\n                touch-action: manipulation;\r\n                -webkit-user-select: none;\r\n                user-select: none;\r\n              }\r\n              /* Prevent text selection on buttons */\r\n              input, textarea {\r\n                -webkit-user-select: text;\r\n                user-select: text;\r\n              }\r\n              /* iOS Safari specific fixes */\r\n              @supports (-webkit-touch-callout: none) {\r\n                body {\r\n                  -webkit-overflow-scrolling: touch;\r\n                }\r\n              }\r\n            }\r\n            /* Android Chrome optimizations */\r\n            @media (max-width: 768px) and (-webkit-min-device-pixel-ratio: 2) {\r\n              * {\r\n                -webkit-font-smoothing: antialiased;\r\n              }\r\n            }\r\n          `}</style>\r\n        </Head>\r\n\r\n      {/* Google Analytics 4 - Primary (G-34NK4NEB9B) */}\r\n      <Script\r\n        id=\"google-analytics\"\r\n        strategy=\"afterInteractive\"\r\n        src=\"https://www.googletagmanager.com/gtag/js?id=G-34NK4NEB9B\"\r\n      />\r\n      <Script\r\n        id=\"google-analytics-init\"\r\n        strategy=\"afterInteractive\"\r\n        dangerouslySetInnerHTML={{\r\n          __html: `\r\n            window.dataLayer = window.dataLayer || [];\r\n            function gtag(){dataLayer.push(arguments);}\r\n            gtag('js', new Date());\r\n            gtag('config', 'G-34NK4NEB9B', {\r\n              page_path: window.location.pathname,\r\n              page_location: window.location.href,\r\n              page_title: document.title,\r\n              send_page_view: true,\r\n            });\r\n          `,\r\n        }}\r\n      />\r\n\r\n      {/* Google Tag Manager - Always enabled if GTM_ID is configured */}\r\n      {analytics.GTM_ID && analytics.GTM_ID !== 'GTM-XXXXXXX' && (\r\n        <>\r\n          <Script\r\n            id=\"gtm-script\"\r\n            strategy=\"afterInteractive\"\r\n            dangerouslySetInnerHTML={{\r\n              __html: `\r\n                (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\r\n                new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\r\n                j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\r\n                'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\r\n                })(window,document,'script','dataLayer','${analytics.GTM_ID}');\r\n              `,\r\n            }}\r\n          />\r\n          <noscript>\r\n            <iframe\r\n              src={`https://www.googletagmanager.com/ns.html?id=${analytics.GTM_ID}`}\r\n              height=\"0\"\r\n              width=\"0\"\r\n              style={{ display: 'none', visibility: 'hidden' }}\r\n            />\r\n          </noscript>\r\n        </>\r\n      )}\r\n\r\n      {/* Google Analytics 4 - Enhanced (Additional tracking if configured) */}\r\n      {analytics.ENABLE_ANALYTICS && analytics.GA_TRACKING_ID !== 'G-XXXXXXXXXX' && analytics.GA_TRACKING_ID !== 'G-34NK4NEB9B' && (\r\n        <>\r\n          <Script\r\n            strategy=\"afterInteractive\"\r\n            src={`https://www.googletagmanager.com/gtag/js?id=${analytics.GA_TRACKING_ID}`}\r\n          />\r\n          <Script\r\n            id=\"gtag-init\"\r\n            strategy=\"afterInteractive\"\r\n            dangerouslySetInnerHTML={{\r\n              __html: `\r\n                window.dataLayer = window.dataLayer || [];\r\n                function gtag(){dataLayer.push(arguments);}\r\n                gtag('js', new Date());\r\n                gtag('config', '${analytics.GA_TRACKING_ID}', {\r\n                  page_path: window.location.pathname,\r\n                  page_location: window.location.href,\r\n                  page_title: document.title,\r\n                  send_page_view: true,\r\n                  anonymize_ip: true,\r\n                  cookie_flags: 'SameSite=None;Secure',\r\n                });\r\n              `,\r\n            }}\r\n          />\r\n        </>\r\n      )}\r\n\r\n      {/* Meta Pixel (Facebook Pixel) */}\r\n      {analytics.isMetaPixelEnabled && analytics.isMetaPixelEnabled() && (\r\n        <>\r\n          <Script\r\n            id=\"meta-pixel\"\r\n            strategy=\"afterInteractive\"\r\n            dangerouslySetInnerHTML={{\r\n              __html: `\r\n                !function(f,b,e,v,n,t,s)\r\n                {if(f.fbq)return;n=f.fbq=function(){n.callMethod?\r\n                n.callMethod.apply(n,arguments):n.queue.push(arguments)};\r\n                if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';\r\n                n.queue=[];t=b.createElement(e);t.async=!0;\r\n                t.src=v;s=b.getElementsByTagName(e)[0];\r\n                s.parentNode.insertBefore(t,s)}(window, document,'script',\r\n                'https://connect.facebook.net/en_US/fbevents.js');\r\n                fbq('init', '${analytics.META_PIXEL_ID}');\r\n                fbq('track', 'PageView');\r\n              `,\r\n            }}\r\n          />\r\n          <noscript>\r\n            <img\r\n              height=\"1\"\r\n              width=\"1\"\r\n              style={{ display: 'none' }}\r\n              src={`https://www.facebook.com/tr?id=${analytics.META_PIXEL_ID}&ev=PageView&noscript=1`}\r\n              alt=\"\"\r\n            />\r\n          </noscript>\r\n        </>\r\n      )}\r\n\r\n      {/* Bing Webmaster Tools Tracking */}\r\n      {analytics.isBingWebmasterEnabled && analytics.isBingWebmasterEnabled() && (\r\n        <Script\r\n          id=\"bing-webmaster\"\r\n          strategy=\"afterInteractive\"\r\n          dangerouslySetInnerHTML={{\r\n            __html: `\r\n              (function(c,l,a,r,i,t,y){\r\n                c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};\r\n                t=l.createElement(r);t.async=1;t.src=\"https://www.clarity.ms/tag/\"+i;\r\n                y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);\r\n              })(window, document, \"clarity\", \"script\", \"${analytics.BING_WEBMASTER_ID}\");\r\n            `,\r\n          }}\r\n        />\r\n      )}\r\n\r\n        <ToastContainer />\r\n        <Component {...pageProps} />\r\n        <DownloadManager />\r\n        {mounted && <ChatSupport />}\r\n        {process.env.NODE_ENV === 'production' && (\r\n          <>\r\n            <SpeedInsights />\r\n            <Analytics />\r\n          </>\r\n        )}\r\n        </LanguageProvider>\r\n      </QueryClientProvider>\r\n    </ErrorBoundary>\r\n  );\r\n}\r\n\r\nexport default MyApp;\r\n"],"names":[],"mappings":"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"}}]
}