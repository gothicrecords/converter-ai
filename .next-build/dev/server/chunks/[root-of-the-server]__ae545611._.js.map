{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jurit/OneDrive/Desktop/sito%20upscale/pages/api/tools/thumbnail-generator.js"],"sourcesContent":["import { formidable } from 'formidable';\r\nimport fs from 'fs';\r\nimport sharp from 'sharp';\r\n\r\nexport const config = {\r\n    api: {\r\n        bodyParser: false,\r\n    },\r\n};\r\n\r\nexport default async function handler(req, res) {\r\n    if (req.method !== 'POST') {\r\n        return res.status(405).json({ error: 'Method not allowed' });\r\n    }\r\n\r\n    try {\r\n        const form = formidable({});\r\n        const [fields, files] = await form.parse(req);\r\n        \r\n        const imageFile = files.image?.[0];\r\n        const size = fields.size?.[0]; // es. \"1280x720\"\r\n\r\n        if (!imageFile || !size) {\r\n            return res.status(400).json({ error: 'Immagine e dimensione sono richieste.' });\r\n        }\r\n\r\n        // Parse dimensioni\r\n        const [width, height] = size.split('x').map(Number);\r\n        \r\n        if (!width || !height) {\r\n            return res.status(400).json({ error: 'Formato dimensione non valido. Usa formato: 1280x720' });\r\n        }\r\n\r\n        // Processa immagine con sharp\r\n        const processedImage = await sharp(imageFile.filepath)\r\n            .resize(width, height, {\r\n                fit: 'cover',\r\n                position: 'center'\r\n            })\r\n            .png()\r\n            .toBuffer();\r\n\r\n        res.setHeader('Content-Type', 'image/png');\r\n        res.status(200).send(processedImage);\r\n\r\n    } catch (error) {\r\n        console.error('Errore API Thumbnail Generator:', error);\r\n        res.status(500).json({ error: 'Errore interno del server durante la generazione della thumbnail.' });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;;;;;AAEO,MAAM,SAAS;IAClB,KAAK;QACD,YAAY;IAChB;AACJ;AAEe,eAAe,QAAQ,GAAG,EAAE,GAAG;IAC1C,IAAI,IAAI,MAAM,KAAK,QAAQ;QACvB,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAqB;IAC9D;IAEA,IAAI;QACA,MAAM,OAAO,IAAA,kIAAU,EAAC,CAAC;QACzB,MAAM,CAAC,QAAQ,MAAM,GAAG,MAAM,KAAK,KAAK,CAAC;QAEzC,MAAM,YAAY,MAAM,KAAK,EAAE,CAAC,EAAE;QAClC,MAAM,OAAO,OAAO,IAAI,EAAE,CAAC,EAAE,EAAE,iBAAiB;QAEhD,IAAI,CAAC,aAAa,CAAC,MAAM;YACrB,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO;YAAwC;QACjF;QAEA,mBAAmB;QACnB,MAAM,CAAC,OAAO,OAAO,GAAG,KAAK,KAAK,CAAC,KAAK,GAAG,CAAC;QAE5C,IAAI,CAAC,SAAS,CAAC,QAAQ;YACnB,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO;YAAuD;QAChG;QAEA,8BAA8B;QAC9B,MAAM,iBAAiB,MAAM,IAAA,8GAAK,EAAC,UAAU,QAAQ,EAChD,MAAM,CAAC,OAAO,QAAQ;YACnB,KAAK;YACL,UAAU;QACd,GACC,GAAG,GACH,QAAQ;QAEb,IAAI,SAAS,CAAC,gBAAgB;QAC9B,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;IAEzB,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,mCAAmC;QACjD,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAoE;IACtG;AACJ"}}]
}