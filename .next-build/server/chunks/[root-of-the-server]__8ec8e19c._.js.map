{"version":3,"sources":["../../../lib/usage-limits.js","../../../lib/usage-tracker.js"],"sourcesContent":["// Sistema di limiti d'uso per tool gratuiti e PRO\r\n// Piano gratuito senza registrazione: molto generoso per convincere a registrarsi\r\n\r\nexport const USAGE_LIMITS = {\r\n    // Piano gratuito SENZA registrazione (generoso ma limitato per incentivare registrazione)\r\n    GUEST: {\r\n        // Tool PRO - 5 utilizzi al giorno per tutti (generoso ma limitato)\r\n        'rimozione-sfondo-ai': {\r\n            daily: 5, // 5 immagini al giorno\r\n            monthly: 50, // 50 immagini al mese\r\n            fileSize: 5 * 1024 * 1024, // 5MB max\r\n        },\r\n        'generazione-immagini-ai': {\r\n            daily: 5, // 5 immagini al giorno\r\n            monthly: 50, // 50 immagini al mese\r\n        },\r\n        'clean-noise-ai': {\r\n            daily: 5, // 5 audio al giorno\r\n            monthly: 50, // 50 audio al mese\r\n            fileSize: 10 * 1024 * 1024, // 10MB max\r\n        },\r\n        'ocr-avanzato-ai': {\r\n            daily: 5, // 5 documenti al giorno\r\n            monthly: 50, // 50 documenti al mese\r\n            fileSize: 10 * 1024 * 1024, // 10MB max\r\n        },\r\n        'traduzione-documenti-ai': {\r\n            daily: 5, // 5 documenti al giorno\r\n            monthly: 50, // 50 documenti al mese\r\n            fileSize: 10 * 1024 * 1024, // 10MB max\r\n        },\r\n        'elabora-e-riassumi': {\r\n            daily: 5, // 5 testi al giorno\r\n            monthly: 50, // 50 testi al mese\r\n            maxLength: 5000, // 5000 caratteri max\r\n        },\r\n        'thumbnail-generator': {\r\n            daily: 5, // 5 thumbnail al giorno\r\n            monthly: 50, // 50 thumbnail al mese\r\n        },\r\n        'upscaler-ai': {\r\n            daily: 5, // 5 immagini al giorno\r\n            monthly: 50, // 50 immagini al mese\r\n            fileSize: 5 * 1024 * 1024, // 5MB max\r\n        },\r\n        // Tool gratuiti - limiti molto generosi\r\n        'trascrizione-audio': {\r\n            daily: 10, // 10 audio al giorno\r\n            monthly: 200, // 200 audio al mese\r\n            fileSize: 25 * 1024 * 1024, // 25MB max\r\n        },\r\n        'riassunto-testo': {\r\n            daily: 20, // 20 testi al giorno\r\n            monthly: 500, // 500 testi al mese\r\n            maxLength: 10000, // 10000 caratteri max\r\n        },\r\n        'traduci-testo': {\r\n            daily: 50, // 50 traduzioni al giorno\r\n            monthly: 1000, // 1000 traduzioni al mese\r\n            maxLength: 5000, // 5000 caratteri max\r\n        },\r\n        'correttore-grammaticale': {\r\n            daily: 30, // 30 testi al giorno\r\n            monthly: 500, // 500 testi al mese\r\n            maxLength: 5000, // 5000 caratteri max\r\n        },\r\n        'combina-splitta-pdf': {\r\n            daily: 20, // 20 operazioni al giorno\r\n            monthly: 300, // 300 operazioni al mese\r\n            fileSize: 50 * 1024 * 1024, // 50MB max\r\n        },\r\n    },\r\n    \r\n    // Piano gratuito CON registrazione (ancora più generoso)\r\n    FREE: {\r\n        'rimozione-sfondo-ai': {\r\n            daily: 50, // 50 immagini al giorno\r\n            monthly: 1000, // 1000 immagini al mese\r\n            fileSize: 10 * 1024 * 1024, // 10MB max\r\n        },\r\n        'generazione-immagini-ai': {\r\n            daily: 20, // 20 immagini al giorno\r\n            monthly: 300, // 300 immagini al mese\r\n        },\r\n        'clean-noise-ai': {\r\n            daily: 20, // 20 audio al giorno\r\n            monthly: 400, // 400 audio al mese\r\n            fileSize: 25 * 1024 * 1024, // 25MB max\r\n        },\r\n        'ocr-avanzato-ai': {\r\n            daily: 50, // 50 documenti al giorno\r\n            monthly: 1000, // 1000 documenti al mese\r\n            fileSize: 25 * 1024 * 1024, // 25MB max\r\n        },\r\n        'traduzione-documenti-ai': {\r\n            daily: 20, // 20 documenti al giorno\r\n            monthly: 400, // 400 documenti al mese\r\n            fileSize: 25 * 1024 * 1024, // 25MB max\r\n        },\r\n        'elabora-e-riassumi': {\r\n            daily: 50, // 50 testi al giorno\r\n            monthly: 1000, // 1000 testi al mese\r\n            maxLength: 20000, // 20000 caratteri max\r\n        },\r\n        'thumbnail-generator': {\r\n            daily: 50, // 50 thumbnail al giorno\r\n            monthly: 1000, // 1000 thumbnail al mese\r\n        },\r\n        'upscaler-ai': {\r\n            daily: 100, // 100 immagini al giorno\r\n            monthly: 2000, // 2000 immagini al mese\r\n            fileSize: 25 * 1024 * 1024, // 25MB max\r\n        },\r\n        'trascrizione-audio': {\r\n            daily: 50, // 50 audio al giorno\r\n            monthly: 1000, // 1000 audio al mese\r\n            fileSize: 50 * 1024 * 1024, // 50MB max\r\n        },\r\n        'riassunto-testo': {\r\n            daily: 100, // 100 testi al giorno\r\n            monthly: 2000, // 2000 testi al mese\r\n            maxLength: 50000, // 50000 caratteri max\r\n        },\r\n        'traduci-testo': {\r\n            daily: 200, // 200 traduzioni al giorno\r\n            monthly: 5000, // 5000 traduzioni al mese\r\n            maxLength: 20000, // 20000 caratteri max\r\n        },\r\n        'correttore-grammaticale': {\r\n            daily: 100, // 100 testi al giorno\r\n            monthly: 2000, // 2000 testi al mese\r\n            maxLength: 20000, // 20000 caratteri max\r\n        },\r\n        'combina-splitta-pdf': {\r\n            daily: 100, // 100 operazioni al giorno\r\n            monthly: 2000, // 2000 operazioni al mese\r\n            fileSize: 100 * 1024 * 1024, // 100MB max\r\n        },\r\n    },\r\n    \r\n    // Piano PRO (illimitato o limiti molto alti)\r\n    PRO: {\r\n        'rimozione-sfondo-ai': {\r\n            daily: -1, // Illimitato\r\n            monthly: -1, // Illimitato\r\n            fileSize: 50 * 1024 * 1024, // 50MB max\r\n        },\r\n        'generazione-immagini-ai': {\r\n            daily: 100, // 100 immagini al giorno\r\n            monthly: 2000, // 2000 immagini al mese\r\n        },\r\n        'clean-noise-ai': {\r\n            daily: -1, // Illimitato\r\n            monthly: -1, // Illimitato\r\n            fileSize: 100 * 1024 * 1024, // 100MB max\r\n        },\r\n        'ocr-avanzato-ai': {\r\n            daily: -1, // Illimitato\r\n            monthly: -1, // Illimitato\r\n            fileSize: 100 * 1024 * 1024, // 100MB max\r\n        },\r\n        'traduzione-documenti-ai': {\r\n            daily: -1, // Illimitato\r\n            monthly: -1, // Illimitato\r\n            fileSize: 100 * 1024 * 1024, // 100MB max\r\n        },\r\n        'elabora-e-riassumi': {\r\n            daily: -1, // Illimitato\r\n            monthly: -1, // Illimitato\r\n            maxLength: -1, // Illimitato\r\n        },\r\n        'thumbnail-generator': {\r\n            daily: -1, // Illimitato\r\n            monthly: -1, // Illimitato\r\n        },\r\n        'upscaler-ai': {\r\n            daily: -1, // Illimitato\r\n            monthly: -1, // Illimitato\r\n            fileSize: 100 * 1024 * 1024, // 100MB max\r\n        },\r\n        'trascrizione-audio': {\r\n            daily: -1, // Illimitato\r\n            monthly: -1, // Illimitato\r\n            fileSize: 200 * 1024 * 1024, // 200MB max\r\n        },\r\n        'riassunto-testo': {\r\n            daily: -1, // Illimitato\r\n            monthly: -1, // Illimitato\r\n            maxLength: -1, // Illimitato\r\n        },\r\n        'traduci-testo': {\r\n            daily: -1, // Illimitato\r\n            monthly: -1, // Illimitato\r\n            maxLength: -1, // Illimitato\r\n        },\r\n        'correttore-grammaticale': {\r\n            daily: -1, // Illimitato\r\n            monthly: -1, // Illimitato\r\n            maxLength: -1, // Illimitato\r\n        },\r\n        'combina-splitta-pdf': {\r\n            daily: -1, // Illimitato\r\n            monthly: -1, // Illimitato\r\n            fileSize: 500 * 1024 * 1024, // 500MB max\r\n        },\r\n    },\r\n};\r\n\r\n/**\r\n * Ottiene i limiti per un tool specifico in base al piano utente\r\n * @param {string} toolSlug - Slug del tool\r\n * @param {string} userPlan - Piano utente: 'GUEST', 'FREE', 'PRO'\r\n * @returns {Object|null} Limiti del tool o null se non trovato\r\n */\r\nexport function getToolLimits(toolSlug, userPlan = 'GUEST') {\r\n    const planLimits = USAGE_LIMITS[userPlan] || USAGE_LIMITS.GUEST;\r\n    return planLimits[toolSlug] || null;\r\n}\r\n\r\n/**\r\n * Verifica se un utente può usare un tool\r\n * @param {string} toolSlug - Slug del tool\r\n * @param {string} userPlan - Piano utente\r\n * @param {Object} usageStats - Statistiche uso corrente (daily, monthly)\r\n * @param {Object} fileInfo - Info file (size, length, etc.)\r\n * @returns {Object} { allowed: boolean, reason: string }\r\n */\r\nexport function canUseTool(toolSlug, userPlan = 'GUEST', usageStats = {}, fileInfo = {}) {\r\n    const limits = getToolLimits(toolSlug, userPlan);\r\n    \r\n    if (!limits) {\r\n        return { allowed: true, reason: 'Nessun limite configurato' };\r\n    }\r\n    \r\n    // Verifica limite giornaliero\r\n    if (limits.daily !== -1 && usageStats.daily >= limits.daily) {\r\n        return {\r\n            allowed: false,\r\n            reason: `Hai raggiunto il limite giornaliero di ${limits.daily} utilizzi. Riprova domani o passa a PRO per limiti più alti.`,\r\n            limitType: 'daily',\r\n            current: usageStats.daily,\r\n            max: limits.daily,\r\n        };\r\n    }\r\n    \r\n    // Verifica limite mensile\r\n    if (limits.monthly !== -1 && usageStats.monthly >= limits.monthly) {\r\n        return {\r\n            allowed: false,\r\n            reason: `Hai raggiunto il limite mensile di ${limits.monthly} utilizzi. Passa a PRO per limiti più alti.`,\r\n            limitType: 'monthly',\r\n            current: usageStats.monthly,\r\n            max: limits.monthly,\r\n        };\r\n    }\r\n    \r\n    // Verifica dimensione file\r\n    if (limits.fileSize && fileInfo.size && fileInfo.size > limits.fileSize) {\r\n        const maxMB = (limits.fileSize / (1024 * 1024)).toFixed(0);\r\n        return {\r\n            allowed: false,\r\n            reason: `File troppo grande. Dimensione massima: ${maxMB}MB. Passa a PRO per file più grandi.`,\r\n            limitType: 'fileSize',\r\n            current: fileInfo.size,\r\n            max: limits.fileSize,\r\n        };\r\n    }\r\n    \r\n    // Verifica lunghezza testo\r\n    if (limits.maxLength && fileInfo.length && fileInfo.length > limits.maxLength) {\r\n        return {\r\n            allowed: false,\r\n            reason: `Testo troppo lungo. Lunghezza massima: ${limits.maxLength} caratteri. Passa a PRO per testi più lunghi.`,\r\n            limitType: 'maxLength',\r\n            current: fileInfo.length,\r\n            max: limits.maxLength,\r\n        };\r\n    }\r\n    \r\n    return { allowed: true, reason: 'OK' };\r\n}\r\n\r\n/**\r\n * Ottiene il messaggio di upgrade per un tool\r\n * @param {string} toolSlug - Slug del tool\r\n * @param {string} currentPlan - Piano corrente\r\n * @returns {string} Messaggio di upgrade\r\n */\r\nexport function getUpgradeMessage(toolSlug, currentPlan = 'GUEST') {\r\n    const limits = getToolLimits(toolSlug, currentPlan);\r\n    const proLimits = getToolLimits(toolSlug, 'PRO');\r\n    \r\n    if (!limits || !proLimits) {\r\n        return 'Passa a PRO per funzionalità avanzate!';\r\n    }\r\n    \r\n    const messages = [];\r\n    \r\n    if (limits.daily !== -1 && proLimits.daily === -1) {\r\n        messages.push('utilizzi illimitati');\r\n    } else if (limits.daily < proLimits.daily) {\r\n        messages.push(`${proLimits.daily} utilizzi al giorno`);\r\n    }\r\n    \r\n    if (limits.fileSize && proLimits.fileSize && limits.fileSize < proLimits.fileSize) {\r\n        const maxMB = (proLimits.fileSize / (1024 * 1024)).toFixed(0);\r\n        messages.push(`file fino a ${maxMB}MB`);\r\n    }\r\n    \r\n    if (limits.maxLength && proLimits.maxLength === -1) {\r\n        messages.push('testi di lunghezza illimitata');\r\n    }\r\n    \r\n    if (messages.length === 0) {\r\n        return 'Passa a PRO per funzionalità avanzate!';\r\n    }\r\n    \r\n    return `Passa a PRO per ${messages.join(', ')} e molto altro!`;\r\n}\r\n\r\nexport default {\r\n    USAGE_LIMITS,\r\n    getToolLimits,\r\n    canUseTool,\r\n    getUpgradeMessage,\r\n};\r\n\r\n","// Sistema di tracking degli usi per limiti gratuiti/PRO\r\n// Usa storage in-memory (in produzione si può usare database)\r\n\r\nconst usageStore = new Map(); // { userId: { toolSlug: { daily: count, monthly: count, lastReset: date } } }\r\n\r\n/**\r\n * Ottiene le statistiche di uso per un utente e tool\r\n * @param {string} userId - ID utente (o 'guest' per utenti non registrati)\r\n * @param {string} toolSlug - Slug del tool\r\n * @returns {Object} { daily: number, monthly: number }\r\n */\r\nexport function getUsageStats(userId = 'guest', toolSlug) {\r\n    const userKey = userId || 'guest';\r\n    \r\n    if (!usageStore.has(userKey)) {\r\n        usageStore.set(userKey, {});\r\n    }\r\n    \r\n    const userUsage = usageStore.get(userKey);\r\n    \r\n    if (!userUsage[toolSlug]) {\r\n        userUsage[toolSlug] = {\r\n            daily: 0,\r\n            monthly: 0,\r\n            lastDailyReset: new Date().toDateString(),\r\n            lastMonthlyReset: new Date().getMonth(),\r\n        };\r\n    }\r\n    \r\n    const toolUsage = userUsage[toolSlug];\r\n    const today = new Date().toDateString();\r\n    const thisMonth = new Date().getMonth();\r\n    \r\n    // Reset giornaliero se necessario\r\n    if (toolUsage.lastDailyReset !== today) {\r\n        toolUsage.daily = 0;\r\n        toolUsage.lastDailyReset = today;\r\n    }\r\n    \r\n    // Reset mensile se necessario\r\n    if (toolUsage.lastMonthlyReset !== thisMonth) {\r\n        toolUsage.monthly = 0;\r\n        toolUsage.lastMonthlyReset = thisMonth;\r\n    }\r\n    \r\n    return {\r\n        daily: toolUsage.daily || 0,\r\n        monthly: toolUsage.monthly || 0,\r\n    };\r\n}\r\n\r\n/**\r\n * Incrementa il contatore di uso per un tool\r\n * @param {string} userId - ID utente\r\n * @param {string} toolSlug - Slug del tool\r\n */\r\nexport function incrementUsage(userId = 'guest', toolSlug) {\r\n    const userKey = userId || 'guest';\r\n    \r\n    if (!usageStore.has(userKey)) {\r\n        usageStore.set(userKey, {});\r\n    }\r\n    \r\n    const userUsage = usageStore.get(userKey);\r\n    \r\n    if (!userUsage[toolSlug]) {\r\n        userUsage[toolSlug] = {\r\n            daily: 0,\r\n            monthly: 0,\r\n            lastDailyReset: new Date().toDateString(),\r\n            lastMonthlyReset: new Date().getMonth(),\r\n        };\r\n    }\r\n    \r\n    const toolUsage = userUsage[toolSlug];\r\n    const today = new Date().toDateString();\r\n    const thisMonth = new Date().getMonth();\r\n    \r\n    // Reset se necessario\r\n    if (toolUsage.lastDailyReset !== today) {\r\n        toolUsage.daily = 0;\r\n        toolUsage.lastDailyReset = today;\r\n    }\r\n    \r\n    if (toolUsage.lastMonthlyReset !== thisMonth) {\r\n        toolUsage.monthly = 0;\r\n        toolUsage.lastMonthlyReset = thisMonth;\r\n    }\r\n    \r\n    // Incrementa contatori\r\n    toolUsage.daily = (toolUsage.daily || 0) + 1;\r\n    toolUsage.monthly = (toolUsage.monthly || 0) + 1;\r\n}\r\n\r\n/**\r\n * Ottiene il piano utente (per ora semplificato, in produzione si legge dal database)\r\n * @param {Object} req - Request object (opzionale)\r\n * @returns {string} Piano utente: 'GUEST', 'FREE', 'PRO'\r\n */\r\nexport function getUserPlan(req = null) {\r\n    // TODO: In produzione, leggere dal database o dalla sessione\r\n    // Per ora ritorna sempre 'GUEST' (utente non registrato)\r\n    \r\n    if (req && req.headers && req.headers['x-user-id']) {\r\n        // Se c'è un user ID, potresti controllare il piano dal database\r\n        // Per ora assumiamo FREE se registrato\r\n        return 'FREE';\r\n    }\r\n    \r\n    return 'GUEST';\r\n}\r\n\r\n/**\r\n * Ottiene l'ID utente dalla richiesta\r\n * @param {Object} req - Request object\r\n * @returns {string} User ID o 'guest'\r\n */\r\nexport function getUserId(req = null) {\r\n    if (req && req.headers && req.headers['x-user-id']) {\r\n        return req.headers['x-user-id'];\r\n    }\r\n    \r\n    // In produzione, potresti usare session/cookie\r\n    return 'guest';\r\n}\r\n\r\nexport default {\r\n    getUsageStats,\r\n    incrementUsage,\r\n    getUserPlan,\r\n    getUserId,\r\n};\r\n\r\n"],"names":[],"mappings":"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"}