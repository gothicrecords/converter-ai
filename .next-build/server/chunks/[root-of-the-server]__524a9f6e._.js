module.exports=[70406,(e,t,i)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},29211,(e,t,i)=>{t.exports=e.x("mammoth",()=>require("mammoth"))},16969,(e,t,i)=>{t.exports=e.x("xlsx",()=>require("xlsx"))},98044,e=>e.a(async(t,i)=>{try{var n=e.i(62069),a=t([n]);async function o(e,t){if("POST"!==e.method)return t.status(405).json({error:"Method not allowed"});try{let{message:i,fileIds:a=[],conversationHistory:o=[]}=e.body;if(!i||!i.trim())return t.status(400).json({error:"Message is required",details:"Please provide a non-empty message"});let r=(0,n.getDocumentStats)(),s=a&&Array.isArray(a)&&a.length>0?a.filter(e=>e&&"string"==typeof e):null;if(0===r.totalDocuments){let e=i.toLowerCase(),n="";return n=e.includes("come funziona")||e.includes("how does")?"Benvenuto in **Documenti AI**! ðŸš€\n\n**Come funziona:**\n1. Carica uno o piÃ¹ documenti (PDF, DOCX, XLSX, TXT)\n2. Fai domande sul contenuto\n3. Ricevi risposte intelligenti basate sui tuoi file\n\n**Cosa posso fare:**\n- Analizzare documenti e trovare informazioni specifiche\n- Rispondere a domande sul contenuto\n- Eseguire ricerche semantiche nei tuoi file\n- Sintetizzare informazioni da piÃ¹ documenti\n\n**Carica un documento per iniziare!**":e.includes("formato")||e.includes("format")?"**Formati supportati:**\n\nâœ… PDF - Documenti PDF\nâœ… DOCX - Documenti Word\nâœ… XLSX/XLS/CSV - Fogli di calcolo Excel\nâœ… TXT - File di testo\n\nTutti i formati vengono analizzati completamente per permetterti di fare domande intelligenti sul contenuto.":e.includes("cosa puoi fare")||e.includes("what can")?"**Cosa posso fare con i tuoi documenti:**\n\nðŸ“Š **Analisi intelligente** - Estraggo e organizzo tutto il contenuto\nðŸ” **Ricerca semantica** - Trovo informazioni anche con parole chiave diverse\nðŸ’¬ **Chat intelligente** - Rispondo a domande specifiche sul contenuto\nðŸ“ **Sintesi** - Riassumo informazioni da piÃ¹ documenti\nðŸ”— **Citazioni** - Mostro esattamente da dove provengono le risposte\n\n**Carica un documento e prova!**":e.includes("ciao")||e.includes("hello")||e.includes("hi")?"Ciao! ðŸ‘‹\n\nSono il tuo assistente AI per l'analisi documenti. Posso aiutarti a:\n- Analizzare documenti PDF, DOCX, Excel e file di testo\n- Trovare informazioni specifiche nel contenuto\n- Rispondere a domande sui tuoi file\n- Eseguire ricerche semantiche intelligenti\n\n**Carica un documento per iniziare!** Usa il pulsante + per caricare i tuoi file.":`Ho ricevuto il tuo messaggio: "${i}"

**Per rispondere alle tue domande sui documenti:**
1. Carica uno o pi\xf9 documenti usando il pulsante + in basso
2. Fai domande sul contenuto
3. Ricevi risposte precise basate sui tuoi file

**Formati supportati:** PDF, DOCX, XLSX, TXT
**Tutto completamente gratuito e illimitato!**`,t.status(200).json({success:!0,message:n,timestamp:new Date().toISOString(),noDocuments:!0,stats:r})}let l=await (0,n.searchAllDocuments)(i,s);if(l.length,0===l.length)return t.status(200).json({success:!0,message:`Non ho trovato informazioni rilevanti nei documenti caricati per rispondere a: "${i}"

**Suggerimenti:**
- Prova a formulare la domanda in modo diverso
- Usa parole chiave pi\xf9 specifiche
- Verifica che i documenti caricati contengano le informazioni richieste

**Documenti caricati:** ${r.totalDocuments}
**Sezioni totali:** ${r.totalChunks}`,timestamp:new Date().toISOString(),noResults:!0,stats:r});let c=o.filter(e=>e.role&&e.content).slice(-3).map(e=>`${"user"===e.role?"Utente":"Assistente"}: ${e.content}`).join("\n\n"),u=await (0,n.generateMultiDocumentAnswer)(i,l,c),d=u.answer;return u.sources&&u.sources.length>0&&(d+=`

ðŸ“š **Documenti consultati:**

`,u.sources.forEach((e,t)=>{let i=parseFloat(e.score),n=(100*i).toFixed(0);d+=`"${e.filename}" (rilevanza: ${n}%)
`})),d+=`

ðŸ’¡ Ho cercato in ${r.totalDocuments} document${r.totalDocuments>1?"i":"o"} con ${r.totalChunks} sezioni totali.`,t.status(200).json({success:!0,message:d,timestamp:new Date().toISOString(),confidence:u.confidence,sources:u.sources||[],documentsUsed:l.map(e=>({fileId:e.fileId,filename:e.filename,topScore:e.topScore})),stats:r})}catch(e){return console.error("Chat API Error:",e),t.status(500).json({error:"Errore durante l'elaborazione",details:e.message,timestamp:new Date().toISOString()})}}[n]=a.then?(await a)():a,e.s(["default",()=>o]),i()}catch(e){i(e)}},!1),20373,e=>e.a(async(t,i)=>{try{var n=e.i(26747),a=e.i(90406),o=e.i(44898),r=e.i(62950),s=e.i(98044),l=e.i(7031),c=e.i(81927),u=e.i(46432),d=t([s]);[s]=d.then?(await d)():d;let p=(0,r.hoist)(s,"default"),h=(0,r.hoist)(s,"config"),f=new o.PagesAPIRouteModule({definition:{kind:a.RouteKind.PAGES_API,page:"/api/chat/message",pathname:"/api/chat/message",bundlePath:"",filename:""},userland:s,distDir:".next-build",relativeProjectDir:""});async function m(e,t,i){f.isDev&&(0,u.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let a="/api/chat/message";a=a.replace(/\/index$/,"")||"/";let o=await f.prepare(e,t,{srcPage:a});if(!o){t.statusCode=400,t.end("Bad Request"),null==i.waitUntil||i.waitUntil.call(i,Promise.resolve());return}let{query:r,params:s,prerenderManifest:d,routerServerContext:m}=o;try{let i=e.method||"GET",n=(0,l.getTracer)(),o=n.getActiveScopeSpan(),u=f.instrumentationOnRequestError.bind(f),p=async o=>f.render(e,t,{query:{...r,...s},params:s,allowedRevalidateHeaderKeys:[],multiZoneDraftMode:!1,trustHostHeader:!1,previewProps:d.preview,propagateError:!1,dev:f.isDev,page:"/api/chat/message",internalRevalidate:null==m?void 0:m.revalidate,onError:(...t)=>u(e,...t)}).finally(()=>{if(!o)return;o.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let e=n.getRootSpanAttributes();if(!e)return;if(e.get("next.span_type")!==c.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${e.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let r=e.get("next.route");if(r){let e=`${i} ${r}`;o.setAttributes({"next.route":r,"http.route":r,"next.span_name":e}),o.updateName(e)}else o.updateName(`${i} ${a}`)});o?await p(o):await n.withPropagatedContext(e.headers,()=>n.trace(c.BaseServerSpan.handleRequest,{spanName:`${i} ${a}`,kind:l.SpanKind.SERVER,attributes:{"http.method":i,"http.target":e.url}},p))}catch(e){if(f.isDev)throw e;(0,n.sendError)(t,500,"Internal Server Error")}finally{null==i.waitUntil||i.waitUntil.call(i,Promise.resolve())}}e.s(["config",0,h,"default",0,p,"handler",()=>m]),i()}catch(e){i(e)}},!1),23970,e=>{e.v(t=>Promise.all(["server/chunks/[externals]_fs_54ffce70._.js"].map(t=>e.l(t))).then(()=>t(22734)))},25775,e=>{e.v(e=>Promise.resolve().then(()=>e(67370)))},35943,e=>{e.v(t=>Promise.all(["server/chunks/[externals]_tesseract_463eb979.js"].map(t=>e.l(t))).then(()=>t(36493)))},89793,e=>{e.v(t=>Promise.all(["server/chunks/[externals]_path_e30b8067._.js"].map(t=>e.l(t))).then(()=>t(14747)))},7480,e=>{e.v(t=>Promise.all(["server/chunks/[externals]_os_066ffa03._.js"].map(t=>e.l(t))).then(()=>t(46786)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__524a9f6e._.js.map