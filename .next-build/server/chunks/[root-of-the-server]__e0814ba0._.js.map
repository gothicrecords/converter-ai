{"version":3,"sources":["../../../errors/index.js","../../../pages/api/diagnostics.js","../../../node_modules/next/dist/esm/build/templates/pages-api.js"],"sourcesContent":["/**\r\n * Centralized error handling\r\n * Provides consistent error responses and error classes\r\n */\r\n\r\nexport class AppError extends Error {\r\n  constructor(message, statusCode = 500, code = null, details = null, originalError = null) {\r\n    super(message);\r\n    this.name = this.constructor.name;\r\n    this.statusCode = statusCode;\r\n    this.code = code;\r\n    this.details = details;\r\n    this.originalError = originalError;\r\n    this.timestamp = new Date().toISOString();\r\n    this.requestId = null; // Can be set by middleware\r\n    \r\n    // Capture stack trace\r\n    if (Error.captureStackTrace) {\r\n      Error.captureStackTrace(this, this.constructor);\r\n    } else {\r\n      this.stack = (new Error()).stack;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Convert error to plain object for logging\r\n   */\r\n  toJSON() {\r\n    return {\r\n      name: this.name,\r\n      message: this.message,\r\n      statusCode: this.statusCode,\r\n      code: this.code,\r\n      details: this.details,\r\n      timestamp: this.timestamp,\r\n      requestId: this.requestId,\r\n      stack: this.stack,\r\n    };\r\n  }\r\n}\r\n\r\nexport class ValidationError extends AppError {\r\n  constructor(message, details = null) {\r\n    super(message, 400, 'VALIDATION_ERROR', details);\r\n  }\r\n}\r\n\r\nexport class AuthenticationError extends AppError {\r\n  constructor(message = 'Authentication required') {\r\n    super(message, 401, 'AUTHENTICATION_ERROR');\r\n  }\r\n}\r\n\r\nexport class AuthorizationError extends AppError {\r\n  constructor(message = 'Insufficient permissions') {\r\n    super(message, 403, 'AUTHORIZATION_ERROR');\r\n  }\r\n}\r\n\r\nexport class NotFoundError extends AppError {\r\n  constructor(resource = 'Resource') {\r\n    super(`${resource} not found`, 404, 'NOT_FOUND');\r\n  }\r\n}\r\n\r\nexport class ConflictError extends AppError {\r\n  constructor(message) {\r\n    super(message, 409, 'CONFLICT');\r\n  }\r\n}\r\n\r\nexport class RateLimitError extends AppError {\r\n  constructor(message = 'Too many requests', retryAfter = null) {\r\n    super(message, 429, 'RATE_LIMIT_EXCEEDED', retryAfter ? { retryAfter } : null);\r\n  }\r\n}\r\n\r\nexport class DatabaseError extends AppError {\r\n  constructor(message, originalError = null) {\r\n    super(message, 500, 'DATABASE_ERROR', null, originalError);\r\n  }\r\n}\r\n\r\nexport class FileSystemError extends AppError {\r\n  constructor(message, originalError = null) {\r\n    super(message, 500, 'FILE_SYSTEM_ERROR', null, originalError);\r\n  }\r\n}\r\n\r\nexport class NetworkError extends AppError {\r\n  constructor(message, originalError = null) {\r\n    super(message, 503, 'NETWORK_ERROR', null, originalError);\r\n  }\r\n}\r\n\r\nexport class TimeoutError extends AppError {\r\n  constructor(message = 'Request timeout', timeoutMs = null) {\r\n    super(message, 408, 'TIMEOUT_ERROR', timeoutMs ? { timeoutMs } : null);\r\n  }\r\n}\r\n\r\nexport class FileTooLargeError extends AppError {\r\n  constructor(maxSize, actualSize = null) {\r\n    const message = `File too large. Maximum size is ${formatFileSize(maxSize)}`;\r\n    super(message, 413, 'FILE_TOO_LARGE', { maxSize, actualSize });\r\n  }\r\n}\r\n\r\nexport class InvalidFileTypeError extends AppError {\r\n  constructor(allowedTypes = null) {\r\n    const message = allowedTypes \r\n      ? `Invalid file type. Allowed types: ${allowedTypes.join(', ')}`\r\n      : 'Invalid file type';\r\n    super(message, 400, 'INVALID_FILE_TYPE', { allowedTypes });\r\n  }\r\n}\r\n\r\nexport class ProcessingError extends AppError {\r\n  constructor(message, originalError = null) {\r\n    super(message, 500, 'PROCESSING_ERROR', null, originalError);\r\n  }\r\n}\r\n\r\n/**\r\n * Format file size for human-readable display\r\n */\r\nfunction formatFileSize(bytes) {\r\n  if (bytes === 0) return '0 Bytes';\r\n  const k = 1024;\r\n  const sizes = ['Bytes', 'KB', 'MB', 'GB'];\r\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n  return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];\r\n}\r\n\r\n/**\r\n * Enhanced error logger with advanced tracking\r\n */\r\nasync function logError(error, context = {}) {\r\n  const errorInfo = {\r\n    timestamp: new Date().toISOString(),\r\n    error: error instanceof AppError ? error.toJSON() : {\r\n      name: error.name,\r\n      message: error.message,\r\n      stack: error.stack,\r\n    },\r\n    context,\r\n    environment: process.env.NODE_ENV,\r\n  };\r\n\r\n  // Log to console with appropriate level\r\n  if (error instanceof AppError && error.statusCode < 500) {\r\n    // Client errors (4xx) - log as warning\r\n    console.warn('Client Error:', JSON.stringify(errorInfo, null, 2));\r\n  } else {\r\n    // Server errors (5xx) - log as error\r\n    console.error('Server Error:', JSON.stringify(errorInfo, null, 2));\r\n  }\r\n\r\n  // Track error with advanced error tracker\r\n  try {\r\n    const { default: errorTracker } = await import('../lib/errorTracker.js');\r\n    const { log } = await import('../lib/logger.js');\r\n    await errorTracker.trackError(error, context);\r\n    log.error('Error logged', error, context);\r\n  } catch (importError) {\r\n    // Error tracker not available, continue with basic logging\r\n    console.warn('Error tracker not available:', importError.message);\r\n  }\r\n\r\n  // In production, you might want to send to error tracking service\r\n  // Example: Sentry, LogRocket, etc.\r\n  if (process.env.NODE_ENV === 'production' && process.env.ERROR_TRACKING_ENABLED === 'true') {\r\n    // TODO: Integrate with error tracking service\r\n    // trackError(errorInfo);\r\n  }\r\n\r\n  return errorInfo;\r\n}\r\n\r\n/**\r\n * Format error response for API\r\n */\r\nexport function formatErrorResponse(error, includeStack = false, includeDetails = true) {\r\n  const isDevelopment = process.env.NODE_ENV === 'development';\r\n  \r\n  const response = {\r\n    error: error.message || 'Internal server error',\r\n    code: error.code || 'INTERNAL_ERROR',\r\n  };\r\n\r\n  // Include details if available and allowed\r\n  if (includeDetails && error.details) {\r\n    response.details = error.details;\r\n  }\r\n\r\n  // Include stack trace only in development\r\n  if (includeStack || isDevelopment) {\r\n    response.stack = error.stack;\r\n  }\r\n\r\n  // Include request ID if available\r\n  if (error.requestId) {\r\n    response.requestId = error.requestId;\r\n  }\r\n\r\n  // Include timestamp\r\n  if (error.timestamp) {\r\n    response.timestamp = error.timestamp;\r\n  }\r\n\r\n  return response;\r\n}\r\n\r\n/**\r\n * Handle errors in API routes with improved error resolution\r\n */\r\nexport async function handleApiError(error, res, context = {}) {\r\n  // Log the error with context\r\n  await logError(error, context);\r\n\r\n  // If response already sent, just log\r\n  if (res.headersSent) {\r\n    return;\r\n  }\r\n\r\n  // Handle known error types\r\n  if (error instanceof AppError) {\r\n    return res.status(error.statusCode).json(\r\n      formatErrorResponse(error, false, true)\r\n    );\r\n  }\r\n\r\n  // Handle specific error types from libraries and Node.js\r\n  if (error.name === 'ValidationError' || error.name === 'CastError') {\r\n    return res.status(400).json(\r\n      formatErrorResponse(new ValidationError(error.message, error.errors), false)\r\n    );\r\n  }\r\n\r\n  // Handle database connection errors\r\n  if (error.code === 'ECONNREFUSED' || error.code === 'ETIMEDOUT') {\r\n    return res.status(503).json(\r\n      formatErrorResponse(\r\n        new NetworkError('Database connection failed', error),\r\n        false\r\n      )\r\n    );\r\n  }\r\n\r\n  // Handle file system errors\r\n  if (error.code === 'ENOENT' || error.code === 'EACCES' || error.code === 'EMFILE') {\r\n    return res.status(500).json(\r\n      formatErrorResponse(\r\n        new FileSystemError('File system operation failed', error),\r\n        false\r\n      )\r\n    );\r\n  }\r\n\r\n  // Handle timeout errors\r\n  if (error.message && (error.message.includes('timeout') || error.message.includes('ETIMEDOUT'))) {\r\n    return res.status(408).json(\r\n      formatErrorResponse(\r\n        new TimeoutError('Request timeout', error.timeout),\r\n        false\r\n      )\r\n    );\r\n  }\r\n\r\n  // Handle file size errors\r\n  if (error.code === 'LIMIT_FILE_SIZE' || error.message?.includes('too large')) {\r\n    return res.status(413).json(\r\n      formatErrorResponse(\r\n        new FileTooLargeError(),\r\n        false\r\n      )\r\n    );\r\n  }\r\n\r\n  // Default to 500 with safe error message\r\n  const isDevelopment = process.env.NODE_ENV === 'development';\r\n  const safeMessage = isDevelopment \r\n    ? error.message || 'Internal server error'\r\n    : 'Internal server error';\r\n  \r\n  res.status(500).json(\r\n    formatErrorResponse(\r\n      new AppError(safeMessage, 500, 'INTERNAL_ERROR', null, error),\r\n      isDevelopment\r\n    )\r\n  );\r\n}\r\n\r\n/**\r\n * Create error handler wrapper for async route handlers\r\n */\r\nexport function asyncHandler(handler) {\r\n  return async (req, res, next) => {\r\n    try {\r\n      await handler(req, res, next);\r\n    } catch (error) {\r\n      handleApiError(error, res, {\r\n        method: req.method,\r\n        url: req.url,\r\n        path: req.path,\r\n        query: req.query,\r\n        user: req.user?.id,\r\n      });\r\n    }\r\n  };\r\n}\r\n\r\n/**\r\n * Retry logic for operations that might fail temporarily\r\n */\r\nexport async function retryOperation(operation, maxRetries = 3, delay = 1000) {\r\n  let lastError;\r\n  \r\n  for (let attempt = 1; attempt <= maxRetries; attempt++) {\r\n    try {\r\n      return await operation();\r\n    } catch (error) {\r\n      lastError = error;\r\n      \r\n      // Don't retry on certain errors\r\n      if (error instanceof ValidationError || \r\n          error instanceof AuthenticationError ||\r\n          error instanceof AuthorizationError) {\r\n        throw error;\r\n      }\r\n      \r\n      // If last attempt, throw error\r\n      if (attempt === maxRetries) {\r\n        break;\r\n      }\r\n      \r\n      // Wait before retrying (exponential backoff)\r\n      const waitTime = delay * Math.pow(2, attempt - 1);\r\n      await new Promise(resolve => setTimeout(resolve, waitTime));\r\n    }\r\n  }\r\n  \r\n  throw lastError;\r\n}\r\n\r\n","import { v2 as cloudinary } from 'cloudinary';\r\nimport diagnostics from '../../lib/diagnostics.js';\r\nimport { handleApiError } from '../../errors/index.js';\r\n\r\nexport const config = {\r\n  api: { bodyParser: false },\r\n};\r\n\r\nexport default async function handler(req, res) {\r\n  if (req.method !== 'GET') {\r\n    res.setHeader('Allow', 'GET');\r\n    return res.status(405).json({ error: 'Method not allowed' });\r\n  }\r\n\r\n  try {\r\n    const env = {\r\n      CLOUDINARY_CLOUD_NAME: !!process.env.CLOUDINARY_CLOUD_NAME,\r\n      CLOUDINARY_API_KEY: !!process.env.CLOUDINARY_API_KEY,\r\n      CLOUDINARY_API_SECRET: !!process.env.CLOUDINARY_API_SECRET,\r\n      HF_API_TOKEN: !!process.env.HF_API_TOKEN,\r\n    };\r\n\r\n    let cloudinaryOk = false;\r\n    let cloudinaryMsg = null;\r\n    try {\r\n      cloudinary.config({\r\n        cloud_name: process.env.CLOUDINARY_CLOUD_NAME,\r\n        api_key: process.env.CLOUDINARY_API_KEY,\r\n        api_secret: process.env.CLOUDINARY_API_SECRET,\r\n      });\r\n      const ping = await cloudinary.api.ping();\r\n      cloudinaryOk = !!ping?.status;\r\n      cloudinaryMsg = ping?.status || 'ok';\r\n    } catch (e) {\r\n      cloudinaryOk = false;\r\n      cloudinaryMsg = e?.message || String(e);\r\n    }\r\n\r\n    // Enhanced diagnostics\r\n    const health = await diagnostics.runAllChecks();\r\n    const systemInfo = await diagnostics.getSystemInfo();\r\n\r\n    return res.status(200).json({\r\n      env,\r\n      cloudinary: { ok: cloudinaryOk, message: cloudinaryMsg },\r\n      health: {\r\n        overall: health.overall,\r\n        timestamp: health.timestamp,\r\n      },\r\n      system: {\r\n        platform: systemInfo.platform,\r\n        nodeVersion: systemInfo.nodeVersion,\r\n        memory: systemInfo.memory,\r\n      },\r\n    });\r\n  } catch (error) {\r\n    return handleApiError(error, res, {\r\n      endpoint: '/api/diagnostics',\r\n      method: req.method,\r\n    });\r\n  }\r\n}\r\n","import { sendError } from \"next/dist/esm/server/api-utils\";\nimport { RouteKind } from \"next/dist/esm/server/route-kind\";\nimport { PagesAPIRouteModule } from \"next/dist/esm/server/route-modules/pages-api/module.compiled\";\nimport { hoist } from \"next/dist/esm/build/templates/helpers\";\n// Import the userland code.\nimport * as userland from \"INNER_PAGE\";\nimport { getTracer, SpanKind } from \"next/dist/esm/server/lib/trace/tracer\";\nimport { BaseServerSpan } from \"next/dist/esm/server/lib/trace/constants\";\nimport { addRequestMeta } from \"next/dist/esm/server/request-meta\";\n// Re-export the handler (should be the default export).\nexport default hoist(userland, 'default');\n// Re-export config.\nexport const config = hoist(userland, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new PagesAPIRouteModule({\n    definition: {\n        kind: RouteKind.PAGES_API,\n        page: \"/api/diagnostics\",\n        pathname: \"/api/diagnostics\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland,\n    distDir: process.env.__NEXT_RELATIVE_DIST_DIR || '',\n    relativeProjectDir: process.env.__NEXT_RELATIVE_PROJECT_DIR || ''\n});\nexport async function handler(req, res, ctx) {\n    if (routeModule.isDev) {\n        addRequestMeta(req, 'devRequestTimingInternalsEnd', process.hrtime.bigint());\n    }\n    let srcPage = \"/api/diagnostics\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (process.env.TURBOPACK) {\n        srcPage = srcPage.replace(/\\/index$/, '') || '/';\n    }\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return;\n    }\n    const { query, params, prerenderManifest, routerServerContext } = prepareResult;\n    try {\n        const method = req.method || 'GET';\n        const tracer = getTracer();\n        const activeSpan = tracer.getActiveScopeSpan();\n        const onRequestError = routeModule.instrumentationOnRequestError.bind(routeModule);\n        const invokeRouteModule = async (span)=>routeModule.render(req, res, {\n                query: {\n                    ...query,\n                    ...params\n                },\n                params,\n                allowedRevalidateHeaderKeys: process.env.__NEXT_ALLOWED_REVALIDATE_HEADERS,\n                multiZoneDraftMode: Boolean(process.env.__NEXT_MULTI_ZONE_DRAFT_MODE),\n                trustHostHeader: process.env.__NEXT_TRUST_HOST_HEADER,\n                // TODO: get this from from runtime env so manifest\n                // doesn't need to load\n                previewProps: prerenderManifest.preview,\n                propagateError: false,\n                dev: routeModule.isDev,\n                page: \"/api/diagnostics\",\n                internalRevalidate: routerServerContext == null ? void 0 : routerServerContext.revalidate,\n                onError: (...args)=>onRequestError(req, ...args)\n            }).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${srcPage}`);\n                }\n            });\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await invokeRouteModule(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${srcPage}`,\n                    kind: SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, invokeRouteModule));\n        }\n    } catch (err) {\n        // we re-throw in dev to show the error overlay\n        if (routeModule.isDev) {\n            throw err;\n        }\n        // this is technically an invariant as error handling\n        // should be done inside of api-resolver onError\n        sendError(res, 500, 'Internal Server Error');\n    } finally{\n        // We don't allow any waitUntil work in pages API routes currently\n        // so if callback is present return with resolved promise since no\n        // pending work\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n    }\n}\n\n//# sourceMappingURL=pages-api.js.map\n"],"names":[],"mappings":"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","ignoreList":[2]}