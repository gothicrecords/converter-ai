module.exports=[24868,(e,r,t)=>{r.exports=e.x("fs/promises",()=>require("fs/promises"))},12181,(e,r,t)=>{r.exports=e.x("winston",()=>require("winston"))},92509,(e,r,t)=>{r.exports=e.x("url",()=>require("url"))},28112,e=>{"use strict";var r=e.i(12181),t=e.i(14747);let s=(0,e.i(92509).fileURLToPath)({get url(){return`file://${e.P("lib/logger.js")}`}}.url);t.default.dirname(s);let i=r.default.format.combine(r.default.format.timestamp({format:"YYYY-MM-DD HH:mm:ss"}),r.default.format.errors({stack:!0}),r.default.format.splat(),r.default.format.json());r.default.format.combine(r.default.format.colorize(),r.default.format.timestamp({format:"HH:mm:ss"}),r.default.format.printf(({timestamp:e,level:r,message:t,...s})=>{let i=`${e} [${r}]: ${t}`;return Object.keys(s).length>0&&s.stack?i+=`
${s.stack}`:Object.keys(s).length>0&&(i+=`
${JSON.stringify(s,null,2)}`),i}));let o=t.default.join(process.cwd(),"logs"),a=r.default.createLogger({level:process.env.LOG_LEVEL||"info",format:i,defaultMeta:{service:"upscaler-ai",environment:"production"},transports:[new r.default.transports.Console({format:r.default.format.json(),handleExceptions:!0,handleRejections:!0}),new r.default.transports.File({filename:t.default.join(o,"error.log"),level:"error",maxsize:5242880,maxFiles:5,format:i}),new r.default.transports.File({filename:t.default.join(o,"combined.log"),maxsize:5242880,maxFiles:5,format:i})],exceptionHandlers:[new r.default.transports.File({filename:t.default.join(o,"exceptions.log"),maxsize:5242880,maxFiles:3})],rejectionHandlers:[new r.default.transports.File({filename:t.default.join(o,"rejections.log"),maxsize:5242880,maxFiles:3})]});e.s(["default",0,a,"log",0,{error:(e,r=null,t={})=>{let s={message:e,...t};return r&&(s.error={name:r.name,message:r.message,stack:r.stack,code:r.code,statusCode:r.statusCode,details:r.details}),a.error(e,s),s},warn:(e,r={})=>{a.warn(e,r)},info:(e,r={})=>{a.info(e,r)},debug:(e,r={})=>{},api:(e,r,t=null)=>{let s={method:e.method,url:e.url,path:e.path,statusCode:r.statusCode,userAgent:e.headers["user-agent"],ip:e.ip||e.connection.remoteAddress};t&&(s.responseTime=`${t}ms`),r.statusCode>=400?a.warn("API Request",s):a.info("API Request",s)},database:(e,r=null,t=null,s=null)=>{let i={operation:e,duration:t?`${t}ms`:null};r&&(i.query="string"==typeof r?r:JSON.stringify(r)),s?a.error("Database Operation Failed",{...i,error:s}):a.debug("Database Operation",i)},file:(e,r,t=null,s=null)=>{let i={operation:e,filePath:r,size:t?`${(t/1024).toFixed(2)}KB`:null};s?a.error("File Operation Failed",{...i,error:s}):a.debug("File Operation",i)},performance:(e,r,t={})=>{a.info("Performance Metric",{operation:e,duration:`${r}ms`,...t})}}])},45255,e=>{"use strict";var r=e.i(28112),t=e.i(24868),s=e.i(14747);let i=(0,e.i(92509).fileURLToPath)({get url(){return`file://${e.P("lib/errorTracker.js")}`}}.url);s.default.dirname(i);let o=s.default.join(process.cwd(),"logs","errors.db.json"),a={ECONNREFUSED:{type:"database",severity:"high",solution:"Check database connection settings and ensure database is running",autoFix:!1},ETIMEDOUT:{type:"network",severity:"medium",solution:"Check network connectivity and timeout settings",autoFix:!1},ENOENT:{type:"filesystem",severity:"medium",solution:"File or directory not found. Check file paths and permissions",autoFix:!0},EACCES:{type:"permission",severity:"high",solution:"Permission denied. Check file/directory permissions",autoFix:!1},EMFILE:{type:"resource",severity:"high",solution:"Too many open files. Increase ulimit or close file handles",autoFix:!1},LIMIT_FILE_SIZE:{type:"validation",severity:"low",solution:"File size exceeds limit. Check file size validation",autoFix:!1},VALIDATION_ERROR:{type:"validation",severity:"low",solution:"Input validation failed. Check input data format",autoFix:!1},AUTHENTICATION_ERROR:{type:"auth",severity:"medium",solution:"Authentication required. Check user session and tokens",autoFix:!1}},n=new class{constructor(){this.errorCounts=new Map,this.errorHistory=[],this.maxHistorySize=1e3}async trackError(e,t={}){let s={id:this.generateErrorId(),timestamp:new Date().toISOString(),error:{name:e.name,message:e.message,code:e.code,stack:e.stack,statusCode:e.statusCode},context:{...t,environment:"production",nodeVersion:process.version},pattern:this.analyzeErrorPattern(e),frequency:1},i=this.getErrorKey(e),o=this.errorCounts.get(i)||0;return this.errorCounts.set(i,o+1),s.frequency=o+1,this.errorHistory.push(s),this.errorHistory.length>this.maxHistorySize&&this.errorHistory.shift(),r.log.error("Error Tracked",e,{errorId:s.id,pattern:s.pattern,frequency:s.frequency,...t}),await this.saveErrorToDB(s),this.shouldAlert(s)&&await this.sendAlert(s),s}analyzeErrorPattern(e){let r={type:"unknown",severity:"low",solution:null,autoFixable:!1,similarErrors:[]};if(e.code&&a[e.code]){let t=a[e.code];r.type=t.type,r.severity=t.severity,r.solution=t.solution,r.autoFixable=t.autoFix}if(e.message){let t=e.message.toLowerCase();t.includes("timeout")?(r.type="timeout",r.severity="medium",r.solution="Operation timed out. Consider increasing timeout or optimizing operation"):t.includes("memory")?(r.type="memory",r.severity="high",r.solution="Memory issue detected. Check memory usage and optimize"):(t.includes("permission")||t.includes("access"))&&(r.type="permission",r.severity="high",r.solution="Permission issue. Check file/directory permissions")}return r.similarErrors=this.findSimilarErrors(e),r}findSimilarErrors(e,r=5){return this.errorHistory.filter(r=>r.error.name===e.name||r.error.message&&e.message&&this.similarity(r.error.message,e.message)>.7).slice(-r).map(e=>({id:e.id,timestamp:e.timestamp,message:e.error.message}))}similarity(e,r){let t=new Set(e.toLowerCase().split(/\s+/)),s=new Set(r.toLowerCase().split(/\s+/)),i=new Set([...t].filter(e=>s.has(e))),o=new Set([...t,...s]);return i.size/o.size}generateErrorId(){return`ERR-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}getErrorKey(e){return`${e.name||"Error"}:${e.code||"NO_CODE"}:${e.message?.substring(0,50)||"NO_MESSAGE"}`}shouldAlert(e){return"high"===e.pattern.severity||e.frequency>10||this.errorHistory.filter(r=>r.error.name===e.error.name&&new Date(r.timestamp)>new Date(Date.now()-3e5)).length>5}async sendAlert(e){if(r.log.warn("Error Alert Triggered",{errorId:e.id,severity:e.pattern.severity,frequency:e.frequency,solution:e.pattern.solution}),process.env.ERROR_ALERT_WEBHOOK)try{await fetch(process.env.ERROR_ALERT_WEBHOOK,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({error:e.error,pattern:e.pattern,frequency:e.frequency,timestamp:e.timestamp})})}catch(e){r.log.error("Failed to send error alert",e)}}async saveErrorToDB(e){try{let r=s.default.dirname(o);await t.default.mkdir(r,{recursive:!0});let i=[];try{let e=await t.default.readFile(o,"utf-8");i=JSON.parse(e)}catch(e){}i.push(e),i.length>1e4&&(i=i.slice(-1e4)),await t.default.writeFile(o,JSON.stringify(i,null,2))}catch(e){r.log.error("Failed to save error to DB",e)}}getStats(){let e={totalErrors:this.errorHistory.length,uniqueErrors:this.errorCounts.size,errorsByType:{},errorsBySeverity:{},recentErrors:this.errorHistory.slice(-10),topErrors:Array.from(this.errorCounts.entries()).sort((e,r)=>r[1]-e[1]).slice(0,10).map(([e,r])=>({error:e,count:r}))};return this.errorHistory.forEach(r=>{let t=r.pattern.type;e.errorsByType[t]=(e.errorsByType[t]||0)+1}),this.errorHistory.forEach(r=>{let t=r.pattern.severity;e.errorsBySeverity[t]=(e.errorsBySeverity[t]||0)+1}),e}getErrorsByPattern(e){return this.errorHistory.filter(r=>r.pattern.type===e)}clearHistory(){this.errorHistory=[],this.errorCounts.clear()}};e.s(["default",0,n])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__9b2d0059._.js.map