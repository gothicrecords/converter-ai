"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/upscale";
exports.ids = ["pages/api/upscale"];
exports.modules = {

/***/ "cloudinary":
/*!*****************************!*\
  !*** external "cloudinary" ***!
  \*****************************/
/***/ ((module) => {

module.exports = require("cloudinary");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "formidable":
/*!*****************************!*\
  !*** external "formidable" ***!
  \*****************************/
/***/ ((module) => {

module.exports = import("formidable");;

/***/ }),

/***/ "fs/promises":
/*!******************************!*\
  !*** external "fs/promises" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("fs/promises");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fupscale&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cupscale.js&middlewareConfigBase64=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fupscale&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cupscale.js&middlewareConfigBase64=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_upscale_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\upscale.js */ \"(api)/./pages/api/upscale.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_upscale_js__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_upscale_js__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_upscale_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_upscale_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/upscale\",\n        pathname: \"/api/upscale\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_upscale_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnVwc2NhbGUmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZwYWdlcyU1Q2FwaSU1Q3Vwc2NhbGUuanMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ0w7QUFDMUQ7QUFDcUQ7QUFDckQ7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLGtEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyxrREFBUTtBQUNwQztBQUNPLHdCQUF3QixnSEFBbUI7QUFDbEQ7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQscUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly91cHNjYWxlci1haS8/ODFlOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXNcXFxcYXBpXFxcXHVwc2NhbGUuanNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS91cHNjYWxlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvdXBzY2FsZVwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fupscale&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cupscale.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/upscale.js":
/*!******************************!*\
  !*** ./pages/api/upscale.js ***!
  \******************************/
/***/ ((__webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(__webpack_module__, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var formidable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! formidable */ \"formidable\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! fs/promises */ \"fs/promises\");\n/* harmony import */ var _utils_upscale_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/upscale.js */ \"(api)/./utils/upscale.js\");\n/* harmony import */ var cloudinary__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! cloudinary */ \"cloudinary\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([formidable__WEBPACK_IMPORTED_MODULE_0__]);\nformidable__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n// Configure Cloudinary right away, as it's needed by upscaleImage\ncloudinary__WEBPACK_IMPORTED_MODULE_3__.v2.config({\n    cloud_name: process.env.CLOUDINARY_CLOUD_NAME,\n    api_key: process.env.CLOUDINARY_API_KEY,\n    api_secret: process.env.CLOUDINARY_API_SECRET\n});\nconst config = {\n    api: {\n        bodyParser: false\n    }\n};\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        res.setHeader(\"Allow\", \"POST\");\n        return res.status(405).json({\n            error: \"Method not allowed\"\n        });\n    }\n    const form = (0,formidable__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n        multiples: false\n    });\n    try {\n        const [fields, files] = await form.parse(req);\n        const imageFile = files.image && files.image.length > 0 ? files.image[0] : null;\n        if (!imageFile) {\n            return res.status(400).json({\n                error: \"No file uploaded\"\n            });\n        }\n        // formidable v3 uses `filepath`\n        const filePath = imageFile.filepath;\n        if (!filePath) {\n            return res.status(400).json({\n                error: \"Uploaded file path missing\"\n            });\n        }\n        // Read the file from the temporary path\n        const buffer = await fs_promises__WEBPACK_IMPORTED_MODULE_1__.readFile(filePath);\n        // Upscale the image using the utility function\n        const url = await (0,_utils_upscale_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(buffer);\n        // Clean up the temporary file\n        await fs_promises__WEBPACK_IMPORTED_MODULE_1__.unlink(filePath);\n        return res.status(200).json({\n            url\n        });\n    } catch (error) {\n        console.error(\"API Error:\", error);\n        // Ensure a response is always sent\n        if (!res.headersSent) {\n            res.status(500).json({\n                error: \"Upscale failed\",\n                details: error.message\n            });\n        }\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvdXBzY2FsZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBb0M7QUFDUDtBQUNxQjtBQUNKO0FBRTlDLGtFQUFrRTtBQUNsRUksMENBQVVBLENBQUNDLE1BQU0sQ0FBQztJQUNoQkMsWUFBWUMsUUFBUUMsR0FBRyxDQUFDQyxxQkFBcUI7SUFDN0NDLFNBQVNILFFBQVFDLEdBQUcsQ0FBQ0csa0JBQWtCO0lBQ3ZDQyxZQUFZTCxRQUFRQyxHQUFHLENBQUNLLHFCQUFxQjtBQUMvQztBQUVPLE1BQU1SLFNBQVM7SUFDcEJTLEtBQUs7UUFDSEMsWUFBWTtJQUNkO0FBQ0YsRUFBRTtBQUVhLGVBQWVDLFFBQVFDLEdBQUcsRUFBRUMsR0FBRztJQUM1QyxJQUFJRCxJQUFJRSxNQUFNLEtBQUssUUFBUTtRQUN6QkQsSUFBSUUsU0FBUyxDQUFDLFNBQVM7UUFDdkIsT0FBT0YsSUFBSUcsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFQyxPQUFPO1FBQXFCO0lBQzVEO0lBRUEsTUFBTUMsT0FBT3hCLHNEQUFVQSxDQUFDO1FBQUV5QixXQUFXO0lBQU07SUFFM0MsSUFBSTtRQUNGLE1BQU0sQ0FBQ0MsUUFBUUMsTUFBTSxHQUFHLE1BQU1ILEtBQUtJLEtBQUssQ0FBQ1g7UUFFekMsTUFBTVksWUFBWUYsTUFBTUcsS0FBSyxJQUFJSCxNQUFNRyxLQUFLLENBQUNDLE1BQU0sR0FBRyxJQUFJSixNQUFNRyxLQUFLLENBQUMsRUFBRSxHQUFHO1FBRTNFLElBQUksQ0FBQ0QsV0FBVztZQUNkLE9BQU9YLElBQUlHLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQUVDLE9BQU87WUFBbUI7UUFDMUQ7UUFFQSxnQ0FBZ0M7UUFDaEMsTUFBTVMsV0FBV0gsVUFBVUksUUFBUTtRQUNuQyxJQUFJLENBQUNELFVBQVU7WUFDYixPQUFPZCxJQUFJRyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO2dCQUFFQyxPQUFPO1lBQTZCO1FBQ3BFO1FBRUEsd0NBQXdDO1FBQ3hDLE1BQU1XLFNBQVMsTUFBTWpDLGlEQUFXLENBQUMrQjtRQUVqQywrQ0FBK0M7UUFDL0MsTUFBTUksTUFBTSxNQUFNbEMsNkRBQVlBLENBQUNnQztRQUUvQiw4QkFBOEI7UUFDOUIsTUFBTWpDLCtDQUFTLENBQUMrQjtRQUVoQixPQUFPZCxJQUFJRyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVjO1FBQUk7SUFFcEMsRUFBRSxPQUFPYixPQUFPO1FBQ2RlLFFBQVFmLEtBQUssQ0FBQyxjQUFjQTtRQUM1QixtQ0FBbUM7UUFDbkMsSUFBSSxDQUFDTCxJQUFJcUIsV0FBVyxFQUFFO1lBQ3BCckIsSUFBSUcsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFBRUMsT0FBTztnQkFBa0JpQixTQUFTakIsTUFBTWtCLE9BQU87WUFBQztRQUN6RTtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly91cHNjYWxlci1haS8uL3BhZ2VzL2FwaS91cHNjYWxlLmpzPzM2NDUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGZvcm1pZGFibGUgZnJvbSAnZm9ybWlkYWJsZSc7XHJcbmltcG9ydCBmcyBmcm9tICdmcy9wcm9taXNlcyc7XHJcbmltcG9ydCB1cHNjYWxlSW1hZ2UgZnJvbSAnLi4vLi4vdXRpbHMvdXBzY2FsZS5qcyc7XHJcbmltcG9ydCB7IHYyIGFzIGNsb3VkaW5hcnkgfSBmcm9tICdjbG91ZGluYXJ5JztcclxuXHJcbi8vIENvbmZpZ3VyZSBDbG91ZGluYXJ5IHJpZ2h0IGF3YXksIGFzIGl0J3MgbmVlZGVkIGJ5IHVwc2NhbGVJbWFnZVxyXG5jbG91ZGluYXJ5LmNvbmZpZyh7XHJcbiAgY2xvdWRfbmFtZTogcHJvY2Vzcy5lbnYuQ0xPVURJTkFSWV9DTE9VRF9OQU1FLFxyXG4gIGFwaV9rZXk6IHByb2Nlc3MuZW52LkNMT1VESU5BUllfQVBJX0tFWSxcclxuICBhcGlfc2VjcmV0OiBwcm9jZXNzLmVudi5DTE9VRElOQVJZX0FQSV9TRUNSRVQsXHJcbn0pO1xyXG5cclxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcclxuICBhcGk6IHtcclxuICAgIGJvZHlQYXJzZXI6IGZhbHNlLFxyXG4gIH0sXHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzKSB7XHJcbiAgaWYgKHJlcS5tZXRob2QgIT09ICdQT1NUJykge1xyXG4gICAgcmVzLnNldEhlYWRlcignQWxsb3cnLCAnUE9TVCcpO1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5qc29uKHsgZXJyb3I6ICdNZXRob2Qgbm90IGFsbG93ZWQnIH0pO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgZm9ybSA9IGZvcm1pZGFibGUoeyBtdWx0aXBsZXM6IGZhbHNlIH0pO1xyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgW2ZpZWxkcywgZmlsZXNdID0gYXdhaXQgZm9ybS5wYXJzZShyZXEpO1xyXG4gICAgXHJcbiAgICBjb25zdCBpbWFnZUZpbGUgPSBmaWxlcy5pbWFnZSAmJiBmaWxlcy5pbWFnZS5sZW5ndGggPiAwID8gZmlsZXMuaW1hZ2VbMF0gOiBudWxsO1xyXG5cclxuICAgIGlmICghaW1hZ2VGaWxlKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnTm8gZmlsZSB1cGxvYWRlZCcgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gZm9ybWlkYWJsZSB2MyB1c2VzIGBmaWxlcGF0aGBcclxuICAgIGNvbnN0IGZpbGVQYXRoID0gaW1hZ2VGaWxlLmZpbGVwYXRoO1xyXG4gICAgaWYgKCFmaWxlUGF0aCkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ1VwbG9hZGVkIGZpbGUgcGF0aCBtaXNzaW5nJyB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBSZWFkIHRoZSBmaWxlIGZyb20gdGhlIHRlbXBvcmFyeSBwYXRoXHJcbiAgICBjb25zdCBidWZmZXIgPSBhd2FpdCBmcy5yZWFkRmlsZShmaWxlUGF0aCk7XHJcblxyXG4gICAgLy8gVXBzY2FsZSB0aGUgaW1hZ2UgdXNpbmcgdGhlIHV0aWxpdHkgZnVuY3Rpb25cclxuICAgIGNvbnN0IHVybCA9IGF3YWl0IHVwc2NhbGVJbWFnZShidWZmZXIpO1xyXG5cclxuICAgIC8vIENsZWFuIHVwIHRoZSB0ZW1wb3JhcnkgZmlsZVxyXG4gICAgYXdhaXQgZnMudW5saW5rKGZpbGVQYXRoKTtcclxuXHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oeyB1cmwgfSk7XHJcblxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdBUEkgRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgLy8gRW5zdXJlIGEgcmVzcG9uc2UgaXMgYWx3YXlzIHNlbnRcclxuICAgIGlmICghcmVzLmhlYWRlcnNTZW50KSB7XHJcbiAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdVcHNjYWxlIGZhaWxlZCcsIGRldGFpbHM6IGVycm9yLm1lc3NhZ2UgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJmb3JtaWRhYmxlIiwiZnMiLCJ1cHNjYWxlSW1hZ2UiLCJ2MiIsImNsb3VkaW5hcnkiLCJjb25maWciLCJjbG91ZF9uYW1lIiwicHJvY2VzcyIsImVudiIsIkNMT1VESU5BUllfQ0xPVURfTkFNRSIsImFwaV9rZXkiLCJDTE9VRElOQVJZX0FQSV9LRVkiLCJhcGlfc2VjcmV0IiwiQ0xPVURJTkFSWV9BUElfU0VDUkVUIiwiYXBpIiwiYm9keVBhcnNlciIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJzZXRIZWFkZXIiLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJmb3JtIiwibXVsdGlwbGVzIiwiZmllbGRzIiwiZmlsZXMiLCJwYXJzZSIsImltYWdlRmlsZSIsImltYWdlIiwibGVuZ3RoIiwiZmlsZVBhdGgiLCJmaWxlcGF0aCIsImJ1ZmZlciIsInJlYWRGaWxlIiwidXJsIiwidW5saW5rIiwiY29uc29sZSIsImhlYWRlcnNTZW50IiwiZGV0YWlscyIsIm1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/upscale.js\n");

/***/ }),

/***/ "(api)/./utils/upscale.js":
/*!**************************!*\
  !*** ./utils/upscale.js ***!
  \**************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var cloudinary__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! cloudinary */ \"cloudinary\");\n// utils/upscale.js\n\n// Configura Cloudinary\ncloudinary__WEBPACK_IMPORTED_MODULE_0__.v2.config({\n    cloud_name: process.env.CLOUDINARY_CLOUD_NAME,\n    api_key: process.env.CLOUDINARY_API_KEY,\n    api_secret: process.env.CLOUDINARY_API_SECRET\n});\nasync function upscaleImage(fileBuffer) {\n    const cloudName = process.env.CLOUDINARY_CLOUD_NAME;\n    const apiKey = process.env.CLOUDINARY_API_KEY;\n    if (!cloudName || !apiKey) {\n        throw new Error(\"Cloudinary config mancante in .env\");\n    }\n    try {\n        // Carica l'immagine su Cloudinary con trasformazione di upscale\n        const uploadResult = await new Promise((resolve, reject)=>{\n            const uploadStream = cloudinary__WEBPACK_IMPORTED_MODULE_0__.v2.uploader.upload_stream({\n                resource_type: \"image\",\n                transformation: [\n                    {\n                        effect: \"upscale\",\n                        dpr: \"2.0\"\n                    },\n                    {\n                        fetch_format: \"auto\"\n                    }\n                ]\n            }, (error, result)=>{\n                if (error) reject(error);\n                else resolve(result);\n            });\n            uploadStream.end(fileBuffer);\n        });\n        // Ritorna l'URL upscalato (giÃ  trasformato)\n        if (uploadResult && uploadResult.secure_url) {\n            return uploadResult.secure_url;\n        } else {\n            throw new Error(\"Upload fallito: \" + JSON.stringify(uploadResult));\n        }\n    } catch (err) {\n        console.error(\"Errore Cloudinary upscale:\", err && err.message ? err.message : err);\n        throw err;\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (upscaleImage);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi91dGlscy91cHNjYWxlLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsbUJBQW1CO0FBQzJCO0FBRTlDLHVCQUF1QjtBQUN2QkMsMENBQVVBLENBQUNDLE1BQU0sQ0FBQztJQUNoQkMsWUFBWUMsUUFBUUMsR0FBRyxDQUFDQyxxQkFBcUI7SUFDN0NDLFNBQVNILFFBQVFDLEdBQUcsQ0FBQ0csa0JBQWtCO0lBQ3ZDQyxZQUFZTCxRQUFRQyxHQUFHLENBQUNLLHFCQUFxQjtBQUMvQztBQUVBLGVBQWVDLGFBQWFDLFVBQVU7SUFDcEMsTUFBTUMsWUFBWVQsUUFBUUMsR0FBRyxDQUFDQyxxQkFBcUI7SUFDbkQsTUFBTVEsU0FBU1YsUUFBUUMsR0FBRyxDQUFDRyxrQkFBa0I7SUFFN0MsSUFBSSxDQUFDSyxhQUFhLENBQUNDLFFBQVE7UUFDekIsTUFBTSxJQUFJQyxNQUFNO0lBQ2xCO0lBRUEsSUFBSTtRQUNGLGdFQUFnRTtRQUNoRSxNQUFNQyxlQUFlLE1BQU0sSUFBSUMsUUFBUSxDQUFDQyxTQUFTQztZQUMvQyxNQUFNQyxlQUFlbkIsMENBQVVBLENBQUNvQixRQUFRLENBQUNDLGFBQWEsQ0FDcEQ7Z0JBQ0VDLGVBQWU7Z0JBQ2ZDLGdCQUFnQjtvQkFDZDt3QkFBRUMsUUFBUTt3QkFBV0MsS0FBSztvQkFBTTtvQkFDaEM7d0JBQUVDLGNBQWM7b0JBQU87aUJBQ3hCO1lBQ0gsR0FDQSxDQUFDQyxPQUFPQztnQkFDTixJQUFJRCxPQUFPVCxPQUFPUztxQkFDYlYsUUFBUVc7WUFDZjtZQUVGVCxhQUFhVSxHQUFHLENBQUNsQjtRQUNuQjtRQUVBLDRDQUE0QztRQUM1QyxJQUFJSSxnQkFBZ0JBLGFBQWFlLFVBQVUsRUFBRTtZQUMzQyxPQUFPZixhQUFhZSxVQUFVO1FBQ2hDLE9BQU87WUFDTCxNQUFNLElBQUloQixNQUFNLHFCQUFxQmlCLEtBQUtDLFNBQVMsQ0FBQ2pCO1FBQ3REO0lBRUYsRUFBRSxPQUFPa0IsS0FBSztRQUNaQyxRQUFRUCxLQUFLLENBQUMsOEJBQThCTSxPQUFPQSxJQUFJRSxPQUFPLEdBQUdGLElBQUlFLE9BQU8sR0FBR0Y7UUFDL0UsTUFBTUE7SUFDUjtBQUNGO0FBRUEsaUVBQWV2QixZQUFZQSxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdXBzY2FsZXItYWkvLi91dGlscy91cHNjYWxlLmpzP2UzNjQiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gdXRpbHMvdXBzY2FsZS5qc1xyXG5pbXBvcnQgeyB2MiBhcyBjbG91ZGluYXJ5IH0gZnJvbSAnY2xvdWRpbmFyeSc7XHJcblxyXG4vLyBDb25maWd1cmEgQ2xvdWRpbmFyeVxyXG5jbG91ZGluYXJ5LmNvbmZpZyh7XHJcbiAgY2xvdWRfbmFtZTogcHJvY2Vzcy5lbnYuQ0xPVURJTkFSWV9DTE9VRF9OQU1FLFxyXG4gIGFwaV9rZXk6IHByb2Nlc3MuZW52LkNMT1VESU5BUllfQVBJX0tFWSxcclxuICBhcGlfc2VjcmV0OiBwcm9jZXNzLmVudi5DTE9VRElOQVJZX0FQSV9TRUNSRVQsXHJcbn0pO1xyXG5cclxuYXN5bmMgZnVuY3Rpb24gdXBzY2FsZUltYWdlKGZpbGVCdWZmZXIpIHtcclxuICBjb25zdCBjbG91ZE5hbWUgPSBwcm9jZXNzLmVudi5DTE9VRElOQVJZX0NMT1VEX05BTUU7XHJcbiAgY29uc3QgYXBpS2V5ID0gcHJvY2Vzcy5lbnYuQ0xPVURJTkFSWV9BUElfS0VZO1xyXG5cclxuICBpZiAoIWNsb3VkTmFtZSB8fCAhYXBpS2V5KSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nsb3VkaW5hcnkgY29uZmlnIG1hbmNhbnRlIGluIC5lbnYnKTtcclxuICB9XHJcblxyXG4gIHRyeSB7XHJcbiAgICAvLyBDYXJpY2EgbCdpbW1hZ2luZSBzdSBDbG91ZGluYXJ5IGNvbiB0cmFzZm9ybWF6aW9uZSBkaSB1cHNjYWxlXHJcbiAgICBjb25zdCB1cGxvYWRSZXN1bHQgPSBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIGNvbnN0IHVwbG9hZFN0cmVhbSA9IGNsb3VkaW5hcnkudXBsb2FkZXIudXBsb2FkX3N0cmVhbShcclxuICAgICAgICB7XHJcbiAgICAgICAgICByZXNvdXJjZV90eXBlOiAnaW1hZ2UnLFxyXG4gICAgICAgICAgdHJhbnNmb3JtYXRpb246IFtcclxuICAgICAgICAgICAgeyBlZmZlY3Q6ICd1cHNjYWxlJywgZHByOiAnMi4wJyB9LFxyXG4gICAgICAgICAgICB7IGZldGNoX2Zvcm1hdDogJ2F1dG8nIH1cclxuICAgICAgICAgIF1cclxuICAgICAgICB9LFxyXG4gICAgICAgIChlcnJvciwgcmVzdWx0KSA9PiB7XHJcbiAgICAgICAgICBpZiAoZXJyb3IpIHJlamVjdChlcnJvcik7XHJcbiAgICAgICAgICBlbHNlIHJlc29sdmUocmVzdWx0KTtcclxuICAgICAgICB9XHJcbiAgICAgICk7XHJcbiAgICAgIHVwbG9hZFN0cmVhbS5lbmQoZmlsZUJ1ZmZlcik7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBSaXRvcm5hIGwnVVJMIHVwc2NhbGF0byAoZ2nDoCB0cmFzZm9ybWF0bylcclxuICAgIGlmICh1cGxvYWRSZXN1bHQgJiYgdXBsb2FkUmVzdWx0LnNlY3VyZV91cmwpIHtcclxuICAgICAgcmV0dXJuIHVwbG9hZFJlc3VsdC5zZWN1cmVfdXJsO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdVcGxvYWQgZmFsbGl0bzogJyArIEpTT04uc3RyaW5naWZ5KHVwbG9hZFJlc3VsdCkpO1xyXG4gICAgfVxyXG5cclxuICB9IGNhdGNoIChlcnIpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yZSBDbG91ZGluYXJ5IHVwc2NhbGU6JywgZXJyICYmIGVyci5tZXNzYWdlID8gZXJyLm1lc3NhZ2UgOiBlcnIpO1xyXG4gICAgdGhyb3cgZXJyO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgdXBzY2FsZUltYWdlOyJdLCJuYW1lcyI6WyJ2MiIsImNsb3VkaW5hcnkiLCJjb25maWciLCJjbG91ZF9uYW1lIiwicHJvY2VzcyIsImVudiIsIkNMT1VESU5BUllfQ0xPVURfTkFNRSIsImFwaV9rZXkiLCJDTE9VRElOQVJZX0FQSV9LRVkiLCJhcGlfc2VjcmV0IiwiQ0xPVURJTkFSWV9BUElfU0VDUkVUIiwidXBzY2FsZUltYWdlIiwiZmlsZUJ1ZmZlciIsImNsb3VkTmFtZSIsImFwaUtleSIsIkVycm9yIiwidXBsb2FkUmVzdWx0IiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJ1cGxvYWRTdHJlYW0iLCJ1cGxvYWRlciIsInVwbG9hZF9zdHJlYW0iLCJyZXNvdXJjZV90eXBlIiwidHJhbnNmb3JtYXRpb24iLCJlZmZlY3QiLCJkcHIiLCJmZXRjaF9mb3JtYXQiLCJlcnJvciIsInJlc3VsdCIsImVuZCIsInNlY3VyZV91cmwiLCJKU09OIiwic3RyaW5naWZ5IiwiZXJyIiwiY29uc29sZSIsIm1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./utils/upscale.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fupscale&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cupscale.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();